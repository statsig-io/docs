"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[5697],{72715:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var n=s(74848),r=s(28453);const i={title:"Creating Custom Metrics",sidebar_label:"Creating Custom Metrics",slug:"/metrics/create",keywords:["owner:shubham"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},a=void 0,o={id:"metrics/create",title:"Creating Custom Metrics",description:"Custom metrics are computed by Statsig from your raw events. To create custom metrics, navigate to Metrics from the left-hand navigation panel, then to the Metrics Catalog tab. Tap on the Create button.",source:"@site/docs/metrics/create.md",sourceDirName:"metrics",slug:"/metrics/create",permalink:"/metrics/create",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/metrics/create.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Creating Custom Metrics",sidebar_label:"Creating Custom Metrics",slug:"/metrics/create",keywords:["owner:shubham"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"Health",permalink:"/metrics/health-checks"},next:{title:"Custom DAU Metric Creation",permalink:"/metrics/custom-dau"}},c={},l=[{value:"Examples",id:"examples",level:2},{value:"1. Event Count Metrics",id:"1-event-count-metrics",level:3},{value:"2. User Count Metrics",id:"2-user-count-metrics",level:3},{value:"3. Aggregation Metrics",id:"3-aggregation-metrics",level:3},{value:"4. Ratio Metrics",id:"4-ratio-metrics",level:3},{value:"5. Funnel Metrics",id:"5-funnel-metrics",level:3},{value:"Components of Funnel Metrics",id:"components-of-funnel-metrics",level:3},{value:"6 Count Distinct Metrics",id:"6-count-distinct-metrics",level:3},{value:"Custom Metrics &amp; Dimensions",id:"custom-metrics--dimensions",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:["Custom metrics are computed by Statsig from your raw events. To create custom metrics, navigate to ",(0,n.jsx)(t.strong,{children:"Metrics"})," from the left-hand navigation panel, then to the ",(0,n.jsx)(t.strong,{children:"Metrics Catalog"})," tab. Tap on the ",(0,n.jsx)(t.strong,{children:"Create"})," button."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/101903926/4148f4b8-f9e4-4a37-98df-35663650d76f",alt:"Screen Shot 2023-09-12 at 12 53 05 PM"})}),"\n",(0,n.jsx)(t.p,{children:"Statsig supports five types of custom metrics:"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Metric Type"}),(0,n.jsx)(t.th,{children:"Description"}),(0,n.jsx)(t.th,{children:"Examples"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Event Count"}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Total count of events"})," filtered by the ",(0,n.jsx)(t.em,{children:"Value"}),", ",(0,n.jsx)(t.em,{children:"Metadata"}),", or ",(0,n.jsx)(t.em,{children:"User Object"})," properties of an event type"]}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Add to Cart"})," event filtered by category type"]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"User Count"}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Number of unique users"})," that trigger events filtered by the ",(0,n.jsx)(t.em,{children:"Value"}),", ",(0,n.jsx)(t.em,{children:"Metadata"}),", or ",(0,n.jsx)(t.em,{children:"User Object"})," of an event type"]}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Active Users"})," based on their views of a product category"]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Aggregation"}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Sum or Average"})," of the ",(0,n.jsx)(t.em,{children:"Value"}),", ",(0,n.jsx)(t.em,{children:"Metadata"}),", and ",(0,n.jsx)(t.em,{children:"User Object"})," property of an event type"]}),(0,n.jsx)(t.td,{children:(0,n.jsx)(t.strong,{children:"Total Revenue"})})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Ratio"}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Rates"})," (e.g. cart conversion rate, purchase rate), ",(0,n.jsx)(t.strong,{children:"Normalized Values"})," (e.g. sessions per user, items per cart)"]}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Cart Conversion Rate"}),", ",(0,n.jsx)(t.strong,{children:"Sessions per User"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Funnel"}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Funnels"}),"- funnel of multiple events with conversion tracking"]}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Sign-up Funnel"}),", ",(0,n.jsx)(t.strong,{children:"Checkout Funnel"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"Count Distinct"}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Count Distinct"}),"- Number of unique values for a given field, often approximated with sketches"]}),(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.strong,{children:"Unique Songs"})," listened per user"]})]})]})]}),"\n",(0,n.jsxs)(t.p,{children:["Statsig computes custom metrics on a per day basis for your ",(0,n.jsx)(t.strong,{children:"Metrics"})," dashboard, and rolled up for the duration of the experiment in your ",(0,n.jsx)(t.strong,{children:"Pulse Results"})," delivered with your Feature Gates and Experiments. After you create a custom metric, it will not populate until the next day (and will not backfill to previous days). Statsig will only calculate it moving forward from the creation date."]}),"\n",(0,n.jsxs)(t.p,{children:["Statsig offers a feature allowing users to set a daily ",(0,n.jsx)(t.strong,{children:"max cap"})," for specific metrics. With this capability, users can define maximum caps for various unit types associated with a metric. Any value surpassing the set cap will automatically be adjusted to match it. For instance, if you determine that purchases greater than $10,000 per day on your E-commerce platform should not skew analysis, any transaction exceeding this threshold will be adjusted downward to this limit, ensuring the integrity of your experiment analysis. Capped metrics are available for event count and aggregation (sum) metric types."]}),"\n",(0,n.jsxs)(t.p,{children:["When creating your custom metric, you can preview a given custom metric's value at the bottom of the page. To view metric preview, tap ",(0,n.jsx)(t.strong,{children:"View Output Preview"})," to see what your metric would have looked like based on its components\u2019 values over the last 7 days, in both chart and table form."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/101903926/0869e1bf-8fea-407e-8a5f-8b97860b3867",alt:"Screen Shot 2023-09-13 at 10 30 58 AM"})}),"\n",(0,n.jsx)(t.h2,{id:"examples",children:"Examples"}),"\n",(0,n.jsx)(t.h3,{id:"1-event-count-metrics",children:"1. Event Count Metrics"}),"\n",(0,n.jsxs)(t.p,{children:["Here's an example of setting up a custom event metric to count the ",(0,n.jsx)(t.strong,{children:"number of add_to_cart events"})," filtered by a metadata property called ",(0,n.jsx)(t.em,{children:"value"}),", which carries the price of the item added to the cart. As this example specifies the ID Type as ",(0,n.jsx)(t.em,{children:"userID"}),", Statsig will compute this metric as part of the test group that the corresponding user is assigned to in an experiment."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/101903926/95489e9b-36f2-4704-9970-da675a8a3d2e",alt:"Screen Shot 2023-09-12 at 1 11 23 PM"})}),"\n",(0,n.jsxs)(t.p,{children:["If you select the ID Type as ",(0,n.jsx)(t.em,{children:"stableID"}),", Statsig will compute this metric in the test group that the corresponding device is assigned to in an experiment. When you select more than ID Type, Statsig will compute this metric for each type of ID Type that you specify."]}),"\n",(0,n.jsx)(t.h3,{id:"2-user-count-metrics",children:"2. User Count Metrics"}),"\n",(0,n.jsxs)(t.p,{children:["The example below creates a metric to count the ",(0,n.jsx)(t.strong,{children:"number of unique users"})," who viewed a product in the ",(0,n.jsx)(t.em,{children:"toys"})," category that was priced under $10."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/101903926/ae270d11-d3de-4f34-85e5-a67ad9c7cd9e",alt:"Screen Shot 2023-09-12 at 1 16 11 PM"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"Time Window"})}),"\n",(0,n.jsx)(t.p,{children:"Two time window options are available for user count metrics"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Daily Participation Rate: It counts the total number of days that a user has the selected event, divided by the number of days the user is in the experiment. The result is a metric value between 0 and 1, which represents the probably of a user having the event on a daily basis. It works best for events that are expected to occur repeatedly for a given user."}),"\n",(0,n.jsx)(t.li,{children:"One Time Event: This checks if a user has the selected event at least once during their time in the experiment. The result is a binary metric with value 0 or 1 for each user. This is ideal for events that are only expected once per user, such as sign up events."}),"\n",(0,n.jsx)(t.li,{children:"Custom Attribution Window: Allows you to define a custom window after exposure to count an event towards a metric calculation."}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"3-aggregation-metrics",children:"3. Aggregation Metrics"}),"\n",(0,n.jsxs)(t.p,{children:["The example below shows a ",(0,n.jsx)(t.strong,{children:"Total Revenue"})," metric that sums the ",(0,n.jsx)(t.em,{children:"value"})," associated with all purchase events."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/101903926/f0d4d21b-08ae-405d-a156-4d29f96ab298",alt:"Screen Shot 2023-09-12 at 1 24 49 PM"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"[In Beta] Currency Sum"})}),"\n",(0,n.jsxs)(t.p,{children:["eCommerce customers can span multiple currency types and typically log payments in the currency and amounts the user actually pays. Currency sums allow for payments that are recorded in different currencies to be converted to one common currency. You will need to log two pieces of metadata in your event - a currency code and a value. Example metadata - ",(0,n.jsx)(t.code,{children:'_{"currency_code": "USD", "currency_value": 123.45}_'})]}),"\n",(0,n.jsxs)(t.p,{children:["Statsig supports currency sums upon request. Please ask in ",(0,n.jsx)(t.a,{href:"https://statsig.com/slack",children:"Slack"}),"."]}),"\n",(0,n.jsx)(t.h3,{id:"4-ratio-metrics",children:"4. Ratio Metrics"}),"\n",(0,n.jsxs)(t.p,{children:["The example below shows the creation of a ",(0,n.jsx)(t.strong,{children:"Cart Conversion Rate"})," metric. Here we use the unique users who triggered the ",(0,n.jsx)(t.em,{children:"purchase event"})," as the numerator and the unique users who triggered the ",(0,n.jsx)(t.em,{children:"add to cart"})," event in the denominator. Note that when calculating the numerator, we filter to only include users who also had the denominator event in the same day. So in the case of this metric, a user who only has ",(0,n.jsx)(t.em,{children:"purchase event"})," on a given day without an ",(0,n.jsx)(t.em,{children:"add to cart"})," on that same day will not count towards the numerator."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/101903926/9f8a671e-ac1f-4e2f-92cb-d154e0daecac",alt:"Screen Shot 2023-09-12 at 1 29 15 PM"})}),"\n",(0,n.jsxs)(t.p,{children:["This pattern also applies to ",(0,n.jsx)(t.strong,{children:"click through rates (CTR)"}),' in any part of a step-wise product journey (aka funnels). Statsig recommends using unique users in both the numerator and denominator for defining these kinds of metrics. As an example, when a user reloads a page multiple times but clicks only once, this corresponds to a 100% CTR (1 out of 1). Similarly, a user who loads a page once but clicks multiple times on a button should only count as 1 out of 1. This also solves for cases where users see an important button such as "Sign-up" multiple times a day, and we would still consider it a success if they click just once.']}),"\n",(0,n.jsxs)(t.p,{children:["The example below shows creating a metric for ",(0,n.jsx)(t.strong,{children:"Items per Cart"}),". You can track the number of unique items added to a cart if you log an ",(0,n.jsx)(t.em,{children:"add_to_cart"})," event for each item. For the numerator, select total event count. For the denominator, select unique users. As this metric is computed daily and only for users with a non-zero denominator, this metric can generate ratios such as 1/1, 2/1, 2/1, and 5/1 for individual users. When aggregated, this translates to 10/4 = 2.5 items per cart on average per day."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/101903926/cf6e6777-a154-4eeb-9a2d-81893810a31d",alt:"Screen Shot 2023-09-12 at 1 30 28 PM"})}),"\n",(0,n.jsx)(t.admonition,{title:"A Word of Caution",type:"info",children:(0,n.jsxs)(t.p,{children:["In experimentation, ratio metrics are a frequent source of misleading information. It's possible to see an increase in ",(0,n.jsx)(t.strong,{children:"click through rate"})," alongside a net ",(0,n.jsx)(t.em,{children:"decrease"})," in total clicks (the opposite may also happen). This situation can occur if the number of unique users viewing a button (denominator) decreases. As a best practice, Statsig recommends tracking the numerator and denominator as independent metrics when monitoring ratio indicator. Ratio metrics are often subject to statistical noise and can be tricky to use for obtaining a statistically significant result. In addition, for the numerator in ratios, we exclude units which don't have a denominator value."]})}),"\n",(0,n.jsx)(t.h3,{id:"5-funnel-metrics",children:"5. Funnel Metrics"}),"\n",(0,n.jsxs)(t.p,{children:["You can create a custom funnel metric, from either the Custom Metrics Creation wizard in the Metrics Catalog or via the ",(0,n.jsx)(t.strong,{children:"Charts"})," tab."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/101903926/86914826-b8ce-4b4b-9514-39f31d05687a",alt:"Screen Shot 2023-09-12 at 1 33 10 PM"})}),"\n",(0,n.jsx)(t.admonition,{title:"Important Note",type:"info",children:(0,n.jsxs)(t.p,{children:["Statsig handles funnel metrics differently between our Cloud and Warehouse Native platforms. Funnel metrics using our Cloud platform are ",(0,n.jsx)(t.em,{children:"always"})," unordered, meaning that funnel steps can be completed in any order, and they have a time window of ",(0,n.jsx)(t.em,{children:"one day"}),". This means that for the metric to record a completion, all steps must be triggered by a user within 24 hours. In contrast, funnel metrics on Warehouse Native have the option to be set with strict ordering and custom time windows."]})}),"\n",(0,n.jsx)(t.h3,{id:"components-of-funnel-metrics",children:"Components of Funnel Metrics"}),"\n",(0,n.jsx)(t.p,{children:"Funnel metrics have a few components:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Lineage"}),": Surfaces the events used to generate the funnel"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Metric Value"}),": Metric value represents the overall funnel conversion rate, or the percentage of users who complete a funnel (trigger the end event) relative to all users who start the funnel (trigger the starting event)"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Conversion rate between stages"}),": This set of metrics track the percentage of users who triggered an event N relative to all users that triggered event N-1 in the funnel"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://user-images.githubusercontent.com/101903926/172446711-5511e394-b353-4d38-97f1-1b681b67042b.png",alt:"Screen Shot 2022-06-07 at 10 34 58 AM"})}),"\n",(0,n.jsx)(t.p,{children:"After funnels are created and populated, you can view your funnel metric much like any other metric in Pulse. Additionally, you can expand the funnel metric to view Pulse performance at each step in the funnel."}),"\n",(0,n.jsxs)(t.p,{children:["In the example below, the ",(0,n.jsx)(t.strong,{children:"Square"})," variant shows a lift in the ",(0,n.jsx)(t.strong,{children:"overall funnel conversion rate"}),". Expanding the metrics to examine the entire funnel reveals two key insights:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Both the ",(0,n.jsx)(t.strong,{children:"Square"})," and ",(0,n.jsx)(t.strong,{children:"Circle"})," variants show a lift in top-of-funnel DAU (",(0,n.jsx)(t.em,{children:"Land Page View Start DAU"}),"). However, only the ",(0,n.jsx)(t.strong,{children:"Square"})," variant shows statistically significant increase in end-of-funnel DAU (",(0,n.jsx)(t.em,{children:"Purchase Event End DAU"}),")."]}),"\n",(0,n.jsxs)(t.li,{children:["The overall funnel conversion rate improvement for ",(0,n.jsx)(t.strong,{children:"Square"})," is primarily due to the higher conversion from ",(0,n.jsx)(t.em,{children:"Checkout Event"})," to ",(0,n.jsx)(t.em,{children:"Purchase Event"})," stages in the funnel."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:"https://user-images.githubusercontent.com/90343952/148440643-8e8a24bd-934d-4100-a15a-abcbcc4bb11c.png",alt:"Funnel experiment results showing Square variant performance"})}),"\n",(0,n.jsx)(t.h3,{id:"6-count-distinct-metrics",children:"6 Count Distinct Metrics"}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsx)(t.p,{children:"Sketch-based count distinct metrics are not live yet."})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"What it is:"})," A high-performance way to estimate the number of distinct values using compact sketch data structures. Example use cases include trying to determine unique songs per user or unique products purchased by user."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Benefit:"})," Delivers much faster computation and uses significantly less memory compared to full exact distinct counting, especially at high cardinality."]}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"custom-metrics--dimensions",children:"Custom Metrics & Dimensions"}),"\n",(0,n.jsxs)(t.p,{children:["For Custom Metrics that are composed of a single event (event count/ event dau, aggregation, etc.), the dimensions of the source event will be automatically pulled through into the Custom Metric and be exposed as dimensions of that Custom Metric. However, if your Custom Metric is composed of 2+ different events, any associated dimension(s) of the source input events will ",(0,n.jsx)(t.em,{children:"not"}),' be pulled through as dimensions of the Custom Metric and are also not queryable today via the "Explore" tab in Pulse Results.']})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var n=s(96540);const r={},i=n.createContext(r);function a(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);