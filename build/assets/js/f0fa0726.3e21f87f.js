"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[97405],{31891:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>u,contentTitle:()=>c,default:()=>g,frontMatter:()=>l,metadata:()=>d,toc:()=>h});var a=s(74848),n=s(28453),i=s(55088),r=s(11470),o=s(19365);s(96747);const l={title:"Working With Stable ID",sidebar_label:"Stable ID",slug:"/client/javascript-sdk/stable-id",displayed_sidebar:"cloud",keywords:["owner:brock"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},c=void 0,d={id:"client/javascript-mono/StableID",title:"Working With Stable ID",description:"StableID",source:"@site/docs/client/javascript-mono/StableID.mdx",sourceDirName:"client/javascript-mono",slug:"/client/javascript-sdk/stable-id",permalink:"/client/javascript-sdk/stable-id",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/client/javascript-mono/StableID.mdx",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Working With Stable ID",sidebar_label:"Stable ID",slug:"/client/javascript-sdk/stable-id",displayed_sidebar:"cloud",keywords:["owner:brock"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud"},u={},h=[{value:"StableID",id:"stableid",level:2},{value:"How it works",id:"how-it-works",level:3},{value:"Accessing the StableID",id:"accessing-the-stableid",level:3},{value:"Overriding StableID",id:"overriding-stableid",level:3},{value:"Persisting StableID across subdomain",id:"persisting-stableid-across-subdomain",level:3},{value:"Keeping StableID Consistent across Client &amp; Server",id:"keeping-stableid-consistent-across-client--server",level:3}];function p(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"stableid",children:"StableID"}),"\n",(0,a.jsxs)(t.p,{children:["StableID is a concept in Statsig that allows us to have a consistent identifier for a single device.\nThis allows Statsig to run ",(0,a.jsx)(t.a,{href:"/guides/first-device-level-experiment",children:"experiments on logged out"})," users (users without a UserID)\nas well as target gates on the device level rather than the user level."]}),"\n",(0,a.jsx)(t.h3,{id:"how-it-works",children:"How it works"}),"\n",(0,a.jsx)(t.p,{children:"When you initialize the SDK for the first time, it checks if a StableID is already present in local storage.\nIf it's missing, the SDK generates a new StableID and saves it in local storage. On subsequent initializations,\nthe SDK retrieves and reuses the previously stored StableID."}),"\n",(0,a.jsxs)(t.p,{children:["The StableID is stored in local storage under the key ",(0,a.jsx)(t.code,{children:"statsig.stable_id.<SDK_KEY_HASH>"}),".\nEach SDK key has its own StableID, meaning that if you're using multiple SDK keys, each one will have a separate StableID."]}),"\n",(0,a.jsx)(t.p,{children:"It's important to note that local storage is not shared across different domains or subdomains.\nThis means that if you are working across multiple domains or subdomains, the StableID will be isolated to each domain's local storage."}),"\n",(0,a.jsxs)(t.p,{children:["If you need a StableID to persist across domains, you'll need to implement your own mechanism to store and retrieve the StableID, such as using a cookie as ",(0,a.jsx)(t.a,{href:"#persisting-stableid-across-subdomain",children:"demonstrated here"}),"."]}),"\n",(0,a.jsx)(t.p,{children:"The Statsig SDK does not use any cookies itself."}),"\n",(0,a.jsx)(t.h3,{id:"accessing-the-stableid",children:"Accessing the StableID"}),"\n",(0,a.jsxs)(t.p,{children:["You can access StableID that the Statsig client is using by calling ",(0,a.jsx)(t.code,{children:"getContext()"})," and then checking the ",(0,a.jsx)(t.code,{children:"stableID"})," field."]}),"\n",(0,a.jsxs)(r.A,{defaultValue:"js",groupId:"language-choice",values:[{label:"Javascript",value:"js"},{label:"React",value:"react"}],children:[(0,a.jsx)(o.A,{value:"js",children:(0,a.jsx)(i.A,{url:"https://raw.githubusercontent.com/statsig-io/js-client-monorepo/main/samples/react/src/samples/precomputed-client/sample-precomp-access-stable-id.tsx"})}),(0,a.jsx)(o.A,{value:"react",children:(0,a.jsx)(i.A,{url:"https://raw.githubusercontent.com/statsig-io/js-client-monorepo/main/samples/react/src/samples/react-precomp/sample-react-precomp-access-stable-id.tsx"})})]}),"\n",(0,a.jsx)(t.h3,{id:"overriding-stableid",children:"Overriding StableID"}),"\n",(0,a.jsxs)(t.p,{children:["If your app already has something similar to a StableID and you would prefer to use that instead,\nyou can override the default behavior by simply passing your value in as part of the ",(0,a.jsx)(t.code,{children:"StatsigUser"})," object."]}),"\n",(0,a.jsxs)(r.A,{defaultValue:"js",groupId:"language-choice",values:[{label:"Javascript",value:"js"},{label:"React",value:"react"}],children:[(0,a.jsx)(o.A,{value:"js",children:(0,a.jsx)(i.A,{url:"https://raw.githubusercontent.com/statsig-io/js-client-monorepo/main/samples/react/src/samples/precomputed-client/sample-precomp-stable-id-overrride.tsx"})}),(0,a.jsx)(o.A,{value:"react",children:(0,a.jsx)(i.A,{url:"https://raw.githubusercontent.com/statsig-io/js-client-monorepo/main/samples/react/src/samples/react-precomp/sample-react-stable-id-override.tsx"})})]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsx)(t.p,{children:"Once overridden, the new StableID will be persisted to local storage so it will be used for future sessions."})}),"\n",(0,a.jsx)(t.h3,{id:"persisting-stableid-across-subdomain",children:"Persisting StableID across subdomain"}),"\n",(0,a.jsx)(t.p,{children:"If you are assigning a user to a test on one subdomain, and tracking behavior for metrics purposes on a different subdomain, you'll need to have this solution in place to ensure Statsig can properly attribute cross-origin behavior to the Test Group assignment that took place on the initial experiment domain."}),"\n",(0,a.jsx)(t.p,{children:"To install, simply paste the first script tag prior to SDK initialization and include code that manually pulls the stableID onto the user object."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'\x3c!-- cross domain id script --\x3e\n<script>!function(){let t="STATSIG_LOCAL_STORAGE_STABLE_ID";function e(){if(crypto&&crypto.randomUUID)return crypto.randomUUID();let t=()=>Math.floor(65536*Math.random()).toString(16).padStart(4,"0");return`${t()}${t()}-${t()}-4${t().substring(1)}-${t()}-${t()}${t()}${t()}`}let i=null,n=localStorage.getItem(t)||null;if(document.cookie.match(/statsiguuid=([\\w-]+);?/)&&([,i]=document.cookie.match(/statsiguuid=([\\w-]+);?/)),i&&n&&i===n);else if(i&&n&&i!==n)localStorage.setItem(t,i);else if(i&&!n)localStorage.setItem(t,i);else{let o=e();localStorage.setItem(t,o),function t(i){let n=new Date;n.setMonth(n.getMonth()+12);let o=window.location.host.split(".");o.length>2&&o.shift();let s=`.${o.join(".")}`;document.cookie=`statsiguuid=${i||e()};Expires=${n};Domain=${s};Path=/`}(o)}}();<\/script>\n\n\x3c!-- Manually attach stableID to user object --\x3e\n<script>\nconst userObj = {};\nif(localStorage.getItem(\'STATSIG_LOCAL_STORAGE_STABLE_ID\')) {\n  userObj.customIDs = {stableID: localStorage.getItem(\'STATSIG_LOCAL_STORAGE_STABLE_ID\')};\n}\nconst statsigClient = new Statsig.StatsigClient(\'<client-sdk-key>\', userObj, {/* OPTIONS */});\n<\/script>\n'})}),"\n",(0,a.jsx)("center",{children:(0,a.jsx)("small",{children:"(please use the above code at your discretion and test thoroughly)"})}),"\n",(0,a.jsx)(t.h3,{id:"keeping-stableid-consistent-across-client--server",children:"Keeping StableID Consistent across Client & Server"}),"\n",(0,a.jsx)(t.p,{children:"If you have a backend service running a Statsig SDK as well as using the Statsig client in your frontend,\nyou may need to have the same StableID accessible in both environments."}),"\n",(0,a.jsx)(t.p,{children:"It is highly dependent on your setup, but usually you can send the StableID up with any requests from your frontend.\nIf the backend ever receives a request without a StableID, it can generate one and have the client store it (usually as a cookie) for future requests."}),"\n",(0,a.jsx)(t.p,{children:"Because Server SDKs are designed to handle multiple Users, they do not generate their own StableIDs."}),"\n",(0,a.jsx)(t.p,{children:"Here is an example showing how you might use a cookie to share the StableID across client and server and use it bootstrap the client SDK."}),"\n",(0,a.jsx)(i.A,{url:"https://raw.githubusercontent.com/statsig-io/js-client-monorepo/main/samples/react/src/samples/precomputed-client/sample-precomp-bootstrap-full.tsx"})]})}function g(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},96747:(e,t,s)=>{s.d(t,{PG:()=>u});var a=s(74848),n=s(28453);function i(e){return(0,a.jsx)("div",{style:{height:4}})}function r(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(i,{...e})}):i()}var o=s(96540),l=(s(65848),s(5338));function c(){let e=null;try{const t=document.querySelector(".theme-last-updated > b > time");t&&null!=t.dateTime&&(e=new Date(t.dateTime).toLocaleDateString("en-us",{year:"numeric",month:"short",day:"numeric"}))}catch(t){}return(0,a.jsx)("div",{onClick:e=>e.preventDefault(),style:{cursor:"default",padding:"10px 20px",backgroundColor:"var(--ifm-navbar-background-color)",borderRadius:10,fontSize:12,color:"var(--ifm-color-content)"},children:(0,a.jsx)("a",{onClick:()=>window.open("https://statsig.com/community?ref=statsig_docs_toc","_blank").focus(),href:"#",children:(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,a.jsx)("img",{src:"/img/slack.webp",style:{height:15,width:15}}),(0,a.jsx)("span",{style:{marginLeft:8},children:"Stuck? Ask Statsig on Slack"})]})})})}function d(){return(0,o.useEffect)((()=>{const e=document.querySelector("#sdk-toc-header");if(e?.getAttribute("x-last-updated")){l.createRoot(document.getElementById("sdk-toc-header")).render((0,a.jsx)(c,{}))}}),[]),(0,a.jsx)(a.Fragment,{})}const u=e=>{const t=e.sections,s=[];s.push({value:`<div id="sdk-toc-header" x-last-updated="${e.lastSDKDocsUpdate}"><div style="min-height: 65px; cursor: default; padding: 10px 20px; background-color: var(--ifm-navbar-background-color); border-radius: 10px; font-size: 12px; margin-bottom: 15px; color: var(--ifm-color-content);">...</div></div>`,id:"0",level:2});const n=t.map((([e,t],n)=>{const i=e.tocFilter,l=e.toc.filter((e=>!0!==i?.includes(e.id)));return s.push(...l),(0,a.jsxs)(o.Fragment,{children:[(0,a.jsx)(e.default,{...t}),(0,a.jsx)(r,{})]},n)}));return{result:[(0,a.jsx)(d,{},"header"),...n],toc:s}}},55088:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(96540),n=s(21432),i=s(74848);let r;function o(){if(r)return r;const{StatsigClient:e,runStatsigAutoCapture:t,runStatsigSessionReplay:s}=window.Statsig;return r=new e("client-rfLvYGag3eyU0jYW5zcIJTQip7GXxSrhOFN69IGMjvq",{userID:""}),t(r),s(r),r.initializeAsync().catch((e=>console.error(e))),r}function l(e){const t=e.split("\n"),s=[];let a=!1;for(const n of t)n.includes("<snippet>")?a=!0:n.includes("</snippet>")?a=!1:a&&s.push(n);return s.join("\n")}function c(e){let{url:t,language:s}=e;const[r,c]=(0,a.useState)(null);return function(){try{return o().checkGate("partial_gate")}catch(e){}}(),(0,a.useEffect)((()=>{!function(e,t){try{o().logEvent({eventName:"gh_embed_render",value:e.replace("https://raw.githubusercontent.com/statsig-io",""),metadata:{language:t}})}catch(s){}}(t,s);(async()=>{try{const e=Date.now(),s=await fetch(t);if(!s.ok)throw new Error("Network response was not ok");const a=500,n=await s.text(),i=Date.now()-e;i<a?setTimeout((()=>c(l(n))),a-i):c(l(n))}catch(e){c(`// Failed to load example.\n// View on GitHub:\n// ${t}`),function(e,t,s){try{o().logEvent({eventName:"gh_embed_error",value:e,metadata:{language:t,error:s}})}catch(s){}}(t,s,e)}})()}),[t]),(0,i.jsxs)("div",{style:{overflow:"hidden"},children:[null==r&&(0,i.jsx)(n.A,{language:s??"tsx",children:(0,i.jsx)("div",{style:{textAlign:"center",padding:"50px 0px 50px 0px"},children:"..."})}),null!=r&&(0,i.jsx)(n.A,{language:s??"tsx",children:r})]})}}}]);