"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[58410],{93060:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var i=s(74848),n=s(28453);const r={sidebar_label:"Private Attributes",title:"Using Private Attributes",keywords:["owner:brock"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},a=void 0,o={id:"guides/private-attributes",title:"Using Private Attributes",description:"Evaluating feature gates, dynamic configs, segments, and experiments without logging user data to Statsig",source:"@site/docs/guides/private-attributes.mdx",sourceDirName:"guides",slug:"/guides/private-attributes",permalink:"/guides/private-attributes",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/guides/private-attributes.mdx",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{sidebar_label:"Private Attributes",title:"Using Private Attributes",keywords:["owner:brock"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"User Data Deletion Requests API",permalink:"/compliance/user_data_deletion_requests"},next:{title:"Infrastructure Operations",permalink:"/infrastructure/introduction"}},l={},d=[{value:"Evaluating feature gates, dynamic configs, segments, and experiments without logging user data to Statsig",id:"evaluating-feature-gates-dynamic-configs-segments-and-experiments-without-logging-user-data-to-statsig",level:2},{value:"How It Works",id:"how-it-works",level:2},{value:"Client vs Server SDKs",id:"client-vs-server-sdks",level:2},{value:"Event Logging",id:"event-logging",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"evaluating-feature-gates-dynamic-configs-segments-and-experiments-without-logging-user-data-to-statsig",children:"Evaluating feature gates, dynamic configs, segments, and experiments without logging user data to Statsig"}),"\n",(0,i.jsx)(t.p,{children:"We take privacy, and the privacy of your user data, very seriously.  If you have legal requirements that prevent you from sending PII to third parties, or you are just uncomfortable sending PII to a third party service, it is still possible to use Statsig for feature gating, configs, or experiments."}),"\n",(0,i.jsx)(t.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,i.jsx)(t.p,{children:"Any field you wish to evaluate on can be made private.  Note that if you make the userID field private, your experience in the Statsig console will be broken (the user's tab, metrics charts, event logs, and pulse metrics will be unable to populate accurately).  If you wish to hide the UserID, we recommend you use a stable, one-way hash to maintain the ability to analyze user behavior."}),"\n",(0,i.jsx)(t.p,{children:"For example, let's say you want to use an email condition:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Create a feature gate with a condition that passes on certain emails or domains"}),"\n",(0,i.jsxs)(t.li,{children:["Pass ",(0,i.jsx)(t.code,{children:"email: email@domain.com"})," in ",(0,i.jsx)(t.code,{children:"privateAttributes"})," rather than in the top level ",(0,i.jsx)(t.code,{children:"email"})," field"]}),"\n",(0,i.jsxs)(t.li,{children:["Test it out in the ",(0,i.jsx)(t.code,{children:"Test Gate"})," console after saving changes"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"Private attributes",src:s(43218).A+"",width:"1133",height:"1005"})}),"\n",(0,i.jsxs)(t.p,{children:["When evaluating rules and conditions, Statsig first checks for fields at the top level, then in the custom attributes, and finally, in the private attributes.  By simply not passing email at the top level, the evaluator will keep looking in other possible places before evaluating the condition (",(0,i.jsx)(t.code,{children:"custom"}),", and then ",(0,i.jsx)(t.code,{children:"privateAttributes"}),").\nSo if you want to keep the ip address and user agent private, but still use browser or IP checks in the console, simply put them in the ",(0,i.jsx)(t.code,{children:"privateAttributes"})," dictionary instead of at the top level of the user.  The same goes for country, locale, custom fields, and so on."]}),"\n",(0,i.jsxs)(t.p,{children:["Our statsig-node SDK illustrates how this works (and is exactly how we evaluate gates on our servers as well): ",(0,i.jsx)(t.a,{href:"https://github.com/statsig-io/node-js-server-sdk/blob/d1cb9431fb68b40f840254fce70363de1dc51aa5/src/Evaluator.js#L374",children:"https://github.com/statsig-io/node-js-server-sdk/blob/d1cb9431fb68b40f840254fce70363de1dc51aa5/src/Evaluator.js#L374"})]}),"\n",(0,i.jsx)(t.admonition,{type:"warning",children:(0,i.jsxs)(t.p,{children:["Do not provide a ",(0,i.jsx)(t.code,{children:"privateAttribute"})," key anywhere else in the ",(0,i.jsx)(t.code,{children:"user"})," object.  The entire ",(0,i.jsx)(t.code,{children:"privateAttributes"})," dictionary is dropped, but any duplicate fields at the top level or in the custom object will still be logged (and evaluated against)"]})}),"\n",(0,i.jsx)(t.h2,{id:"client-vs-server-sdks",children:"Client vs Server SDKs"}),"\n",(0,i.jsxs)(t.p,{children:["Client/single user environment SDKs send the user object with the ",(0,i.jsx)(t.code,{children:"initialize"})," call to evaluate the user against every gate in your Statsig project.\n",(0,i.jsx)(t.em,{children:"privateAttributes will be sent with this call but will not be stored or logged on Statsig servers"}),".  In order to evaluate the conditions and rules for a gate, config, or experiment, Statsig servers need to know the privateAttributes field.  It will be stripped from the users for any logging on Statsig servers.\nClient SDKs will remove privateAttributes before any events are logged - they are only needed for gate evaluation."]}),"\n",(0,i.jsxs)(t.p,{children:["Example with the ",(0,i.jsx)(t.code,{children:"@statsig/js-client"})," SDK: ",(0,i.jsx)(t.a,{href:"https://github.com/statsig-io/js-client-monorepo/blob/17fb70f1bea00d07e156cf6ff03b8024bbc1b197/packages/client-core/src/EventLogger.ts#L325",children:"https://github.com/statsig-io/js-client-monorepo/blob/17fb70f1bea00d07e156cf6ff03b8024bbc1b197/packages/client-core/src/EventLogger.ts#L325"})]}),"\n",(0,i.jsxs)(t.p,{children:["If this does not meet your needs, our Server SDKs are able to make a stronger guarantee - ",(0,i.jsx)(t.code,{children:"privateAttributes"})," will never leave your server.  Statsig server SDKs\ndownload the definition of each gate/config/experiment and evaluate them locally."]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"privateAttributes"})," stripped from event logs with the ",(0,i.jsx)(t.code,{children:"statsig-node"})," SDK: ",(0,i.jsx)(t.a,{href:"https://github.com/statsig-io/node-js-server-sdk/blob/d1cb9431fb68b40f840254fce70363de1dc51aa5/src/LogEvent.js#L21",children:"https://github.com/statsig-io/node-js-server-sdk/blob/d1cb9431fb68b40f840254fce70363de1dc51aa5/src/LogEvent.js#L21"})]}),"\n",(0,i.jsxs)(t.p,{children:["Evaluation happening locally to the server on ",(0,i.jsx)(t.code,{children:"privateAttributes"})," in the ",(0,i.jsx)(t.code,{children:"statsig-node"})," SDK: ",(0,i.jsx)(t.a,{href:"https://github.com/statsig-io/node-js-server-sdk/blob/d1cb9431fb68b40f840254fce70363de1dc51aa5/src/Evaluator.js#L374",children:"https://github.com/statsig-io/node-js-server-sdk/blob/d1cb9431fb68b40f840254fce70363de1dc51aa5/src/Evaluator.js#L374"})]}),"\n",(0,i.jsxs)(t.p,{children:["Don't just take our word for it - all of our SDKs are open source and ",(0,i.jsx)(t.a,{href:"https://github.com/statsig-io",children:"available on github"}),".  Feel free to dive in to the implementation of ",(0,i.jsx)(t.code,{children:"privateAttributes"})," in the SDK you are using, or reach out to us on ",(0,i.jsx)(t.a,{href:"https://www.statsig.com/slack",children:"slack"})," and we can point you in the right direction."]}),"\n",(0,i.jsx)(t.admonition,{type:"info",children:(0,i.jsxs)(t.p,{children:["To ensure that user PII is never transmitted over the network back to Statsig during Client SDK initialization, you should use ",(0,i.jsx)(t.a,{href:"/client/concepts/initialize#bootstrapping-overview",children:"Client Boostrapping"})," and provide the ",(0,i.jsx)(t.code,{children:"privateAttributes"})," as part of the user object on the server to the ",(0,i.jsx)(t.code,{children:"getClientInitializeResponse(<user object>)"})," call. This will generate all of the assignments locally on your server, and these assignments can then be passed as ",(0,i.jsx)(t.code,{children:"initializeValues"})," to the client SDK, negating the need to send any user attributes from the client device to Statsig."]})}),"\n",(0,i.jsx)(t.h2,{id:"event-logging",children:"Event Logging"}),"\n",(0,i.jsxs)(t.p,{children:["The privateAttributes field will be stripped from the user object for any ",(0,i.jsx)(t.code,{children:"logEvent"})," calls on client or server SDKs.  On server SDKs, you can simply not provide that field for ",(0,i.jsx)(t.code,{children:"logEvent"})," calls if you wish - no evaluation is happening, so they are not necessary.  If you are using the same user everywhere, the SDK will handle dropping the ",(0,i.jsx)(t.code,{children:"privateAttributes"})," for you."]})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},43218:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/private-attributes-69a4d8794fa2b17f1b5a0fc42c6c41c3.png"},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var i=s(96540);const n={},r=i.createContext(n);function a(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);