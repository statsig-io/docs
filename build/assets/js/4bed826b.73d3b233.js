"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[77380],{5017:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>u,toc:()=>h});var a=n(74848),i=n(28453),s=n(11470),r=n(19365),o=n(55088);const l={title:"Migrating to @statsig/react-bindings",sidebar_label:"Migrating to @statsig/react-bindings",slug:"/client/javascript-sdk/migrating-from-statsig-react",keywords:["owner:brock"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},c=void 0,u={id:"client/javascript-mono/MigrationFromOldReact",title:"Migrating to @statsig/react-bindings",description:"Migrate soon! Official support for statsig-react ends Jan 31, 2025.",source:"@site/docs/client/javascript-mono/MigrationFromOldReact.mdx",sourceDirName:"client/javascript-mono",slug:"/client/javascript-sdk/migrating-from-statsig-react",permalink:"/client/javascript-sdk/migrating-from-statsig-react",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/client/javascript-mono/MigrationFromOldReact.mdx",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Migrating to @statsig/react-bindings",sidebar_label:"Migrating to @statsig/react-bindings",slug:"/client/javascript-sdk/migrating-from-statsig-react",keywords:["owner:brock"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"api",previous:{title:"Migrating to @statsig/js-client",permalink:"/client/javascript-sdk/migrating-from-statsig-js"},next:{title:"Node",permalink:"/server-core/node-core"}},d={},h=[{value:"Initialize",id:"initialize",level:3},{value:"waitForInitialization and initializingComponent",id:"waitforinitialization-and-initializingcomponent",level:3},{value:"Bootstrapping the StatsigClient",id:"bootstrapping-the-statsigclient",level:3},{value:"Updating the User",id:"updating-the-user",level:3}];function g(e){const t={a:"a",admonition:"admonition",code:"code",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.admonition,{title:"DEPRECATED",type:"warning",children:(0,a.jsx)(t.p,{children:"Migrate soon! Official support for statsig-react ends Jan 31, 2025."})}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["Also refer to our ",(0,a.jsx)(t.a,{href:"/client/javascript-sdk/migrating-from-statsig-js",children:"migration from js-client guide"}),", which lists other impacts on statsig-react installations."]})}),"\n",(0,a.jsx)(t.p,{children:"Breaking Changes:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["Our ",(0,a.jsx)(t.a,{href:"/client/javascript-sdk/migrating-from-statsig-react#initialize",children:"initialization pattern"})," has changed, along with ",(0,a.jsx)(t.a,{href:"/client/javascript-sdk/migrating-from-statsig-react#waitforinitialization-and-initializingcomponent",children:"waitForInitialization and initializeComponent"})]}),"\n",(0,a.jsxs)(t.li,{children:["Bootstrapping has changed, now requiring a new hashing parameter: ",(0,a.jsx)(t.a,{href:"/client/javascript-sdk/migrating-from-statsig-react#bootstrapping-the-statsigclient",children:"Bootstrapping the StatsigClient"})]}),"\n"]}),"\n",(0,a.jsx)(t.h3,{id:"initialize",children:"Initialize"}),"\n",(0,a.jsxs)(t.p,{children:["In the old ",(0,a.jsx)(t.code,{children:"statsig-react"})," package, all values needed to be given to the StatsigProvider,\nwhich internally would setup the Statsig client instance. This approach lead to issues in managing state between\nthe Statsig client and the StatsigProvider, making it fragile and likely to break if you ever tried using the Statsig client directly."]}),"\n",(0,a.jsx)(t.p,{children:"The new approach is to run everything through the Statsig client instance, and just pass that to the StatsigProvider."}),"\n",(0,a.jsxs)(s.A,{groupId:"js-migration-choice",defaultValue:"new",values:[{label:"statsig-react (Legacy)",value:"legacy"},{label:"New",value:"new"}],children:[(0,a.jsx)(r.A,{value:"legacy",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-jsx",children:'import { StatsigProvider } from "statsig-react";\n\nfunction App() {\n  return (\n    <StatsigProvider\n      sdkKey="<STATSIG_CLIENT_SDK_KEY>"\n      user={{ userID: "a-user" }}\n      waitForInitialization={true}\n      // StatsigOptions (Not Required)\n      options={{\n        environment: { tier: "staging" },\n      }}\n    >\n      <div className="App">{/* Rest of App ... */}</div>\n    </StatsigProvider>\n  );\n}\n'})})}),(0,a.jsx)(r.A,{value:"new",children:(0,a.jsx)(o.A,{language:"jsx",url:"https://raw.githubusercontent.com/statsig-io/js-client-monorepo/main/samples/react/src/samples/react-precomp/sample-react-precomp-initialize.tsx"})})]}),"\n",(0,a.jsx)(t.h3,{id:"waitforinitialization-and-initializingcomponent",children:"waitForInitialization and initializingComponent"}),"\n",(0,a.jsxs)(t.p,{children:["In the older versions of the ",(0,a.jsx)(t.code,{children:"StatsigProvider"}),", it was possible to set the ",(0,a.jsx)(t.code,{children:"waitForInitialization"})," to block children from rendering until after the latest\nvalues were fetched from Statsig and if a ",(0,a.jsx)(t.code,{children:"initializeComponent"})," was set, this was displayed while the latest values were fetched."]}),"\n",(0,a.jsxs)(t.p,{children:["It was also possible to set ",(0,a.jsx)(t.code,{children:"waitForInitialization"})," to ",(0,a.jsx)(t.code,{children:"false"}),", meaning the StatsigProvider would render immediately, before values were ready. This was not recommended as it meant values could change between checks, resulting in unexpected layout changes."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"Where did waitForInitialization go?"})}),"\n",(0,a.jsxs)(t.p,{children:["In the newer ",(0,a.jsx)(t.code,{children:"StatsigProvider"})," this is no longer an option as we want to prevent developers from unintentionally allowing values to change mid-session.\nIt is still possible to get the same behavior as setting ",(0,a.jsx)(t.code,{children:"waitForInitialization"})," to false, but we recommend against it."]}),"\n",(0,a.jsxs)(t.p,{children:["Read the ",(0,a.jsx)(t.a,{href:"/client/javascript-sdk/init-strategies",children:"Initialization Strategies"})," guide to learn how to replicate the ",(0,a.jsx)(t.code,{children:"waitForInitialization=false"})," behavior, as well as the recommended approaches to synchronous initialization."]}),"\n",(0,a.jsx)(t.h3,{id:"bootstrapping-the-statsigclient",children:"Bootstrapping the StatsigClient"}),"\n",(0,a.jsxs)(t.p,{children:["If you are using a Statsig Server SDK to bootstrap the Statsig Client used by your React app, you may need to make some updates to how your server SDK generates values.\nOne of the optimizations we made with the ",(0,a.jsx)(t.code,{children:"@statsig/js-client"})," SDK was to remove the ",(0,a.jsx)(t.code,{children:"sha256"})," library for hashing gate/experiment names.\nInstead, we use a ",(0,a.jsx)(t.code,{children:"djb2"})," hash. This does not change any of the bucketing logic, only the obfuscation method used for the payload."]}),"\n",(0,a.jsxs)(t.p,{children:["By default, all server SDKs generate ",(0,a.jsx)(t.code,{children:"sha256"})," hashes of gate/experiment names in the ",(0,a.jsx)(t.code,{children:"getClientInitializeResponse"})," method.\nYou will need to set the hash algorithm parameter to that method call to ",(0,a.jsx)(t.code,{children:'"djb2"'})," instead in order to bootstrap this new client SDK.\nOne of the benefits to this hashing algorithm is it will make the entire payload smaller as well, so its a net win on package size, speed, and payload size for the SDK."]}),"\n",(0,a.jsx)(t.p,{children:"For example, if you are bootstrapping from the Statsig Node SDK, you will need to do:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"statsig.getClientInitializeResponse(\n  user,\n  '[client-key]',\n  {\n    hash: 'djb2', // <- New Hashing Algorithm\n  },\n);\n"})}),"\n",(0,a.jsx)(t.h3,{id:"updating-the-user",children:"Updating the User"}),"\n",(0,a.jsxs)(s.A,{groupId:"js-migration-choice",defaultValue:"new",values:[{label:"statsig-react (Legacy)",value:"legacy"},{label:"New",value:"new"}],children:[(0,a.jsx)(r.A,{value:"legacy",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-jsx",children:'import { useContext, useState } from "react";\nimport { StatsigUser, StatsigProvider, StatsigContext } from "statsig-react";\n\nfunction UpdateUserButton() {\n  const { updateUser } = useContext(StatsigContext);\n\n  return <button onClick={() => updateUser({ userID: "b-user" })}>Update</button>\n}\n\nfunction App() {\n  const [user, setUser] = useState<StatsigUser>({ userID: "a-user" });\n\n  return (\n    <StatsigProvider\n      sdkKey="<STATSIG_CLIENT_SDK_KEY>"\n      user={user}\n      setUser={setUser}\n    >\n      <UpdateUserButton />\n    </StatsigProvider>\n  );\n}\n'})})}),(0,a.jsx)(r.A,{value:"new",children:(0,a.jsx)(o.A,{language:"jsx",url:"https://raw.githubusercontent.com/statsig-io/js-client-monorepo/main/samples/react/src/samples/react-precomp/sample-react-precomp-update-user.tsx"})})]})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(g,{...e})}):g(e)}},19365:(e,t,n)=>{n.d(t,{A:()=>r});n(96540);var a=n(34164);const i={tabItem:"tabItem_Ymn6"};var s=n(74848);function r(e){let{children:t,hidden:n,className:r}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.A)(i.tabItem,r),hidden:n,children:t})}},11470:(e,t,n)=>{n.d(t,{A:()=>y});var a=n(96540),i=n(34164),s=n(23104),r=n(56347),o=n(205),l=n(57485),c=n(31682),u=n(70679);function d(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:i}}=e;return{value:t,label:n,attributes:a,default:i}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function g(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function p(e){let{queryString:t=!1,groupId:n}=e;const i=(0,r.W6)(),s=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l.aZ)(s),(0,a.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(i.location.search);t.set(s,e),i.replace({...i.location,search:t.toString()})}),[s,i])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:i}=e,s=h(e),[r,l]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!g({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:s}))),[c,d]=p({queryString:n,groupId:i}),[m,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[i,s]=(0,u.Dv)(n);return[i,(0,a.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:i}),v=(()=>{const e=c??m;return g({value:e,tabValues:s})?e:null})();(0,o.A)((()=>{v&&l(v)}),[v]);return{selectedValue:r,selectValue:(0,a.useCallback)((e=>{if(!g({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),f(e)}),[d,f,s]),tabValues:s}}var f=n(92303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=n(74848);function j(e){let{className:t,block:n,selectedValue:a,selectValue:r,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),u=e=>{const t=e.currentTarget,n=l.indexOf(t),i=o[n].value;i!==a&&(c(t),r(i))},d=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},t),children:o.map((e=>{let{value:t,label:n,attributes:s}=e;return(0,b.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>l.push(e),onKeyDown:d,onClick:u,...s,className:(0,i.A)("tabs__item",v.tabItem,s?.className,{"tabs__item--active":a===t}),children:n??t},t)}))})}function x(e){let{lazy:t,children:n,selectedValue:s}=e;const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=r.find((e=>e.props.value===s));return e?(0,a.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:r.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==s})))})}function w(e){const t=m(e);return(0,b.jsxs)("div",{className:(0,i.A)("tabs-container",v.tabList),children:[(0,b.jsx)(j,{...t,...e}),(0,b.jsx)(x,{...t,...e})]})}function y(e){const t=(0,f.A)();return(0,b.jsx)(w,{...e,children:d(e.children)},String(t))}},55088:(e,t,n)=>{n.d(t,{A:()=>c});var a=n(96540),i=n(21432),s=n(74848);let r;function o(){if(r)return r;const{StatsigClient:e,runStatsigAutoCapture:t,runStatsigSessionReplay:n}=window.Statsig;return r=new e("client-rfLvYGag3eyU0jYW5zcIJTQip7GXxSrhOFN69IGMjvq",{userID:""}),t(r),n(r),r.initializeAsync().catch((e=>console.error(e))),r}function l(e){const t=e.split("\n"),n=[];let a=!1;for(const i of t)i.includes("<snippet>")?a=!0:i.includes("</snippet>")?a=!1:a&&n.push(i);return n.join("\n")}function c(e){let{url:t,language:n}=e;const[r,c]=(0,a.useState)(null);return function(){try{return o().checkGate("partial_gate")}catch(e){}}(),(0,a.useEffect)((()=>{!function(e,t){try{o().logEvent({eventName:"gh_embed_render",value:e.replace("https://raw.githubusercontent.com/statsig-io",""),metadata:{language:t}})}catch(n){}}(t,n);(async()=>{try{const e=Date.now(),n=await fetch(t);if(!n.ok)throw new Error("Network response was not ok");const a=500,i=await n.text(),s=Date.now()-e;s<a?setTimeout((()=>c(l(i))),a-s):c(l(i))}catch(e){c(`// Failed to load example.\n// View on GitHub:\n// ${t}`),function(e,t,n){try{o().logEvent({eventName:"gh_embed_error",value:e,metadata:{language:t,error:n}})}catch(n){}}(t,n,e)}})()}),[t]),(0,s.jsxs)("div",{style:{overflow:"hidden"},children:[null==r&&(0,s.jsx)(i.A,{language:n??"tsx",children:(0,s.jsx)("div",{style:{textAlign:"center",padding:"50px 0px 50px 0px"},children:"..."})}),null!=r&&(0,s.jsx)(i.A,{language:n??"tsx",children:r})]})}}}]);