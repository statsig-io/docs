"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[34688],{84341:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>d});var i=t(74848),a=t(28453);const s={title:"Snowflake",keywords:["owner:tim"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},o=void 0,r={id:"data-warehouse-ingestion/snowflake",title:"Snowflake",description:"Overview",source:"@site/docs/data-warehouse-ingestion/snowflake.mdx",sourceDirName:"data-warehouse-ingestion",slug:"/data-warehouse-ingestion/snowflake",permalink:"/data-warehouse-ingestion/snowflake",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/data-warehouse-ingestion/snowflake.mdx",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Snowflake",keywords:["owner:tim"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"Redshift",permalink:"/data-warehouse-ingestion/redshift"},next:{title:"Databricks",permalink:"/data-warehouse-ingestion/databricks"}},c={},d=[{value:"Overview",id:"overview",level:2},{value:"Account Name",id:"account-name",level:3},{value:"Database and Schema Name",id:"database-and-schema-name",level:3},{value:"Key-Pair Authentication",id:"key-pair-authentication",level:3},{value:"Custom User Privileges",id:"custom-user-privileges",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"To set up connection with Snowflake, Statsig needs the following"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Account Name"}),"\n",(0,i.jsx)(n.li,{children:"Database Name"}),"\n",(0,i.jsx)(n.li,{children:"Schema Name"}),"\n",(0,i.jsx)(n.li,{children:"Admin User Name"}),"\n",(0,i.jsxs)(n.li,{children:["If authenticating via login credentials:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Admin User Password"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["If authenticating via key-pair authentication:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Private Key"}),"\n",(0,i.jsx)(n.li,{children:"Private Key Passphrase (Optional)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)("b",{children:(0,i.jsxs)(n.p,{children:["Admin user name and password will be used by Statsig to create a user with restricted access to query from your data warehouse. If you don't want to use this, skip ahead ",(0,i.jsx)(n.a,{href:"/data-warehouse-ingestion/snowflake#custom-user-privileges",children:"here"})]})}),"\n",(0,i.jsx)(n.h3,{id:"account-name",children:"Account Name"}),"\n",(0,i.jsxs)(n.p,{children:["For the Account Name field, please enter in the format of ",(0,i.jsx)(n.code,{children:"<id>.<region>.<provider>"}),". So, your information may look something like this:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"xy12345.us-central1.gcp"})}),"\n",(0,i.jsx)(n.p,{children:"To get this information navigate to bottom left in your Snowflake console, as shown in the picture below and copy the link URL:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://user-images.githubusercontent.com/108023879/187517221-4bb3dce3-8b8f-4f30-b4d4-fd12e5249722.png",alt:"Frame 6"})}),"\n",(0,i.jsx)(n.p,{children:"The copied URL will look something like this:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"https://xy12345.us-central1.gcp.snowflakecomputing.com"})}),"\n",(0,i.jsxs)(n.p,{children:["You can extract information from here to get the required fields for Account Name, which for this example would be ",(0,i.jsx)(n.code,{children:"xy12345.us-central1.gcp"}),"."]}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.mdxAdmonitionTitle,{children:["Using ",(0,i.jsx)(n.code,{children:"<orgname>-<account_name>"})," for Account Name"]}),(0,i.jsxs)(n.p,{children:["For the Account Name field, you can also enter your Snowflake ",(0,i.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/admin-account-identifier.html#format-1-preferred-account-name-in-your-organization",children:"account identifier"}),", which typically takes the form ",(0,i.jsx)(n.code,{children:"<orgname>-<account_name>"}),". To find the ",(0,i.jsx)(n.code,{children:"<orgname>"})," in the Snowflake console, click on your account profile (usually at the bottom left) to view account details as shown below."]}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://user-images.githubusercontent.com/1315028/195217037-ad630f37-a8fe-4b61-823f-ce0e8c984ed0.png",alt:"Snowflake account profile interface"})})]}),"\n",(0,i.jsx)(n.h3,{id:"database-and-schema-name",children:"Database and Schema Name"}),"\n",(0,i.jsx)(n.p,{children:"For each data type, provide the database/schema of the table(s) you will be ingesting from."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://user-images.githubusercontent.com/108023879/187517225-017b4626-eaea-443b-a042-59fd474ae657.png",alt:"Frame 7"})}),"\n",(0,i.jsx)(n.h3,{id:"key-pair-authentication",children:"Key-Pair Authentication"}),"\n",(0,i.jsxs)(n.p,{children:["To set up key-pair authentication, first follow the ",(0,i.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/key-pair-auth",children:"snowflake documentation"})," to generate the private and public keys, and then set the public key on the service user."]}),"\n",(0,i.jsxs)(n.p,{children:["The private key can then be provided here\n",(0,i.jsx)(n.img,{src:"https://github.com/user-attachments/assets/8bb56be6-1aca-4d8a-98de-6b82d251d59b",alt:"Private key authentication configuration interface"})]}),"\n",(0,i.jsx)(n.h3,{id:"custom-user-privileges",children:"Custom User Privileges"}),"\n",(0,i.jsxs)(n.p,{children:["To create a custom user with specific privileges instead of using an admin user, run the following code in your Snowflake worksheet that has sysadmin and securityadmin roles.\nReplace ",(0,i.jsx)(n.code,{children:"<USER>"})," and ",(0,i.jsx)(n.code,{children:"<PASSWORD>"})," with your value, which you will copy over into our console."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"BEGIN;\n\n  -- set up variable values to be used in statements later\n  -- make sure to configure user_name and user_password with your own values\n  SET user_name = '<USER>'; -- REPLACE WITH YOUR OWN VALUE\n  SET user_password = '<PASSWORD>'; -- REPLACE WITH YOUR OWN VALUE\n  SET role_name = 'STATSIG_ROLE'; -- CAN BE ANYTHING, BUT THE USER NEEDS TO \n    -- HAVE THIS ROLE AND THE ROLE NEEDS ACCESS TO THE TABLES PER THE GRANTS BELOW\n\n  -- change role to sysadmin for warehouse / database steps\n  USE ROLE sysadmin;\n\n  -- create a warehouse, database, schema and tables for Statsig\n  CREATE OR REPLACE WAREHOUSE STATSIG_INGESTION WITH warehouse_size='XSMALL';\n  CREATE DATABASE IF NOT EXISTS STATSIG_STAGING;\n\n  -- change current role to securityadmin to create role and user for Statsig's access\n  USE ROLE securityadmin;\n\n  -- create role for Statsig\n  CREATE ROLE IF NOT EXISTS identifier($role_name);\n  GRANT ROLE identifier($role_name) TO ROLE SYSADMIN;\n\n  -- create a user for Statsig\n  CREATE USER IF NOT EXISTS identifier($user_name)\n  password = $user_password\n  default_role = $role_name\n  default_warehouse = STATSIG_INGESTION;\n  GRANT ROLE identifier($role_name) TO USER identifier($user_name);\n\n  -- grant Statsig role access to create warehouse and schema\n  GRANT USAGE ON WAREHOUSE STATSIG_INGESTION TO ROLE identifier($role_name);\n  GRANT CREATE SCHEMA, MONITOR, USAGE ON DATABASE STATSIG_STAGING TO ROLE identifier($role_name);\n\n  -- grant Statsig role read access to database and schema passed in\n  GRANT USAGE ON DATABASE <DATABASE> TO ROLE identifier($role_name);\n  GRANT USAGE ON SCHEMA <DATABASE>.<SCHEMA> TO ROLE identifier($role_name);\n  GRANT SELECT ON ALL TABLES IN DATABASE <DATABASE> TO ROLE identifier($role_name);\n  GRANT SELECT ON FUTURE TABLES IN DATABASE <DATABASE> TO ROLE identifier($role_name);\n  GRANT SELECT ON ALL VIEWS IN DATABASE <DATABASE> TO ROLE identifier($role_name);\n  GRANT SELECT ON FUTURE VIEWS IN DATABASE ACTUAL_DATA TO ROLE identifier($role_name);\n\nCOMMIT;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["After running the script, input the ",(0,i.jsx)(n.code,{children:"<USER>"})," and ",(0,i.jsx)(n.code,{children:"<PASSWORD>"})," you created in our console, during Connection Set Up stage under the Advanced settings options."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://user-images.githubusercontent.com/108023879/188943178-6b541962-62da-4529-b5af-ff59b20b7a8d.png",alt:"Screen Shot 2022-09-07 at 10 36 57 AM"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var i=t(96540);const a={},s=i.createContext(a);function o(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);