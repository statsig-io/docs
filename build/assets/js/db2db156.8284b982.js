"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[16725],{68219:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var r=n(74848),s=n(28453);n(11470),n(19365);const a={title:"Running A/B Tests",keywords:["owner:vijaye"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},i=void 0,o={id:"azureai/running-experiments",title:"Running A/B Tests",description:"Azure AI SDK helps you easily and quickly run A/B tests to measure the effectiveness of different models and related parameters.  By leveraging Statsig's powerful stats engine, you can gain real-time insights into model performance, optimizing for metrics like cost, accuracy, and latency. This integration enables you to experiment with various configurations, such as model type, prompt settings, or response parameters, and make data-driven decisions to enhance your application's efficiency and user experience.",source:"@site/docs/azureai/running-experiments.mdx",sourceDirName:"azureai",slug:"/azureai/running-experiments",permalink:"/azureai/running-experiments",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/azureai/running-experiments.mdx",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Running A/B Tests",keywords:["owner:vijaye"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"Capturing Metrics",permalink:"/azureai/capturing-metrics"},next:{title:"Organization Policies",permalink:"/org-admin/organization_policies"}},c={},l=[{value:"Example: Test GPT4o vs. GPT4o-mini",id:"example-test-gpt4o-vs-gpt4o-mini",level:2},{value:"Step 1: Create configs",id:"step-1-create-configs",level:3},{value:"Step 2: Create some metrics to track",id:"step-2-create-some-metrics-to-track",level:3},{value:"Step 3: Create an experiment",id:"step-3-create-an-experiment",level:3},{value:"Step 4: Set up the variations",id:"step-4-set-up-the-variations",level:3},{value:"Step 5: Save and start the experiment",id:"step-5-save-and-start-the-experiment",level:3},{value:"Step 6: Let&#39;s write some code",id:"step-6-lets-write-some-code",level:3},{value:"Step 7: Run the experiment and verify results",id:"step-7-run-the-experiment-and-verify-results",level:3}];function d(e){const t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.p,{children:"Azure AI SDK helps you easily and quickly run A/B tests to measure the effectiveness of different models and related parameters.  By leveraging Statsig's powerful stats engine, you can gain real-time insights into model performance, optimizing for metrics like cost, accuracy, and latency. This integration enables you to experiment with various configurations, such as model type, prompt settings, or response parameters, and make data-driven decisions to enhance your application's efficiency and user experience."}),"\n",(0,r.jsx)(t.h2,{id:"example-test-gpt4o-vs-gpt4o-mini",children:"Example: Test GPT4o vs. GPT4o-mini"}),"\n",(0,r.jsx)(t.h3,{id:"step-1-create-configs",children:"Step 1: Create configs"}),"\n",(0,r.jsxs)(t.p,{children:["Create two dynamic configs, one named ",(0,r.jsx)(t.code,{children:"gpt-4o"})," and another named ",(0,r.jsx)(t.code,{children:"gpt-4o-mini"}),".  In the ",(0,r.jsx)(t.strong,{children:"Value"})," section add the endpoint, key and other default parameters like this:"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://github.com/user-attachments/assets/3770f081-d68f-478e-8b3d-a36ef65d49c7",alt:"Dynamic config setup interface"})}),"\n",(0,r.jsx)(t.p,{children:"These will serve as the base deployment configs for our tests, and also allow you to modify it on the fly as you launch"}),"\n",(0,r.jsx)(t.h3,{id:"step-2-create-some-metrics-to-track",children:"Step 2: Create some metrics to track"}),"\n",(0,r.jsxs)(t.p,{children:["Let's take the example of a metric like ",(0,r.jsx)(t.strong,{children:"latency"})," and see how to create it in Statsig."]}),"\n",(0,r.jsxs)(t.p,{children:["Navigate to the ",(0,r.jsx)(t.strong,{children:"Metrics Catalog"})," page (",(0,r.jsx)(t.a,{href:"https://console.statsig.com/metrics/metrics_catalog",children:"https://console.statsig.com/metrics/metrics_catalog"}),") and click on ",(0,r.jsx)(t.strong,{children:"Create"})," button."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://github.com/user-attachments/assets/89841414-6140-41f4-89ee-b09b83f2846c",alt:"Metrics catalog creation interface"})}),"\n",(0,r.jsxs)(t.p,{children:["Now, in the ",(0,r.jsx)(t.strong,{children:"Metric Definition"})," section, choose:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Property"}),(0,r.jsx)(t.th,{children:"Value"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Metric Type:"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"Aggregation"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"ID Type:"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"User ID"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Aggregation Using:"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"Events"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Aggregation Type:"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"Average"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Rollup Mode:"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"Total Experiment"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Event:"}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.strong,{children:"usage"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Average Using:"}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.strong,{children:"Metadata"})," => ",(0,r.jsx)(t.strong,{children:"latency_ms"})]})]})]})]}),"\n",(0,r.jsxs)(t.p,{children:["This will create a metric that averages ",(0,r.jsx)(t.strong,{children:"latency"})," across all ",(0,r.jsx)(t.strong,{children:"usage"})," events coming from chat completions."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://github.com/user-attachments/assets/0317d30a-a479-498d-8dd0-666f2db616e3",alt:"Latency metric configuration screen"})}),"\n",(0,r.jsx)(t.h3,{id:"step-3-create-an-experiment",children:"Step 3: Create an experiment"}),"\n",(0,r.jsxs)(t.p,{children:["Create a new experiment in the Statsig console from ",(0,r.jsx)(t.a,{href:"https://console.statsig.com/experiments",children:"https://console.statsig.com/experiments"})]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://github.com/user-attachments/assets/f1a93738-355f-4647-8444-9b6abfb72ffc",alt:"Experiment creation interface"})}),"\n",(0,r.jsxs)(t.p,{children:["In the ",(0,r.jsx)(t.strong,{children:"Setup"})," page, add the metrics you created in Step #2 in the ",(0,r.jsx)(t.strong,{children:"Primary Metrics"})," field."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://github.com/user-attachments/assets/eb47ec6c-bd9a-47d9-bca6-a6ce0ea4148b",alt:"Primary metrics configuration screen"})}),"\n",(0,r.jsx)(t.h3,{id:"step-4-set-up-the-variations",children:"Step 4: Set up the variations"}),"\n",(0,r.jsx)(t.p,{children:"You can now create the control and test variants for the experiment you want to run.  In our case, let's split them evenly 50/50."}),"\n",(0,r.jsxs)(t.p,{children:["In the ",(0,r.jsx)(t.strong,{children:"Groups and Parameters"})," section, click on ",(0,r.jsx)(t.strong,{children:"Add Parameter"})," button and name the parameter ",(0,r.jsx)(t.em,{children:"model_name"}),", with ",(0,r.jsx)(t.em,{children:"String"})," type"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://github.com/user-attachments/assets/4837063a-9dde-4c0b-8bca-584d98adae47",alt:"Parameter setup interface"})}),"\n",(0,r.jsx)(t.p,{children:"Now add the two configs we created in Step #1, one each to Control and Test parameters like this:"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:"https://github.com/user-attachments/assets/b54a41de-a442-4870-870c-81ff949ecceb",alt:"Experiment variant configuration screen"})}),"\n",(0,r.jsx)(t.h3,{id:"step-5-save-and-start-the-experiment",children:"Step 5: Save and start the experiment"}),"\n",(0,r.jsxs)(t.p,{children:["Now, hit the ",(0,r.jsx)(t.strong,{children:"Save"})," button at the bottom of the page. You will now see a ",(0,r.jsx)(t.strong,{children:"Start"})," button appear at the top of the experiment page.  Go ahead and click it - this will start the allocation process for the experiment."]}),"\n",(0,r.jsx)(t.h3,{id:"step-6-lets-write-some-code",children:"Step 6: Let's write some code"}),"\n",(0,r.jsx)(t.p,{children:"The code below:"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsxs)(t.li,{children:["Fetches the experiment configuration from server for a given user.  You can pass down the ",(0,r.jsx)(t.strong,{children:"userID"})," from your client application or use one from your database.  The code below generates a random one for testing purposes."]}),"\n",(0,r.jsxs)(t.li,{children:["Gets the ",(0,r.jsx)(t.strong,{children:"config name"})," from the experiment variant - either from control or test"]}),"\n",(0,r.jsx)(t.li,{children:"Create a model client using the config that we just fetched"}),"\n",(0,r.jsx)(t.li,{children:"Uses that model client to complete text."}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:'async function testExperiments() {\n  await AzureAI.initialize(statsigServerKey);\n\n  const experiment = Statsig.getExperimentSync(\n    { userID: Math.random().toString() }, // use a valid userID here\n    "model_experiment_gpt4o_vs_gpt4o-mini",\n  );\n  const configName = experiment.get("model_name", "gpt-4o");\n  console.log(`Using model: ${configName}`);\n\n  const modelClient = AzureAI.getModelClient(configName);\n  const result = await modelClient.complete([{\n    role: "user",\n    content: "Recite the first 10 digits of pi."\n  }]);\n  result.choices.forEach((choice, i) => {\n    console.log(choice.message.content);\n  });\n  \n  await AzureAI.shutdown();\n}\n'})}),"\n",(0,r.jsx)(t.h3,{id:"step-7-run-the-experiment-and-verify-results",children:"Step 7: Run the experiment and verify results"}),"\n",(0,r.jsxs)(t.p,{children:["Run this experiment for several days, and you will now be able to measure latency profiles of ",(0,r.jsx)(t.strong,{children:"gpt-4o"})," compared with ",(0,r.jsx)(t.strong,{children:"gpt-4o-mini"})," in Statsig console. You can choose whichever one suits your needs."]}),"\n",(0,r.jsxs)(t.p,{children:["The above is just a simple experiment to test models against each other. You could also tweak other parameters like ",(0,r.jsx)(t.em,{children:"temperature"}),", ",(0,r.jsx)(t.em,{children:"frequency_penalty"}),", ",(0,r.jsx)(t.em,{children:"max_tokens"}),", etc. by modifying the config.  This could all be done without needing to update code."]})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},19365:(e,t,n)=>{n.d(t,{A:()=>i});n(96540);var r=n(34164);const s={tabItem:"tabItem_Ymn6"};var a=n(74848);function i(e){let{children:t,hidden:n,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,i),hidden:n,children:t})}},11470:(e,t,n)=>{n.d(t,{A:()=>w});var r=n(96540),s=n(34164),a=n(23104),i=n(56347),o=n(205),c=n(57485),l=n(31682),d=n(70679);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return u(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:s}}=e;return{value:t,label:n,attributes:r,default:s}}))}(n);return function(e){const t=(0,l.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function p(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const s=(0,i.W6)(),a=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,c.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const t=new URLSearchParams(s.location.search);t.set(a,e),s.replace({...s.location,search:t.toString()})}),[a,s])]}function g(e){const{defaultValue:t,queryString:n=!1,groupId:s}=e,a=h(e),[i,c]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:a}))),[l,u]=m({queryString:n,groupId:s}),[g,x]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[s,a]=(0,d.Dv)(n);return[s,(0,r.useCallback)((e=>{n&&a.set(e)}),[n,a])]}({groupId:s}),f=(()=>{const e=l??g;return p({value:e,tabValues:a})?e:null})();(0,o.A)((()=>{f&&c(f)}),[f]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),x(e)}),[u,x,a]),tabValues:a}}var x=n(92303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=n(74848);function v(e){let{className:t,block:n,selectedValue:r,selectValue:i,tabValues:o}=e;const c=[],{blockElementScrollPositionUntilNextRender:l}=(0,a.a_)(),d=e=>{const t=e.currentTarget,n=c.indexOf(t),s=o[n].value;s!==r&&(l(t),i(s))},u=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;t=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;t=c[n]??c[c.length-1];break}}t?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},t),children:o.map((e=>{let{value:t,label:n,attributes:a}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>c.push(e),onKeyDown:u,onClick:d,...a,className:(0,s.A)("tabs__item",f.tabItem,a?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function b(e){let{lazy:t,children:n,selectedValue:a}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a})))})}function y(e){const t=g(e);return(0,j.jsxs)("div",{className:(0,s.A)("tabs-container",f.tabList),children:[(0,j.jsx)(v,{...t,...e}),(0,j.jsx)(b,{...t,...e})]})}function w(e){const t=(0,x.A)();return(0,j.jsx)(y,{...e,children:u(e.children)},String(t))}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var r=n(96540);const s={},a=r.createContext(s);function i(e){const t=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);