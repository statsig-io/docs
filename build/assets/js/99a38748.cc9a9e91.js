"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[39290],{11062:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>l});var t=a(74848),i=a(28453);const s={title:"Snowflake Connection",slug:"/statsig-warehouse-native/connecting-your-warehouse/snowflake",sidebar_label:"Snowflake",keywords:["owner:vm"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},o=void 0,r={id:"statsig-warehouse-native/connecting-your-warehouse/snowflake",title:"Snowflake Connection",description:"Overview",source:"@site/docs/statsig-warehouse-native/connecting-your-warehouse/snowflake.md",sourceDirName:"statsig-warehouse-native/connecting-your-warehouse",slug:"/statsig-warehouse-native/connecting-your-warehouse/snowflake",permalink:"/statsig-warehouse-native/connecting-your-warehouse/snowflake",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/statsig-warehouse-native/connecting-your-warehouse/snowflake.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Snowflake Connection",slug:"/statsig-warehouse-native/connecting-your-warehouse/snowflake",sidebar_label:"Snowflake",keywords:["owner:vm"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"warehouse",previous:{title:"Overview",permalink:"/statsig-warehouse-native/guides/connect"},next:{title:"Athena",permalink:"/statsig-warehouse-native/connecting-your-warehouse/athena"}},c={},l=[{value:"Overview",id:"overview",level:2},{value:"Account Name",id:"account-name",level:3},{value:"Database and Schema Name",id:"database-and-schema-name",level:3},{value:"Key-Pair Authentication",id:"key-pair-authentication",level:3},{value:"Boilerplate Setup SQL",id:"boilerplate-setup-sql",level:3},{value:"What IP addresses will Statsig access data warehouses from?",id:"what-ip-addresses-will-statsig-access-data-warehouses-from",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(n.p,{children:"To set up Warehouse Native connection with Snowflake, Statsig needs the following"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Account Name"}),"\n",(0,t.jsx)(n.li,{children:"Database Name"}),"\n",(0,t.jsx)(n.li,{children:"Schema Name"}),"\n",(0,t.jsx)(n.li,{children:"Service User Name"}),"\n",(0,t.jsxs)(n.li,{children:["If authenticating via login credentials:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Service User Password"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["If authenticating via key-pair authentication:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Private Key"}),"\n",(0,t.jsx)(n.li,{children:"Private Key Passphrase (Optional)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The service user needs the following permissions:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"READ on any tables you are using for experimentation"}),"\n",(0,t.jsx)(n.li,{children:"USAGE/WRITE on a Statsig-specific Schema we'll use to materialize temp tables and results"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"account-name",children:"Account Name"}),"\n",(0,t.jsxs)(n.p,{children:["For the Account Name field, please enter in the format of ",(0,t.jsx)(n.code,{children:"<id>.<region>.<provider>"}),". So, your information may look something like this:"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"xy12345.us-central1.gcp"})}),"\n",(0,t.jsx)(n.p,{children:"To get this information navigate to bottom left in your Snowflake console, as shown in the picture below and copy the link URL:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://user-images.githubusercontent.com/108023879/187517221-4bb3dce3-8b8f-4f30-b4d4-fd12e5249722.png",alt:"Frame 6"})}),"\n",(0,t.jsx)(n.p,{children:"The copied URL will look something like this:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"https://xy12345.us-central1.gcp.snowflakecomputing.com"})}),"\n",(0,t.jsxs)(n.p,{children:["You can extract information from here to get the required fields for Account Name, which for this example would be ",(0,t.jsx)(n.code,{children:"xy12345.us-central1.gcp"}),"."]}),"\n",(0,t.jsxs)(n.admonition,{type:"info",children:[(0,t.jsxs)(n.mdxAdmonitionTitle,{children:["Using ",(0,t.jsx)(n.code,{children:"<orgname>-<account_name>"})," for Account Name"]}),(0,t.jsxs)(n.p,{children:["For the Account Name field, you can also enter your Snowflake ",(0,t.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/admin-account-identifier.html#format-1-preferred-account-name-in-your-organization",children:"account identifier"}),", which typically takes the form ",(0,t.jsx)(n.code,{children:"<orgname>-<account_name>"}),". To find the ",(0,t.jsx)(n.code,{children:"<orgname>"})," in the Snowflake console, click on your account profile (usually at the bottom left) to view account details as shown below."]}),(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://user-images.githubusercontent.com/1315028/195217037-ad630f37-a8fe-4b61-823f-ce0e8c984ed0.png",alt:"Snowflake account profile interface"})})]}),"\n",(0,t.jsx)(n.h3,{id:"database-and-schema-name",children:"Database and Schema Name"}),"\n",(0,t.jsx)(n.p,{children:"Provide the Schema and corresponding Database where Statsig will be able to materialize results"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://user-images.githubusercontent.com/108023879/187517225-017b4626-eaea-443b-a042-59fd474ae657.png",alt:"Frame 7"})}),"\n",(0,t.jsx)(n.h3,{id:"key-pair-authentication",children:"Key-Pair Authentication"}),"\n",(0,t.jsxs)(n.p,{children:["To set up key-pair authentication, first follow the ",(0,t.jsx)(n.a,{href:"https://docs.snowflake.com/en/user-guide/key-pair-auth",children:"snowflake documentation"})," to generate the private and public keys, and then set the public key on the service user."]}),"\n",(0,t.jsxs)(n.p,{children:["The private key can then be provided here\n",(0,t.jsx)(n.img,{src:"https://github.com/user-attachments/assets/1fa7bda1-5d9c-414b-8e2f-7e36b900acfb",alt:"Key-pair authentication configuration interface"})]}),"\n",(0,t.jsx)(n.h3,{id:"boilerplate-setup-sql",children:"Boilerplate Setup SQL"}),"\n",(0,t.jsx)(n.p,{children:"To create a Statsig user with the sufficient privileges, as well as a Statsig staging Schema, run the following code in your Snowflake worksheet that has sysadmin and securityadmin roles."}),"\n",(0,t.jsxs)(n.p,{children:["Replace ",(0,t.jsx)(n.code,{children:"<USER>"})," and ",(0,t.jsx)(n.code,{children:"<PASSWORD>"})," with your value, which you will copy over into our console."]}),"\n",(0,t.jsx)(n.p,{children:"Depending on the scope of your data, you may want to adjust the size of the warehouse created."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"BEGIN;\n  -- set up variable values to be used in statements later\n  -- make sure to configure user_name and user_password with your own values\n  SET user_name = '<USERNAME>'; -- REPLACE WITH YOUR OWN VALUE\n  SET user_password = '<PASSWORD>'; -- REPLACE WITH YOUR OWN VALUE\n  SET role_name = 'STATSIG_ROLE';\n\n  -- change role to sysadmin for warehouse / database steps\n  USE ROLE sysadmin;\n\n  -- create a warehouse, database, schema and tables for Statsig\n  CREATE OR REPLACE WAREHOUSE STATSIG WITH warehouse_size='XLARGE'; -- adjust based on your data size\n  CREATE DATABASE IF NOT EXISTS STATSIG_STAGING;\n  CREATE SCHEMA IF NOT EXISTS STATSIG_STAGING.STATSIG_TABLES;\n\n  -- change current role to securityadmin to create role and user for Statsig's access\n  USE ROLE securityadmin;\n\n  -- create role for Statsig\n  CREATE ROLE IF NOT EXISTS identifier($role_name);\n  GRANT ROLE identifier($role_name) TO ROLE SYSADMIN;\n\n  -- create a user for Statsig\n  CREATE USER IF NOT EXISTS identifier($user_name)\n  password = $user_password\n  default_role = $role_name\n  default_namespace = STATSIG_STAGING.STATSIG_TABLES\n  default_warehouse = STATSIG;\n  GRANT ROLE identifier($role_name) TO USER identifier($user_name);\n\n  -- grant Statsig role access to create warehouse and schema\n  GRANT USAGE ON WAREHOUSE STATSIG TO ROLE identifier($role_name);\n  GRANT USAGE ON SCHEMA STATSIG_STAGING.STATSIG_TABLES TO ROLE identifier($role_name);\n  GRANT CREATE SCHEMA, MONITOR, USAGE ON DATABASE STATSIG_STAGING TO ROLE identifier($role_name);\n\n  -- ONLY GIVE THIS LEVEL OF ACCESS in the staging schema.\n  GRANT CREATE TABLE, CREATE FUNCTION ON SCHEMA STATSIG_STAGING.STATSIG_TABLES TO ROLE identifier($role_name);\n  GRANT SELECT, UPDATE, INSERT, DELETE ON ALL TABLES IN SCHEMA STATSIG_STAGING.STATSIG_TABLES TO ROLE identifier($role_name);\n  GRANT SELECT, UPDATE, INSERT, DELETE ON FUTURE TABLES IN SCHEMA STATSIG_STAGING.STATSIG_TABLES TO ROLE identifier($role_name);\n  GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA STATSIG_STAGING.STATSIG_TABLES TO ROLE identifier($role_name);\n\n  -- grant Statsig role read access to database and schema passed in\n  -- do this at a table level, database level, and/or schema level\n  -- for data Statsig needs to access\n  GRANT USAGE ON DATABASE <DATABASE> TO ROLE identifier($role_name);\n  GRANT USAGE ON SCHEMA <DATABASE>.<SCHEMA> TO ROLE identifier($role_name);\n  GRANT SELECT ON ALL TABLES IN DATABASE <DATABASE> TO ROLE identifier($role_name);\n  GRANT SELECT ON FUTURE TABLES IN DATABASE <DATABASE> TO ROLE identifier($role_name);\n  GRANT SELECT ON ALL VIEWS IN DATABASE <DATABASE> TO ROLE identifier($role_name);\n  GRANT SELECT ON FUTURE VIEWS IN DATABASE <DATABASE> TO ROLE identifier($role_name);\n\nCOMMIT;\n"})}),"\n",(0,t.jsx)(n.h3,{id:"what-ip-addresses-will-statsig-access-data-warehouses-from",children:"What IP addresses will Statsig access data warehouses from?"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"/data-warehouse-ingestion/faq#what-ip-addresses-will-statsig-access-data-warehouses-from",children:"See FAQ"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>r});var t=a(96540);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);