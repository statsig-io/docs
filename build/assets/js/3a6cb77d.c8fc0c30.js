"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[66314],{76203:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>r,default:()=>c,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var s=n(74848),i=n(28453);const a={title:"Unit Count (Latest Value) Metrics",sidebar_label:"Unit Count (Latest Value)",keywords:["owner:vm"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},r=void 0,o={id:"statsig-warehouse-native/metrics/unit-count-latest",title:"Unit Count (Latest Value) Metrics",description:"Summary",source:"@site/docs/statsig-warehouse-native/metrics/unit-count-latest.md",sourceDirName:"statsig-warehouse-native/metrics",slug:"/statsig-warehouse-native/metrics/unit-count-latest",permalink:"/statsig-warehouse-native/metrics/unit-count-latest",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/statsig-warehouse-native/metrics/unit-count-latest.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Unit Count (Latest Value) Metrics",sidebar_label:"Unit Count (Latest Value)",keywords:["owner:vm"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"warehouse",previous:{title:"Unit Count (Window)",permalink:"/statsig-warehouse-native/metrics/unit-count-window"},next:{title:"Unit Count (Daily Participation)",permalink:"/statsig-warehouse-native/metrics/unit-count-rate"}},u={},l=[{value:"Summary",id:"summary",level:2},{value:"Use Cases",id:"use-cases",level:3},{value:"Calculation",id:"calculation",level:2},{value:"Options",id:"options",level:2}];function d(e){const t={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"Unit count metrics with the latest rollup type measure if a unit participated on the last observed day."}),"\n",(0,s.jsx)(t.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsx)(t.p,{children:"This is a powerful metric type for measuring state. For example, you might want to understand if your test variant made it so that you currently have more active subscribers in test than in control, or if more users are currently active."}),"\n",(0,s.jsx)(t.h2,{id:"calculation",children:"Calculation"}),"\n",(0,s.jsx)(t.p,{children:"At the unit level, unit count metrics create a 1/0 flag for if they participated on a given day. This is carried forward to the current date if data is behind."}),"\n",(0,s.jsx)(t.p,{children:"At the group level, the mean is calculated as the SUM of the unit-level flags, divided by the count of UNIQUE UNITS exposed to the experiment."}),"\n",(0,s.jsx)(t.p,{children:"This would look like the SQL below:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'-- Unit Level\nSELECT\n  unit_id,\n  group_id,\n  if(passes_filter, 1, 0) as value\nFROM (\n    SELECT\n        source_data.*,\n        exposures_data.group_id,\n        source_data.date = MAX(source_data.date) over (partition by source_data.unit_id) as is_latest_date\n    FROM source_data\n    JOIN exposure_data\n    ON\n      -- Only include users who saw the experiment\n      source_data.unit_id = exposure_data.unit_id\n      -- Only include data from after the user saw the experiment\n      -- In this case exposure_data is already deduped to the "first exposure"\n      AND source_data.timestamp >= exposure_data.timestamp\n)\nWHERE is_latest_date = 1\nGROUP BY\n  source_data.unit_id,\n  exposure_data.group_id;\n\n-- Experiment\nSELECT\n  group_id,\n  COUNT(distinct unit_id) total_units\nFROM exposure_data\nGROUP BY group_id;\n\n-- Group Level\nSELECT\n  group_id,\n  SUM(value)/SUM(total_units) as mean\nFROM unit_data\nJOIN group_data\nUSING (group_id)\nGROUP BY group_id;\n'})}),"\n",(0,s.jsx)(t.h2,{id:"options",children:"Options"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Metric Breakdowns","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"You can configure Metadata Columns to group results by, getting easy access to dimensional views in pulse results"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["Multi Source","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Sums can be built with inputs from multiple metric sources; think of this as a UNION in SQL. This can be useful if you have the same measure in sharded or disparate tables"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["Rollup Mode","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Rollup Mode controls the specific way that Unit Count metrics are aggregated"}),"\n"]}),"\n"]}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var s=n(96540);const i={},a=s.createContext(i);function r(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);