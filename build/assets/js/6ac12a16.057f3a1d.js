"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[58122],{80903:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>a,metadata:()=>r,toc:()=>h});var n=s(74848),o=s(28453);const a={title:"Geotests",sidebar_label:"Methodology",slug:"/experiments-plus/geotests/methodology",keywords:["owner:makris"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},i="Geotesting Methodology",r={id:"statsig-warehouse-native/geotests/methodology",title:"Geotests",description:"How it's different",source:"@site/docs/statsig-warehouse-native/geotests/methodology.md",sourceDirName:"statsig-warehouse-native/geotests",slug:"/experiments-plus/geotests/methodology",permalink:"/experiments-plus/geotests/methodology",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/statsig-warehouse-native/geotests/methodology.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Geotests",sidebar_label:"Methodology",slug:"/experiments-plus/geotests/methodology",keywords:["owner:makris"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"warehouse",previous:{title:"Getting Started",permalink:"/experiments-plus/geotests-setup"},next:{title:"Other Features",permalink:"/statsig-warehouse-native/features/other-features"}},l={},h=[{value:"How it&#39;s different",id:"how-its-different",level:2},{value:"Using Synthetic Controls",id:"using-synthetic-controls",level:2}];function d(e){const t={h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"geotesting-methodology",children:"Geotesting Methodology"})}),"\n",(0,n.jsx)(t.h2,{id:"how-its-different",children:"How it's different"}),"\n",(0,n.jsx)(t.p,{children:"Standard A/B testing relies on a few core assumptions:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"You can reliably and randomly split your users into similar groups"}),"\n",(0,n.jsx)(t.li,{children:"While each group has heterogeneity inside it, random user-level variations average out at larger sample sizes, resulting in homologous (similar) groups"}),"\n",(0,n.jsx)(t.li,{children:"You control how each group gets treated, and there is no interference between groups"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"When these core assumptions are true, we assume the treatment effect will be the only observable difference between the groups. We can simply measure each group\u2019s mean value and find the difference between them."}),"\n",(0,n.jsx)(t.p,{children:"There are times however when these assumptions don\u2019t hold:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Your intended treatment can\u2019t be controlled and scoped to the user level"}),"\n",(0,n.jsx)(t.li,{children:"You don\u2019t know who the users are"}),"\n",(0,n.jsx)(t.li,{children:"You can\u2019t track outcomes at the user level"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Running geographically-based campaigns is a prime example that often features at least some of these violations. Examples include:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Some classic marketing, like billboards, can\u2019t be randomly split between test and control users at a given location. We can\u2019t track who sees them and how they act afterwards."}),"\n",(0,n.jsx)(t.li,{children:"Some digital campaigns might be able to split users 50/50 (if the platform allows it), but if you don't have user-level data that you can tie to outcomes of interest, you'll never know how the two groups performed."}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"using-synthetic-controls",children:"Using Synthetic Controls"}),"\n",(0,n.jsx)(t.p,{children:"\u201cGeotesting\u201d as we refer to it here is an experimental framework that relies on a different basic setup than AB tests:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Split your users into geographical boundaries at some useful level (zip codes, states, countries, etc)"}),"\n",(0,n.jsx)(t.li,{children:"Apply a known treatment in some \u201ctreatment\u201d geos, and no treatment in some \u201ccontrol\u201d geos"}),"\n",(0,n.jsx)(t.li,{children:"Use the control geos to figure out what would have happened in the treatment geos had no treatment been applied (i.e. \u201csynthetic\u201d results)"}),"\n",(0,n.jsx)(t.li,{children:"Measure the delta in the treatment geos between the actual and synthetic values"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The \u201cfiguring out what would have happened\u201d tends to be the hardest and nastiest part of this setup. Deducing things that don\u2019t occur is usually a fool\u2019s errand, but in some circumstances there\u2019s enough predictability in a system to figure it out."}),"\n",(0,n.jsx)(t.p,{children:"Geotesting relies on the idea that among some sets of geos there are enough correlations between control and test geos that make predicting this \u201ccounterfactual\u201d possible. We assume, for instance, that general trends and seasonality tend to be shared across some geos."}),"\n",(0,n.jsx)(t.p,{children:"Example: pretty much all zip codes in the United States exhibit similar quantities of mail sent on any given day. If you were to split zip codes 50/50, you could reasonably infer that the two groups would see similar trends."}),"\n",(0,n.jsx)(t.h1,{id:"approach",children:"Approach"}),"\n",(0,n.jsx)(t.p,{children:"There are many ways to estimate unknown data from other known data, depending on a multitude of factors. In the case of Geotesting, we have:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"timeseries data that is autocorrelated (i.e. data is correlated from one day to the next within a group)"}),"\n",(0,n.jsx)(t.li,{children:"timeseries data that is correlated between groups"}),"\n",(0,n.jsx)(t.li,{children:"regular seasonal patterns that repeat at regular intervals"}),"\n",(0,n.jsx)(t.li,{children:"granular data from among many distinct geographies"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Plotting some metric of interest for a bunch of relevant geographies can show these relationships clearly."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Example data from the GeoLift package walkthrough. ",src:s(58062).A+"",width:"768",height:"576"})}),"\n",(0,n.jsx)(t.p,{children:"Example data from the GeoLift package walkthrough."}),"\n",(0,n.jsx)(t.p,{children:"But what happens when we run a campaign or make some change in just some of these geos? How can we tell if a fluctuation in this graph is random noise or real stat-sig result?"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"A marketing campaign that starts on day 91 (black dotted line) could have affected the treatment cities of Chicago and Portland. But how can you tell any real effect from all the noise?",src:s(61093).A+"",width:"768",height:"576"})}),"\n",(0,n.jsx)(t.p,{children:"A marketing campaign that starts on day 91 (black dotted line) could have affected the treatment cities of Chicago and Portland. But how do you distinguish any real effect from all the noise?"}),"\n",(0,n.jsx)(t.p,{children:"We turn to causal inference modeling to answer this question. Thankfully, a variety of powerful models and methods have been developed to answer this question. The basic steps are the following:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Split your geos into test and control groups"}),"\n",(0,n.jsx)(t.li,{children:"Using the pre-treatment period data, train a model on the control data to predict how the treatment geos behave"}),"\n",(0,n.jsx)(t.li,{children:"Use the post-treatment period data for the control geos, create a \u201csynthetic control\u201d dataset to predict how the treatment geos would have behaved after the treatment event."}),"\n",(0,n.jsx)(t.li,{children:"Subtract the synthetic data from the actual observed data to determine the induced effects of your treatment on the treatment geos"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"When your training data is able to produce strong models that can predict metric outcome well, you end up with strong estimates of an induced effect:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Geotest period split diagram showing pre-treatment and post-treatment phases",src:s(59093).A+"",width:"849",height:"615"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Subtracting the modeled Synthetic Control values from the observed Treatment values reveals any incremental effect for the Treatment geos.",src:s(83748).A+"",width:"768",height:"576"})}),"\n",(0,n.jsx)(t.p,{children:"Subtracting the modeled Synthetic Control values from the observed Treatment values reveals any incremental effect for the Treatment geos."})]})}function c(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},58062:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/GeosPreTest-0d1f64563c83d1403741ec5e032577b0.png"},61093:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/GeosTest-1060f6c15cd003a349bec241ee382388.png"},83748:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/Incremental_Effects-b1127818bbbb00e9ecc2eb73c7db8683.png"},59093:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/Period_Split-ff2adfff7f83e73ce8850e938f47e9eb.png"},28453:(e,t,s)=>{s.d(t,{R:()=>i,x:()=>r});var n=s(96540);const o={},a=n.createContext(o);function i(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);