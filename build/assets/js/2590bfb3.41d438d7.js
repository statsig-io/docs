"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[6110,44870],{29605:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>d});var n=i(74848),r=i(28453),s=i(35511);const a={title:"Variance Reduction",sidebar_label:"Variance Reduction",slug:"/stats-engine/variance_reduction-whn",keywords:["owner:vm"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},o=void 0,c={id:"stats-engine/variance-reduction-whn",title:"Variance Reduction",description:"",source:"@site/docs/stats-engine/variance-reduction-whn.md",sourceDirName:"stats-engine",slug:"/stats-engine/variance_reduction-whn",permalink:"/stats-engine/variance_reduction-whn",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/stats-engine/variance-reduction-whn.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Variance Reduction",sidebar_label:"Variance Reduction",slug:"/stats-engine/variance_reduction-whn",keywords:["owner:vm"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"warehouse",previous:{title:"Topline Impact",permalink:"/stats-engine/topline-impact-whn"},next:{title:"Pre-Experiment Bias",permalink:"/stats-engine/pre-experiment-bias-whn"}},l={},d=[...s.toc];function u(e){return(0,n.jsx)(s.default,{})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(u,{...e})}):u()}},35511:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>l});var n=i(74848),r=i(28453);const s={title:"Variance Reduction",sidebar_label:"Variance Reduction",slug:"/stats-engine/variance_reduction",keywords:["owner:vm"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},a=void 0,o={id:"stats-engine/variance-reduction",title:"Variance Reduction",description:"Variance Reduction",source:"@site/docs/stats-engine/variance-reduction.md",sourceDirName:"stats-engine",slug:"/stats-engine/variance_reduction",permalink:"/stats-engine/variance_reduction",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/stats-engine/variance-reduction.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Variance Reduction",sidebar_label:"Variance Reduction",slug:"/stats-engine/variance_reduction",keywords:["owner:vm"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"Fieller Intervals",permalink:"/stats-engine/methodologies/fieller-intervals"},next:{title:"CUPED",permalink:"/stats-engine/methodologies/cuped"}},c={},l=[{value:"Variance Reduction",id:"variance-reduction",level:2},{value:"CUPED",id:"cuped",level:2},{value:"Where CUPED works best",id:"where-cuped-works-best",level:3},{value:"Where CUPED is less effective",id:"where-cuped-is-less-effective",level:3},{value:"Winsorization",id:"winsorization",level:2},{value:"Metric Selection",id:"metric-selection",level:2},{value:"Literature",id:"literature",level:2}];function d(e){const t={a:"a",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"variance-reduction",children:"Variance Reduction"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"/stats-engine/variance",children:"Variance"}),' is a measurement of dispersion which measures the amount of "noise" in a metric or experiment results. Higher variance is associated with larger confidence intervals, and leads to experiments requiring more sample size to consistently observe a statistically significant result on the same effect size.']}),"\n",(0,n.jsx)(t.p,{children:"Reducing variance can lead to shorter experiment run times due to the lower sample required. Because of this, techniques have been developed to reduce the variance in experiment results in order to reduce run times and increase confidence."}),"\n",(0,n.jsxs)(t.p,{children:["At Statsig, we use a form of CUPED based on a ",(0,n.jsx)(t.a,{href:"https://www.exp-platform.com/Documents/2013-02-CUPED-ImprovingSensitivityOfControlledExperiments.pdf",children:"2013 Microsoft paper"})," (Deng, Xu, Kohavi, & Walker). This is automatically applied to experiments at Statsig, and is run for the topline results on key metrics in Pulse. This observably leads to significant variance reduction in the large majority of metrics where CUPED can be applied."]}),"\n",(0,n.jsxs)(t.p,{children:["Refer to our ",(0,n.jsx)(t.a,{href:"https://blog.statsig.com/cuped-on-statsig-d57f23122d0e",children:"launch post for CUPED"})," for more details."]}),"\n",(0,n.jsx)(t.h2,{id:"cuped",children:"CUPED"}),"\n",(0,n.jsx)(t.p,{children:"CUPED is a technique in which we use information about an experiment's users from before an experiment started to reduce the variance in their experiment metrics."}),"\n",(0,n.jsx)(t.p,{children:"The pre-experiment information we use is referred to as a \"control variate\". We adjust the user's metric value based on this control variate multiplied by a coefficient \u03b8. The method by which it reduces variance is conceptually similar to adding a second variable to a linear regression predicting users' metric value, where the first variable is the treatment group. Part of the error previously attributed to the experiment group term will be explained by the new variable."}),"\n",(0,n.jsx)(t.p,{children:"Extending this observation, the more correlated the pre-experiment information is with the post-experiment information, the more of the error or noise in the experiment results is explained by the covariate, and the more the variance in the experimental term is reduced."}),"\n",(0,n.jsx)(t.h3,{id:"where-cuped-works-best",children:"Where CUPED works best"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"CUPED works best on metrics and behaviors which are predictable from past behavior; in particular, if a metric is consistent over time for the same user, CUPED can be very effective"}),"\n",(0,n.jsx)(t.li,{children:"CUPED also acts as a partial solve for pre-exposure bias. If one group has a systemic bias in their pre-exposure data (which is independent of the experiment group they are in), their adjusted metric value will be adjusted towards the population mean."}),"\n"]}),"\n",(0,n.jsx)(t.h3,{id:"where-cuped-is-less-effective",children:"Where CUPED is less effective"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"CUPED does not work on new users, because there is not pre-exposure data to leverage"}),"\n",(0,n.jsx)(t.li,{children:"CUPED is less effective if a user's metric value is uncorrelated with historical behavior"}),"\n",(0,n.jsx)(t.li,{children:"On Statsig Cloud : CUPED will not be applied historically for newly created metrics, or metrics that were added to Key Metrics partway through an experiment, but will be calculated for exposed users after the metric is added."}),"\n",(0,n.jsx)(t.li,{children:'CUPED is applied to most metric types, but not all. Today, funnel metrics and "event user" metrics (# users who had an event 1+ time in a given time window) are CUPED-ineligible. We\'re working on rolling CUPED out to more metric types.'}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"winsorization",children:"Winsorization"}),"\n",(0,n.jsx)(t.p,{children:"Another common technique for reducing noise is Winsorization, which is a way to manage the influence of outliers."}),"\n",(0,n.jsxs)(t.p,{children:["Winsorization refers to the practice of measuring the percentile ",(0,n.jsxs)(t.em,{children:["P",(0,n.jsx)("sub",{children:"x"})]})," of a metric and setting all values over ",(0,n.jsxs)(t.em,{children:["P",(0,n.jsx)("sub",{children:"x"})]})," to ",(0,n.jsxs)(t.em,{children:["P",(0,n.jsx)("sub",{children:"x"})]}),". At Statsig, the default percentile for winsorization is 99.9%. This reduces the influence of extreme outliers caused by factors such as logging errors or bad actors. (",(0,n.jsx)(t.a,{href:"https://docs.statsig.com/stats-engine/methodologies/winsorization/",children:"learn more"}),")"]}),"\n",(0,n.jsx)(t.h2,{id:"metric-selection",children:"Metric Selection"}),"\n",(0,n.jsxs)(t.p,{children:["The metrics you use can dramatically influence the sensitivity of your analysis. The transformations above, in addition to techniques like creating threshold-based flags, can let you trade-off exact numbers for significantly more power. Please refer to our ",(0,n.jsx)(t.a,{href:"https://www.statsig.com/blog/understanding-and-reducing-variance-and-standard-deviation",children:"blog post"})," on the topic for more information."]}),"\n",(0,n.jsx)(t.h2,{id:"literature",children:"Literature"}),"\n",(0,n.jsx)(t.p,{children:"Here's a short list of useful content for understanding more about these techniques and its applications"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://exp-platform.com/Documents/2013-02-CUPED-ImprovingSensitivityOfControlledExperiments.pdf",children:"Deng, Xu, Kohavi, & Walker"})," is the seminal paper on using this technique for online controlled experiments"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://booking.ai/how-booking-com-increases-the-power-of-online-experiments-with-cuped-995d186fff1d",children:"Booking.com"})," has an excellent blog post on the theory and practice of CUPED"]}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://www.kdd.org/kdd2016/papers/files/adp0945-xieA.pdf",children:"Improving the Sensitivity of Online Controlled Experiments: Case Studies at Netflix"})}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453:(e,t,i)=>{i.d(t,{R:()=>a,x:()=>o});var n=i(96540);const r={},s=n.createContext(r);function a(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);