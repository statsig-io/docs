"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[51598],{33976:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var i=n(74848),r=n(28453);const s={title:"Azure Metrics Upload (Deprecated)",slug:"azure-upload",keywords:["owner:tim"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},o=void 0,a={id:"integrations/data-imports/azure_upload-deprecated",title:"Azure Metrics Upload (Deprecated)",description:"This solution is still functional, but can be manual and time consuming to set up with minimal error handling. We encourage you to check out the Data Warehouse Ingestion solution instead.",source:"@site/docs/integrations/data-imports/azure_upload-deprecated.mdx",sourceDirName:"integrations/data-imports",slug:"/integrations/data-imports/azure-upload",permalink:"/integrations/data-imports/azure-upload",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/integrations/data-imports/azure_upload-deprecated.mdx",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Azure Metrics Upload (Deprecated)",slug:"azure-upload",keywords:["owner:tim"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"Snowflake (Deprecated)",permalink:"/integrations/data-imports/snowflake"},next:{title:"Exports Overview",permalink:"/integrations/data-exports/overview"}},d={},l=[{value:"Overview",id:"overview",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Filesystem Format",id:"filesystem-format",level:2},{value:"Data Format",id:"data-format",level:3},{value:"Scheduling",id:"scheduling",level:3},{value:"Checklist",id:"checklist",level:4}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.admonition,{type:"note",children:(0,i.jsxs)(t.p,{children:["This solution is still functional, but can be manual and time consuming to set up with minimal error handling. We encourage you to check out the ",(0,i.jsx)(t.a,{href:"/data-warehouse-ingestion/introduction",children:"Data Warehouse Ingestion"})," solution instead."]})}),"\n",(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(t.p,{children:"Statsig allows you to upload your pre-computed metrics data to a secure Azure blob owned by Statsig. We'll ingest all of your uploaded metrics for a day once you've signalled that a given day is finished uploading."}),"\n",(0,i.jsx)(t.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,i.jsx)(t.p,{children:"Reach out in slack or to your primary Statsig point of contact. We'll set up an Azure blob storage container and provide you with credentials to connect."}),"\n",(0,i.jsx)(t.h2,{id:"filesystem-format",children:"Filesystem Format"}),"\n",(0,i.jsx)(t.p,{children:"To allow for daily uploads, please set up your blob storage container with the following folders:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"events/"})," for events data"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"metrics/"})," for metrics data"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"signals/"})," for signal flags when you've finished uploading data for a day. You can omit this folder and instead use the ",(0,i.jsxs)(t.a,{href:"/metrics/ingest",children:[(0,i.jsx)(t.code,{children:"mark_data_ready"})," API"]})," instead, but you must use one or the other"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["We recommend writing folders by date partitions for ease of debugging, i.e. storing day's data in folders with ISO-formatted names (",(0,i.jsx)(t.code,{children:"YYYY-MM-DD"}),")."]}),"\n",(0,i.jsx)(t.h3,{id:"data-format",children:"Data Format"}),"\n",(0,i.jsx)(t.p,{children:"Please make sure your data conforms to the following schemas."}),"\n",(0,i.jsx)("b",{children:"Events"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"| Column         | Description                                                                                                       | Rules                                                                                                   |\n| -------------- | ----------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------- |\n| timestamp      | UNIX timestamp of the event                                                                                       | UTC timestamp                                                                                           |\n| event_name     | The name of the event                                                                                             | String under 128 characters, using `_` for spaces                                                       |\n| event_value    | A string representing the value of a current event. Can represent a 'dimension' or a 'value'                      | Read as string format; numeric values will be converted into value                                      |\n| event_metadata | A dictionary<string, string> in the form of a JSON string, containing named metadata for the event                | String format. Not null. Length < 128 characters                                                        |\n| user           | A JSON object representing the user this event was logged for; see below                                          | Escaped JSON string including the keys 'custom' and 'customIDs'. A userID or customID must be provided. |\n| timeuuid       | A unique UUID or timeUUID used for deduping. If omitted, will be generated but will not be effective for deduping | UUID format                                                                                             |\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Please refer to docs for the ",(0,i.jsx)(t.a,{href:"/concepts/user#user-attributes",children:"Statsig User Object"})," for available fields. An example would look like:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'{\n  userID: "12345",\n  customIDs: {\n    stableID: "<device_id_here>",\n    ...\n  }\n  email: "12345@gmail.com",\n  userAgent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.40 Safari/537.36",\n  ip: "192.168.1.101",\n  country: "US",\n  locale: "en_US",\n  appVersion: "1.0.1",\n  systemName: "Android",\n  systemVersion: "15.4",\n  browserName: "Chrome",\n  browserVersion: "45.0",\n  custom: {\n    new_user: "false",\n    age: "22"\n    ...\n  },\n}\n'})}),"\n",(0,i.jsx)("b",{children:"Metrics"}),"\n",(0,i.jsxs)(t.p,{children:["Make sure to include all of metric_value, numerator, and denominator, writing ",(0,i.jsx)(t.code,{children:"cast(null as double)"})," for numerator and denominator if you are omitting them (or conversely for metric_value if sending numerator/denominator)."]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Column"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{children:"Rules"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"unit_id"}),(0,i.jsx)(t.td,{children:"The unique user identifier this metric is for. This might not necessarily be a user_id - it could be a custom_id of some kind"}),(0,i.jsx)(t.td,{children:"String format. Make sure this is in the same format as your logged unit_ids"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"id_type"}),(0,i.jsx)(t.td,{children:"The id_type the unit_id represents."}),(0,i.jsx)(t.td,{children:"String format. Must be a valid id_type. The default Statsig types are user_id/stable_id, but you may have generated custom id_types. Make sure this matches (case sensitive) a customID in your project, or you won't get experiment results"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"date"}),(0,i.jsx)(t.td,{children:"Date of the daily metric"}),(0,i.jsx)(t.td,{children:"Read as string format; can be written as ISO date. Statsig's dates are calculated in PST - we'll load custom metrics to whatever date you use here"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"metric_name"}),(0,i.jsx)(t.td,{children:"The name of the metric"}),(0,i.jsx)(t.td,{children:"String format. Not null. Length < 128 characters"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"metric_value"}),(0,i.jsx)(t.td,{children:"A numeric value for the metric"}),(0,i.jsx)(t.td,{children:"Double format. Metric value, or both of numerator/denominator need to be provided for Statsig to process the metric. See details below"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"numerator"}),(0,i.jsx)(t.td,{children:"Numerator for metric calculation"}),(0,i.jsx)(t.td,{children:"Double format. Required for ratio metrics. If present along with a denominator in any record, the metric will be treated as ratio and only calculated for users with non-null denominators"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"denominator"}),(0,i.jsx)(t.td,{children:"Denominator for metric calculation"}),(0,i.jsx)(t.td,{children:"Double format. See above"})]})]})]}),"\n",(0,i.jsx)(t.h3,{id:"scheduling",children:"Scheduling"}),"\n",(0,i.jsx)(t.p,{children:"Because you may be streaming events to your tables or have multiple ETLs pointing to your metrics table, Statsig relies on you signalling that your metric/events for a given day are done."}),"\n",(0,i.jsxs)(t.p,{children:["To do this, write a dataset with the single column ",(0,i.jsx)(t.code,{children:"finished_date"}),", which contains all dates of data which have been written to Statsig. For example, once you have written data for ",(0,i.jsx)(t.code,{children:"2022-06-22"})," you would insert a record with ",(0,i.jsx)(t.code,{children:"finished_date"})," of ",(0,i.jsx)(t.code,{children:"2022-06-22"})," to trigger ingestion of data from up to and including ",(0,i.jsx)(t.code,{children:"2022-06-22"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Unlike some other integrations like Snowflake, for S3 Statsig will skip dates; if your latest finished date is ",(0,i.jsx)(t.code,{children:"2022-06-22"})," and you insert ",(0,i.jsx)(t.code,{children:"2022-07-01"}),", we will ingest all data as of ",(0,i.jsx)(t.code,{children:"2022-07-01"})," and infer that data for dates between (e.g. ",(0,i.jsx)(t.code,{children:"2022-06-25"}),") is loaded."]}),"\n",(0,i.jsxs)(t.p,{children:["Alternatively, you can use the ",(0,i.jsx)(t.code,{children:"mark_data_ready"})," API and send a timestamp for which the data previous to that timestamp has finished loading into your container."]}),"\n",(0,i.jsxs)(t.p,{children:["Note that, for events, Statsig processes days in PST. When you mark data ready for '2022-06-20', statsig will process events from ",(0,i.jsx)(t.code,{children:"2022-06-20T00:00"})," PST to ",(0,i.jsx)(t.code,{children:"2022-06-20T23:59...."})," PST. Keep this in mind when scheduling your signals!"]}),"\n",(0,i.jsx)("a",{name:"checklist"}),"\n",(0,i.jsx)(t.h4,{id:"checklist",children:"Checklist"}),"\n",(0,i.jsx)(t.p,{children:"These are common errors we've run into - please go through and make sure your setup is looking good!"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Field names are set incorrectly"}),"\n",(0,i.jsxs)(t.li,{children:["The ",(0,i.jsx)(t.code,{children:"id_type"})," is set correctly","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Default types are ",(0,i.jsx)(t.code,{children:"user_id"})," or ",(0,i.jsx)(t.code,{children:"stable_id"}),". If you have custom ids, make sure that the capitalization and spelling matches as these are case sensitive (you can find your custom ID types by going to your Project Settings in the Statsig console)."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["Your ids match the format of ids logged from SDKs","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["In some cases, your data warehouse may transform IDs. This may mean we can't join your experiment or feature gate data to your metrics to calculate pulse or other reports. You can go to the Metrics page of your project and view the log stream to check the format of the ids being sent (either ",(0,i.jsx)(t.code,{children:"User ID"}),", or a custom ID in ",(0,i.jsx)(t.code,{children:"User Properties"}),") to confirm they match"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(96540);const r={},s=i.createContext(r);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);