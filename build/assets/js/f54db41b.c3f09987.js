"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[66443],{45433:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});var r=n(74848),s=n(28453);const l={title:"Ingesting Open Telemetry Logs and Metrics into Statsig",sidebar_label:"Open Telemetry Logs and Metrics",slug:"/server/concepts/open_telemetry",keywords:["owner:karan"],last_update:{date:new Date("2025-06-05T00:00:00.000Z")}},o="Ingesting Open Telemetry Logs and Metrics into Statsig",i={id:"server/concepts/open_telemetry",title:"Ingesting Open Telemetry Logs and Metrics into Statsig",description:"Setting up OTEL can be tricky, if you have any questions, feel free to reach out to us on slack!",source:"@site/docs/server/concepts/open_telemetry.mdx",sourceDirName:"server/concepts",slug:"/server/concepts/open_telemetry",permalink:"/server/concepts/open_telemetry",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/server/concepts/open_telemetry.mdx",tags:[],version:"current",lastUpdatedAt:17490816e5,frontMatter:{title:"Ingesting Open Telemetry Logs and Metrics into Statsig",sidebar_label:"Open Telemetry Logs and Metrics",slug:"/server/concepts/open_telemetry",keywords:["owner:karan"],last_update:{date:"2025-06-05T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"Environments",permalink:"/guides/using-environments"},next:{title:"Testing Your Setup",permalink:"/guides/testing"}},c={},a=[{value:"Overview",id:"overview",level:2},{value:"\u2705 Prerequisites",id:"-prerequisites",level:2},{value:"1. Setup OpenTelemetry Collector on Kubernetes",id:"1-setup-opentelemetry-collector-on-kubernetes",level:2},{value:"Why both?",id:"why-both",level:3},{value:"2. Configure exporting telemetry to Statsig with OTLP HTTP Exporter",id:"2-configure-exporting-telemetry-to-statsig-with-otlp-http-exporter",level:2},{value:"Authentication",id:"authentication",level:3},{value:"Example Exporter Config",id:"example-exporter-config",level:3},{value:"3. Example Helm Chart Values for a quick and correct setup",id:"3-example-helm-chart-values-for-a-quick-and-correct-setup",level:2},{value:"\ud83d\udd17 Deployment Collector",id:"-deployment-collector",level:3},{value:"\ud83d\udd17 DaemonSet Collector",id:"-daemonset-collector",level:3},{value:"4. Verify the Setup",id:"4-verify-the-setup",level:2},{value:"5. Explore",id:"5-explore",level:2},{value:"\ud83d\udd17 Resources",id:"-resources",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"ingesting-open-telemetry-logs-and-metrics-into-statsig",children:"Ingesting Open Telemetry Logs and Metrics into Statsig"})}),"\n",(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsx)(t.p,{children:"Setting up OTEL can be tricky, if you have any questions, feel free to reach out to us on slack!"})}),"\n",(0,r.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(t.p,{children:["This guide walks you through setting up the OpenTelemetry Collector in your Kubernetes environment and configuring it to send telemetry data to Statsig using the official ",(0,r.jsx)(t.code,{children:"otlphttp"})," exporter"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"-prerequisites",children:"\u2705 Prerequisites"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"A running Kubernetes cluster (e.g., GKE, EKS, Minikube, etc.)"}),"\n",(0,r.jsx)(t.li,{children:"Helm installed, or another mechanism to apply helm charts to your cluster, like ArgoCD"}),"\n",(0,r.jsx)(t.li,{children:"API Access to a Statsig project with a Server SDK Secret Key"}),"\n",(0,r.jsxs)(t.li,{children:["Optional: ",(0,r.jsx)(t.code,{children:"kubectl"})," configured and connected to the cluster, for validating and debugging setup"]}),"\n"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"1-setup-opentelemetry-collector-on-kubernetes",children:"1. Setup OpenTelemetry Collector on Kubernetes"}),"\n",(0,r.jsxs)(t.p,{children:["Our recommend setup follows the official OpenTelemetry Kubernetes guide to install the OpenTelemetry Collector in both ",(0,r.jsx)(t.strong,{children:"DaemonSet"})," and ",(0,r.jsx)(t.strong,{children:"Deployment"})," modes, using the official Helm Chart. ",(0,r.jsx)(t.strong,{children:"Note:"})," You'll find well-tested and ready-to-use ",(0,r.jsx)(t.code,{children:"values.yaml"})," files for both deployments modes in Step 3!"]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"\ud83d\udcd8 Official Guide:"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/platforms/kubernetes/getting-started/",children:"OpenTelemetry Collector for Kubernetes \u2013 Getting Started"})}),"\n",(0,r.jsx)(t.h3,{id:"why-both",children:"Why both?"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"DaemonSet Collector"}),": Runs one instance per node to collect host-level telemetry (e.g., logs, pod and node metrics)."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:"Deployment Collector"}),": Runs one instance per cluster to gather telemetry related to the cluster as a whole."]}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["We recommend configuring these receivers at the minimum, for a useful observability platform for your kubernetes workloads powered by Statsig. We make use of the powerful ",(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/platforms/kubernetes/helm/collector/#presets",children:"Presets"})," provided by the official chart, but also customize some components as can be seen in the sample values files in Step 3."]}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Minimum for scraping logs:","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/platforms/kubernetes/getting-started/#filelog-receiver",children:"Filelog Receiver"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/platforms/kubernetes/getting-started/#kubernetes-attributes-processor",children:"Kubernetes Attributes Processor"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["Minimum for scraping kubernetes metrics","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/platforms/kubernetes/getting-started/#kubeletstats-receiver",children:"KubeletStats Receiver"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/platforms/kubernetes/getting-started/#kubernetes-cluster-receiver",children:"Kubernetes Cluster Receiver"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(t.li,{children:["Minimum for metrics about Otel Collector itself","\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/platforms/kubernetes/getting-started/#otlp-receiver",children:"OTLP Receiver"})," for ",(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/collector/internal-telemetry/#configure-internal-metrics",children:"scraping internal metrics"})," (alternatively scraped through prometheus receiver)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"2-configure-exporting-telemetry-to-statsig-with-otlp-http-exporter",children:"2. Configure exporting telemetry to Statsig with OTLP HTTP Exporter"}),"\n",(0,r.jsxs)(t.p,{children:["Statsig supports receiving OTLP formatted, JSON encoded telemetry at the endpoint ",(0,r.jsx)(t.code,{children:"https://api.statsig.com/otlp"}),". The OpenTelemetry Collector supports sending the scraped telemetry to the Statsig endpoint via the official ",(0,r.jsx)(t.code,{children:"otlphttp"})," exporter."]}),"\n",(0,r.jsx)(t.h3,{id:"authentication",children:"Authentication"}),"\n",(0,r.jsxs)(t.p,{children:["Requests are authenticated using request header ",(0,r.jsx)(t.code,{children:"statsig-api-key"})," and a valid SDK Server Secret key generated from ",(0,r.jsx)(t.a,{href:"http://console.statsig.com",children:"console.statsig.com"})," (under Settings > Keys & Environments). It is recommended to keep your secret key secure with a Kubernetes Secret management provider and make it available to access securely from the open telemetry collector pod\u2019s environment."]}),"\n",(0,r.jsx)(t.h3,{id:"example-exporter-config",children:"Example Exporter Config"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"exporters:\n  otlphttp:\n    endpoint: https://api.statsig.com/otlp\n    encoding: json\n    headers:\n      statsig-api-key: ${env:STATSIG_SERVER_SDK_SECRET}\n"})}),"\n",(0,r.jsx)(t.h2,{id:"3-example-helm-chart-values-for-a-quick-and-correct-setup",children:"3. Example Helm Chart Values for a quick and correct setup"}),"\n",(0,r.jsxs)(t.p,{children:["We provide two complete and tested ",(0,r.jsx)(t.code,{children:"values.yaml"})," configurations for use with the OpenTelemetry Helm charts:"]}),"\n",(0,r.jsx)(t.h3,{id:"-deployment-collector",children:"\ud83d\udd17 Deployment Collector"}),"\n",(0,r.jsxs)(t.p,{children:["\ud83d\udc49 ",(0,r.jsx)(t.a,{href:"https://gist.github.com/karan-statsig/d5c70b7fd100ab445985b620dcb7e8c6",children:"values-gateway.yaml"})]}),"\n",(0,r.jsx)(t.h3,{id:"-daemonset-collector",children:"\ud83d\udd17 DaemonSet Collector"}),"\n",(0,r.jsxs)(t.p,{children:["\ud83d\udc49 ",(0,r.jsx)(t.a,{href:"https://gist.github.com/karan-statsig/f02ee95fef00aecde402829b5a4c60e8",children:"values-agent.yaml"})]}),"\n",(0,r.jsxs)(t.p,{children:["Use them with the Helm chart version ",(0,r.jsx)(t.code,{children:"0.75.1"})," like this:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"helm repo add open-telemetry https://open-telemetry.github.io/opentelemetry-helm-charts\nhelm repo update\n\n# Install Deployment Collector\nhelm install otel-deployment open-telemetry/opentelemetry-collector \\\n  --version 0.75.1 \\\n  -f values-gateway.yaml -n otel --create-namespace\n\n# Install DaemonSet Collector\nhelm install otel-daemonset open-telemetry/opentelemetry-collector \\\n  --version 0.75.1 \\\n  -f values-agent.yaml -n otel\n"})}),"\n",(0,r.jsx)(t.h2,{id:"4-verify-the-setup",children:"4. Verify the Setup"}),"\n",(0,r.jsx)(t.p,{children:"Check that all pods are running:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"kubectl get pods -n otel\n"})}),"\n",(0,r.jsx)(t.p,{children:"Check logs for a specific collector pod and confirm there are errors reported:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"kubectl logs -n otel $pod_name\n"})}),"\n",(0,r.jsx)(t.h2,{id:"5-explore",children:"5. Explore"}),"\n",(0,r.jsxs)(t.p,{children:["Explore your Logs and Metrics at ",(0,r.jsx)(t.a,{href:"http://console.statsig.com",children:"console.statsig.com"})," with the Logs Explorer and Metrics Explorer products under Analytics on the sidebar menu \ud83d\ude42"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"-resources",children:"\ud83d\udd17 Resources"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/collector/",children:"OpenTelemetry Collector Documentation"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/platforms/kubernetes/collector/components/",children:"Important Concepts for Kubernetes"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://github.com/open-telemetry/opentelemetry-helm-charts",children:"Helm Chart Reference"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/collector/configuration",children:"Collector Configuration Reference"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/specs/otlp/",children:"OTLP Protocol Specification"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var r=n(96540);const s={},l=r.createContext(s);function o(e){const t=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(l.Provider,{value:t},e.children)}}}]);