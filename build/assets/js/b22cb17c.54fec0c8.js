"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[27415],{26699:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var i=s(74848),n=s(28453);const a={title:"Advanced ID Resolution",slug:"/statsig-warehouse-native/features/id-resolution",sidebar_label:"Advanced ID Resolution",description:"Map cross-platform IDs in experiment analysis and analyze anonymous user experiments",keywords:["owner:vm"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},r=void 0,o={id:"statsig-warehouse-native/features/id-resolution",title:"Advanced ID Resolution",description:"Map cross-platform IDs in experiment analysis and analyze anonymous user experiments",source:"@site/docs/statsig-warehouse-native/features/id-resolution.md",sourceDirName:"statsig-warehouse-native/features",slug:"/statsig-warehouse-native/features/id-resolution",permalink:"/statsig-warehouse-native/features/id-resolution",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/statsig-warehouse-native/features/id-resolution.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Advanced ID Resolution",slug:"/statsig-warehouse-native/features/id-resolution",sidebar_label:"Advanced ID Resolution",description:"Map cross-platform IDs in experiment analysis and analyze anonymous user experiments",keywords:["owner:vm"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"warehouse",previous:{title:"Targeting",permalink:"/statsig-warehouse-native/features/targeting"},next:{title:"Filter Exposures",permalink:"/statsig-warehouse-native/features/filtering-exposures"}},d={},c=[{value:"The Identity Challenge",id:"the-identity-challenge",level:2},{value:"Mapping Modes",id:"mapping-modes",level:2},{value:"Strict 1:1 Mapping",id:"strict-11-mapping",level:3},{value:"First Touch Mapping",id:"first-touch-mapping",level:3},{value:"Last Touch Mapping (beta)",id:"last-touch-mapping-beta",level:3},{value:"Note on ID stitching",id:"note-on-id-stitching",level:3},{value:"How it Works",id:"how-it-works",level:2},{value:"Using Property Source",id:"using-property-source",level:3},{value:"Using Assignment Source",id:"using-assignment-source",level:3},{value:"Mapping Changes",id:"mapping-changes",level:3},{value:"Best Practices",id:"best-practices",level:3},{value:"Example of a supported schema",id:"example-of-a-supported-schema",level:4},{value:"Considerations",id:"considerations",level:2}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"Statsig warehouse native natively supports resolving multiple IDs to one identified user, allowing you to easily expose an experiment on one identifier and analyze data coming from one to many mapped identities associated with that experimental unit."}),"\n",(0,i.jsx)(t.p,{children:"Common scenarios where this is used are:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Exposing logged out users and analyzing logged-in metrics like revenue or a funnel going from logged-out marketing page landing -> to a logged-in subscription purchase"}),"\n",(0,i.jsxs)(t.li,{children:["Utilizing one",":many"," relationships, e.g. a single user owns multiple accounts. ID resolution lets you aggregate metric from the user's mapped accounts"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"ID resolution is a common need in experimentation; generally the responsibility for this mapping is put onto data users or PMs running experiment analysis, which leads to inconsistent results and expensive query logic. Using Advanced ID Resolution streamlines the process, making it consistent and performant and allowing all users to point to trusted identity tables."}),"\n",(0,i.jsx)(t.h2,{id:"the-identity-challenge",children:"The Identity Challenge"}),"\n",(0,i.jsx)(t.p,{children:"A common problem in experimentation is trying to connect different user identifiers before or after some event boundary, most frequently signups."}),"\n",(0,i.jsx)(t.p,{children:"In these scenarios, the experimenter will have a logged-out identifier (e.g. a cookie or a Statsig stableID) as well as - for those who do sign up - a userID generated after the user signs up. Because business metrics are generally calculated at the grain of userID, it's common to want to run an experiment where the unit of analysis is a logged out identifier, but the evaluation criteria for the experiment is a logged-in metric (e.g. purchase revenue, or estimated Lifetime Value)."}),"\n",(0,i.jsx)(t.p,{children:"Many platforms handle this in an ad-hoc way, which requires the user to do pre-processing to join and deduplicate exposures, or tagging userID metrics with an associated logged-out identifier. This is tractable, but leads to you having to manage and debug fairly complex queries resolving identifiers across timestamps and joining mapping tables to your source-of-truth fact tables.."}),"\n",(0,i.jsx)(t.p,{children:"Statsig Warehouse Native offers an automatic, no-code solution for connecting identifiers across this boundary in a centralized and reproducible way."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://github.com/user-attachments/assets/05cb4f49-14a2-4b51-a0e0-63f127838ce4",alt:"Docs_IDresolution_TheProblem_111224b"})}),"\n",(0,i.jsx)(t.h2,{id:"mapping-modes",children:"Mapping Modes"}),"\n",(0,i.jsx)(t.p,{children:"When using Advanced ID resolution, you can choose between modes:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Strict 1:1 mapping enforces that identities have a singular mapping. If you have a mapping between two IDs that are always 1:1, this mode enforces that the mapping is singular and warns you if there's data where that's to the case. Users with a single identity can use downstream metrics from the secondary identity, and multi-mapped users are considered corrupted and discarded from the analysis"}),"\n",(0,i.jsx)(t.li,{children:'First-touch mapping is for cases where units might have multiple mappings, in either direction. For example, a single user may have multiple "profiles", or someone may have logged into the same account from several devices or web sessions. In this case, units will use the experiment group of their first exposure for analysis, and aggregate metrics from all of their associated secondary IDs.'}),"\n"]}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Strict 1:1 Mapping"}),(0,i.jsx)(t.th,{children:"First Touch Mapping"})]})}),(0,i.jsx)(t.tbody,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.img,{alt:"Enforced1to1Mapping",src:s(90563).A+"",width:"684",height:"674"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.img,{alt:"FirstTouchAttribution",src:s(47594).A+"",width:"684",height:"674"})})]})})]}),"\n",(0,i.jsx)(t.h3,{id:"strict-11-mapping",children:"Strict 1:1 Mapping"}),"\n",(0,i.jsx)(t.p,{children:"All potential mappings between identifiers within the experiment date range, on the exposed population, are collected. If the primary ID has multiple secondary IDs, or vice versa, it is considered polluted and dropped from the analysis."}),"\n",(0,i.jsx)(t.h3,{id:"first-touch-mapping",children:"First Touch Mapping"}),"\n",(0,i.jsx)(t.p,{children:"The direction of first-touch mapping will be based on the experiment; all secondary IDs resolve to 1 primary ID, and a single primary ID can have multiple mapped secondary IDs. If your aim is to only have one secondary ID, you can manage that logic inside the entity property source today, but feel free to reach out to support if there's specific logic you would like to request."}),"\n",(0,i.jsx)(t.p,{children:"Data is attributed to the group of the first associated primary ID seen in the exposure. If a secondary ID has multiple associated primary IDs, the group of the first primary ID will be used. Note that this means users that cross groups are not discarded from analysis but instead are assigned based on the the first experience they had."}),"\n",(0,i.jsx)(t.p,{children:"Primary ID records that are associated with another Primary ID, but are not the first observed records, are dropped from the analysis. If a user is exposed twice on different primary IDs that resolve to the same secondary IDs, only the primary ID metrics from the first-exposed user will be kept in the analysis."}),"\n",(0,i.jsx)(t.h3,{id:"last-touch-mapping-beta",children:"Last Touch Mapping (beta)"}),"\n",(0,i.jsx)(t.p,{children:"Same as first touch but data is attributed to the most recent primary ID."}),"\n",(0,i.jsx)(t.h3,{id:"note-on-id-stitching",children:"Note on ID stitching"}),"\n",(0,i.jsx)(t.p,{children:'Multiple secondary IDs attached to one primary ID still count as "one" experimental primary ID; the metric values will be merged across records from the different secondary IDs - e.g. added in a sum metric or counted in a count metric.'}),"\n",(0,i.jsx)(t.admonition,{type:"info",children:(0,i.jsx)(t.p,{children:"We are interested in supporting more complex 1-to-many relationships of identities and are eager to partner with customers to develop these capabilities if a more advanced use-case is required."})}),"\n",(0,i.jsx)(t.h2,{id:"how-it-works",children:"How it Works"}),"\n",(0,i.jsx)(t.p,{children:"Setting up identity resolution in Statsig is very simple. You can either log or join data to provide both IDs on your assignment source, or provide one ID in the assignment source along with a mapping table between the IDs in the form of an Entity Property Source."}),"\n",(0,i.jsx)(t.h3,{id:"using-property-source",children:"Using Property Source"}),"\n",(0,i.jsx)(t.p,{children:"To use Identity Resolution across experiments in your project, you will need a lookup table that has both the ID you are exposing on and the selected targeted ID. This table can be configured by setting up an Entity Property Source with both IDs present."}),"\n",(0,i.jsx)(t.p,{children:"Once that's done, you can simply select this source when configuring your secondary ID type, and Statsig handles the join for you."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/102695539/3fc0422d-ed96-4fe6-9e52-05e24a6cc2a2",alt:"ID resolution source configuration interface"})}),"\n",(0,i.jsxs)(t.p,{children:['If you want to use a Statsig SDK to populate this table, you can log an event (like a "Signup" event that has both the logged-out identifier and the user ID on the same event. Events sent via the Statsig SDK are written into your warehouse - and you can configure an Identity Resolution source on top of that using something like this -\n',(0,i.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/31516123/6b2a3d0e-a1ad-446b-a604-43dd050f05fa",alt:"Identity resolution configuration interface"})]}),"\n",(0,i.jsx)(t.h3,{id:"using-assignment-source",children:"Using Assignment Source"}),"\n",(0,i.jsx)(t.p,{children:"When creating an assignment source, provide a column for both ID types. It is assumed that your 'Primary ID' will be non-null for exposure records. Your secondary ID can be null. If your secondary ID is sparse (some records are null, and some are not due to logging), Statsig will back-attribute any identified secondary ID to other records from the same Primary ID."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://github.com/statsig-io/docs/assets/102695539/8cbdd8cc-2ea6-4bf8-a620-0428051989d1",alt:"ID Resolution Assignment Source"})}),"\n",(0,i.jsx)(t.p,{children:"When you create an analysis-only experiment or power analysis with this ID type, you can optionally select a Secondary ID. If you do so, you can now use metrics from either ID type in your analysis. For E2E experiments that use the Statsig SDK, this is configurable on the experiment setup page, under Advanced settings."}),"\n",(0,i.jsx)(t.p,{children:"Behind the scenes:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"For metric sources with the primary ID, metrics will be joined to exposures based on that primary ID"}),"\n",(0,i.jsx)(t.li,{children:"For metric sources with only the secondary ID, metric will be joined to exposures based on that Secondary ID"}),"\n",(0,i.jsx)(t.li,{children:"If using strict mode, users with a duplicate mapping are dropped from analysis. Using first-touch, units use their first exposure record, and merge data from all mapped secondary IDs."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"This works natively across Metric Sources, so you can easily set up funnel or ratio metrics across the two ID types."}),"\n",(0,i.jsx)(t.p,{children:"Analysis is done using the primary ID - this process associates metric values that are on an associated secondary ID."}),"\n",(0,i.jsx)(t.h3,{id:"mapping-changes",children:"Mapping Changes"}),"\n",(0,i.jsxs)(t.p,{children:["If a change is made to the entity property source or assignment source's definition or underlying data, that will be reflected on the next reload. This is ",(0,i.jsx)(t.strong,{children:"why"})," a full reload is required, since otherwise historical changes to the mapping can lead to inconsistent data on incremental reloads or explore queries."]}),"\n",(0,i.jsx)(t.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(t.p,{children:["We strongly recommend using an ",(0,i.jsx)(t.a,{href:"/statsig-warehouse-native/configuration/entity-properties",children:"Entity Property Source"})," to provide a cleaned unit mapping from your warehouse. However, you can also provide mappings on your exposure source by logging multiple identifiers in the exposure data - Statsig will greedily use this to match across identifiers."]}),"\n",(0,i.jsx)(t.p,{children:"For both modes, an experiment can currently only have one mapped ID type - e.g. secondary_id->user_id, or secondary_id->account_id, but not both."}),"\n",(0,i.jsx)(t.p,{children:"All modes will require a full reload, so that there's not data inconsistency due to historical mappings being changed or new mappings introduced."}),"\n",(0,i.jsx)(t.p,{children:'The property source or assignment source used to provide mappings will be filtered to records within the experiment\'s date range. If a mapping is "evergreen", or not scoped to a specific time period, you can omit the timestamp on the entity property source.'}),"\n",(0,i.jsx)(t.h4,{id:"example-of-a-supported-schema",children:"Example of a supported schema"}),"\n",(0,i.jsxs)(t.p,{children:["if your assignment source data contains:",(0,i.jsx)("br",{}),(0,i.jsx)(t.code,{children:"{stableID: 'unknown_123', exp_id: 'PDP Test', test_group: 'Control'}"})]}),"\n",(0,i.jsxs)(t.p,{children:["and your metric sources contain data that represents a metric as:",(0,i.jsx)("br",{}),(0,i.jsx)(t.code,{children:"{userID: 'known_abc', event: 'page_load'}"})]}),"\n",(0,i.jsxs)(t.p,{children:["Your Entity Source or Assignment source must contain the secondary identity (in this case, ",(0,i.jsx)(t.code,{children:"userID"}),") that will enable Statsig to join your assignment data with your metric data:",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(t.code,{children:"{stableID: 'unknown_123', userID: 'known_abc', country: 'USA'}"})]}),"\n",(0,i.jsx)(t.h2,{id:"considerations",children:"Considerations"}),"\n",(0,i.jsx)(t.p,{children:"Deduplicating records can lead to biased results, so Statsig preforms two extra health checks on this kind of experiment."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Statsig will check your deduplication rate and warn you if it is unusually high. It's expected that some secondary IDs will have multiple logged-out IDs due to users\nusing different devices or clearing browser history"}),"\n",(0,i.jsx)(t.li,{children:"Statsig will perform a chi-squared test evaluating if the deduplication rate is identical across arms of the experiment. In some cases, an experiment may cause more users to come back (for example an email resurrection campaign), in which case duplicates are expected to be more frequent in that arm and can be a positive outcome. In this case, you can perform first-touch attribution to maintain a common identifier"}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},90563:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/Docs_IDresolution_Enforced1to1Mapping_111324-7cae26878a0ce076440c141ec39e1982.gif"},47594:(e,t,s)=>{s.d(t,{A:()=>i});const i=s.p+"assets/images/Docs_IDresolution_FirstTouchAttribution_111324-79bc89258057edb19f862dcddb1d5e68.gif"},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>o});var i=s(96540);const n={},a=i.createContext(n);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);