"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[24564],{73086:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var s=n(74848),i=n(28453);const r={title:"Macros",slug:"/statsig-warehouse-native/configuration/query-tools",sidebar_label:"Macros",keywords:["owner:vm"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},o=void 0,a={id:"statsig-warehouse-native/configuration/query-tools",title:"Macros",description:"In Metric and Assignment sources, you can use Statsig Macros to directly inject a DATE() type which will be relative to the experiment period being loaded.",source:"@site/docs/statsig-warehouse-native/configuration/query-tools.md",sourceDirName:"statsig-warehouse-native/configuration",slug:"/statsig-warehouse-native/configuration/query-tools",permalink:"/statsig-warehouse-native/configuration/query-tools",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/statsig-warehouse-native/configuration/query-tools.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Macros",slug:"/statsig-warehouse-native/configuration/query-tools",sidebar_label:"Macros",keywords:["owner:vm"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"warehouse",previous:{title:"Verified Metrics",permalink:"/metrics/verified"},next:{title:"WHN Console API",permalink:"/statsig-warehouse-native/configuration/console-api"}},l={},c=[{value:"Timezone Note",id:"timezone-note",level:2},{value:"Advanced Macros",id:"advanced-macros",level:2}];function d(e){const t={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["In ",(0,s.jsx)(t.strong,{children:"Metric"})," and ",(0,s.jsx)(t.strong,{children:"Assignment sources"}),", you can use Statsig Macros to directly inject a DATE() type which will be relative to the experiment period being loaded."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"{statsig_start_date}"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"{statsig_end_date}"})}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["For example, in an incremental reload from ",(0,s.jsx)(t.code,{children:"2023-09-01"})," to ",(0,s.jsx)(t.code,{children:"2023-09-03"}),", this query:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"SELECT\n    user_id,\n    event,\n    ts,\n    dt\nFROM log_table\nWHERE dt BETWEEN `{statsig_start_date}` AND `{statsig_end_date}`\n"})}),"\n",(0,s.jsx)(t.p,{children:"resolves to"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"SELECT\n    user_id,\n    event,\n    ts,\n    dt\nFROM log_table\nWHERE dt BETWEEN DATE('2023-09-01') AND DATE('2023-09-03')\n"})}),"\n",(0,s.jsx)(t.p,{children:"This is a powerful tool since you can inject filters into queries with joins or CTEs and be confident that the initial scan will be pruned."}),"\n",(0,s.jsx)(t.p,{children:"We will adjust the range as necessary in some cases. For example, in entity properties we will add some pre-experiment buffer to allow for late-landing property data. We then choose the most recent value as of each unit's exposure. For CUPED, we will adjust the range to include the pre-experiment window for CUPED calculations."}),"\n",(0,s.jsx)(t.h2,{id:"timezone-note",children:"Timezone Note"}),"\n",(0,s.jsx)(t.p,{children:"All timestamps in Warehouse Native from statsig are in UTC, and it is assumed that timestamps in the warehouse will be timezone-less/UTC as well."}),"\n",(0,s.jsx)(t.h2,{id:"advanced-macros",children:"Advanced Macros"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"{statsig_start_date_int}"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"{statsig_end_date_int}"}),"\nInt versions of the above for use with number based partitioning - e.g. '2025-03-01' => 20250301"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"{statsig_experiment_start_timestamp}"}),"\nOnly available for metric sources and entity property sources; this will resolve to the start timestamp of the experiment. In non-experiment contexts, it resolves to ",(0,s.jsx)(t.code,{children:"TIMESTAMP('1970-01-01')"}),'. This is useful for generating entity properties such as "30d revenue before the experiment started".']}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var s=n(96540);const i={},r=s.createContext(i);function o(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);