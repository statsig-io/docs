"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[65207],{44660:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var s=n(74848),i=n(28453);const a={title:"Percentile Metrics",sidebar_label:"Percentile",keywords:["owner:vm"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},r=void 0,o={id:"statsig-warehouse-native/metrics/percentile",title:"Percentile Metrics",description:"Summary",source:"@site/docs/statsig-warehouse-native/metrics/percentile.md",sourceDirName:"statsig-warehouse-native/metrics",slug:"/statsig-warehouse-native/metrics/percentile",permalink:"/statsig-warehouse-native/metrics/percentile",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/statsig-warehouse-native/metrics/percentile.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Percentile Metrics",sidebar_label:"Percentile",keywords:["owner:vm"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"warehouse",previous:{title:"Funnel++",permalink:"/statsig-warehouse-native/metrics/funnel"},next:{title:"Log",permalink:"/statsig-warehouse-native/metrics/log"}},l={},c=[{value:"Summary",id:"summary",level:2},{value:"Use Cases",id:"use-cases",level:3},{value:"Calculation",id:"calculation",level:2},{value:"Methodology Notes",id:"methodology-notes",level:3},{value:"Options",id:"options",level:2}];function u(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"Percentile metrics calculate a customizable Nth percentile of a column from a metric source across experiment groups."}),"\n",(0,s.jsx)(t.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsx)(t.p,{children:"In many cases, the mean of a metric can be acceptable, but the tail end (e.g. 99th percentile or more) can be unacceptable; imagine a website with an average TTL of 300ms, but a p99 TTL of 1 minute. A small portion of the population is getting an unusable experience that does not show up in the mean, so it's hard to measure if this p99 value moved with traditional A/B/n metrics."}),"\n",(0,s.jsx)(t.p,{children:"Percentiles are popular for guardrail metrics around performance regression, as well as measuring improvements gained from investments in performance and infrastructure."}),"\n",(0,s.jsx)(t.h2,{id:"calculation",children:"Calculation"}),"\n",(0,s.jsx)(t.p,{children:"For percentile metrics, there is no unit-level calculation; the analysis is run at the group level."}),"\n",(0,s.jsx)(t.p,{children:"This would look like the SQL below:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'-- Group Level\nSELECT\n  exposures_data.group_id,\n  PERCENTILE(user_data.value, percentile_level) as value,\n  COUNT(distinct user_data.user_id) as population\nFROM user_data\nJOIN exposure_data\nON\n  -- Only include users who saw the experiment\n  source_data.unit_id = exposure_data.unit_id\n  -- Only include data from after the user saw the experiment\n  -- In this case exposure_data is already deduped to the "first exposure"\n  AND source_data.timestamp >= exposure_data.timestamp\nWHERE value IS NOT NULL\nGROUP BY group_id;\n'})}),"\n",(0,s.jsx)(t.h3,{id:"methodology-notes",children:"Methodology Notes"}),"\n",(0,s.jsxs)(t.p,{children:["Percentile metrics use the outer CI method to estimate a confidence interval and significance. Deng Et. Al. have a good description of the methodology in section 4 of ",(0,s.jsx)(t.a,{href:"https://arxiv.org/pdf/1803.06336",children:"this paper"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"Note that some metrics are not well formed for this approach; there's an assumption that the underlying distribution is continuous. For example, if your data has 1/3 of its rows with a value of 0, 1/3 with a value of 5, and 1/3 with a value of 10, we will not calculate results for significance for a median or p99 metric since there's no local variability."}),"\n",(0,s.jsx)(t.h2,{id:"options",children:"Options"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Metric Breakdowns","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"You can configure Metadata Columns to group results by, getting easy access to dimensional views in pulse results"}),"\n"]}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var s=n(96540);const i={},a=s.createContext(i);function r(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(a.Provider,{value:t},e.children)}}}]);