"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[66222],{2099:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>o,metadata:()=>r,toc:()=>d});var i=n(74848),a=n(28453);const o={title:"Contextual Bandit",sidebar_label:"Contextual Bandit",slug:"/contextual-bandit",keywords:["owner:vm"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},s=void 0,r={id:"autotune/contextual-bandit",title:"Contextual Bandit",description:"Model",source:"@site/docs/autotune/contextual-bandit.md",sourceDirName:"autotune",slug:"/contextual-bandit",permalink:"/contextual-bandit",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/autotune/contextual-bandit.md",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Contextual Bandit",sidebar_label:"Contextual Bandit",slug:"/contextual-bandit",keywords:["owner:vm"],last_update:{date:"2025-09-18T00:00:00.000Z"}}},l={},d=[{value:"Model",id:"model",level:2},{value:"Feature Types",id:"feature-types",level:2},{value:"Outcome Types",id:"outcome-types",level:2},{value:"Advantages",id:"advantages",level:2},{value:"Disadvantages",id:"disadvantages",level:2},{value:"Methodology and Notes",id:"methodology-and-notes",level:2},{value:"Samples Required",id:"samples-required",level:3},{value:"Attribution",id:"attribution",level:3},{value:"Exploration",id:"exploration",level:3}];function u(e){const t={a:"a",h2:"h2",h3:"h3",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"model",children:"Model"}),"\n",(0,i.jsx)(t.p,{children:'Autotune UI implements a variant of the LinUCB algorithm. This estimates a user\'s outcome for each variant, and incorporates the model\'s uncertainty to determine an "upper bound" for the prediction. This upper bound is used to select a variant, which is the explore mechanism; in layperson\'s terms the bandit is selecting for the "highest potential upside" predicted.'}),"\n",(0,i.jsx)(t.p,{children:'For example, if Autotune AI has two variants and for user "Bob" they have the following predictions for click-through rate:'}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Variant A: 6% \xb1 0.5%"}),"\n",(0,i.jsx)(t.li,{children:"Variant B: 4% \xb1 3%"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"The user will be served model B, even though A has a higher prediction, because the \"upside\" of B's prediction is 7% vs. A's 6.5%. A variant's prediction usually has higher variance when there's low sample, or when the relationship between features and outcome is still fuzzy. As more traffic is delivered, the uncertainty will shrink. After more samples, the values might go to:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Variant A: 5.9% \xb1 0.4%"}),"\n",(0,i.jsx)(t.li,{children:"Variant B: 4.2% \xb1 1.5%"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"In which case Autotune would serve A, since 6.3% > 5.7%."}),"\n",(0,i.jsx)(t.p,{children:"Some helpful references:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://arxiv.org/pdf/1003.0146",children:"LinUCB Approach (Li, Chu, Langford, Schapire)"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://courses.cs.washington.edu/courses/cse599i/18wi/resources/lecture10/lecture10.pdf",children:"UW Lecture Series (Jain)"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://proceedings.mlr.press/v206/mehta23a/mehta23a.pdf",children:"Thresholded Linear Bandits"})}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"feature-types",children:"Feature Types"}),"\n",(0,i.jsx)(t.p,{children:"Autotune AI works with categorical and numerical features. Whatever key-value pairs attached to the custom object on the Statsig user will be converted into categorical/numerical features based on their data type. Categorical features will generally be one-hot-encoded."}),"\n",(0,i.jsx)(t.p,{children:"This means that you don't need to build complex training pipelines - whatever features you use for model evaluation will also be used for training."}),"\n",(0,i.jsx)(t.h2,{id:"outcome-types",children:"Outcome Types"}),"\n",(0,i.jsx)(t.p,{children:"Autotune AI has a few different model types under the hood - this means it can be used for both classification use cases (will this user click a button) and for continuous outcomes (how much time will the user spend reading articles)."}),"\n",(0,i.jsx)(t.p,{children:"These models follow the approach described best by the LinUCB family of algorithm - normalizing data and creating a linear model to estimate an outcome, and applying the model uncertainty to score an upper bound."}),"\n",(0,i.jsx)(t.p,{children:"For classification cases, Autotune AI will identify if any outcome occurs within its attribution window. For continuous cases, Autotune AI requires an event name and field name, and will use the numerical value associated with that field on the first observed event after exposure."}),"\n",(0,i.jsx)(t.h2,{id:"advantages",children:"Advantages"}),"\n",(0,i.jsx)(t.p,{children:'The major advantage of a contextual bandit is its ability to optimize based on user attributes. This allows you to deeply optimize product and marketing outcomes beyond picking a single "best experiment". Contextual Bandits can also function with very little training data, and are re-trained hourly, meaning you have a functional personalization tool running within hours after launching your bandit.'}),"\n",(0,i.jsx)(t.p,{children:"For example:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Increasing Outcomes: If you're offering discount promotions as a user is checking out to increase completion rates, based on the total value of a user's cart, the user's spending history, and the user's country code they might respond differently to a \"10% off\" coupon vs. a \"Free shipping\" coupon"}),"\n",(0,i.jsx)(t.li,{children:"Avoiding Harm: If you want to show an upsell for referral codes to users, but don't want to burn users who won't share, Autotune AI can help you optimize for showing the unit to users with a high likelihood to copy the referral link and avoid showing the unit to users who will just dismiss it."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"disadvantages",children:"Disadvantages"}),"\n",(0,i.jsx)(t.p,{children:"The major disadvantages of a Contextual Bandit as compared to a Multi-armed bandit is the lack of convergence, as well as the potential for over-fitting to training data. We utilize regression formats (ridge, normalized logistic regressions, and others) which deliberately omit predictors with low signal and are turned avoid overfitting."}),"\n",(0,i.jsx)(t.p,{children:"Additionally, contextual bandit models may not capture complex interactions between features that a more complex model (a well-tuned GBDT or neural network) may be able to exploit. Contextual bandits are a powerful personalization tool, but won't outperform a dedicated ML team."}),"\n",(0,i.jsx)(t.h2,{id:"methodology-and-notes",children:"Methodology and Notes"}),"\n",(0,i.jsx)(t.h3,{id:"samples-required",children:"Samples Required"}),"\n",(0,i.jsx)(t.p,{children:"Contextual Bandits can start personalizing with extremely minimal traffic (10s of samples). However, your initial traffic will be mostly used for exploration."}),"\n",(0,i.jsx)(t.h3,{id:"attribution",children:"Attribution"}),"\n",(0,i.jsx)(t.p,{children:"Attribution is done by joining the target event to downstream events within the attribution window. The first event observed, by logging timestamp, is the one used for metadata in metadata-based contextual bandits. For binary bandits (did an event happen), the flag is 1/0 for if there are more than 0 events during the attribution window."}),"\n",(0,i.jsx)(t.p,{children:"If running multiple bandits, there's currently no attribution logic; if n bandits share the same outcome event in their attribution window, all bandits would consider that event as part of their outcome space."}),"\n",(0,i.jsx)(t.h3,{id:"exploration",children:"Exploration"}),"\n",(0,i.jsx)(t.p,{children:'During the explore period, all units will be assigned a random variant. Afterwards, a small portion of traffic will still be sent a managed "Explore"/Random variant in order to keep the model from becoming stale. This decreases to a terminal 1% based on timeline and samples observed. The explore traffic is distributed inversely to the current distribution, so "rare" variants are up-sampled - this does generally mean underperforming variants are over-represented in explore to give them a chance.'}),"\n",(0,i.jsxs)(t.p,{children:["Exploration explores can be seem in the log stream, with ",":explore"," appended."]})]})}function c(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>r});var i=n(96540);const a={},o=i.createContext(a);function s(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);