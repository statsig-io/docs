"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[57350],{47371:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>d});var r=n(74848),o=n(28453),s=n(11470),i=n(19365);const l={title:"Getting Started with OTEL + Statsig",tags:["Statsig Cloud"],sidebar_label:"Getting Started",slug:"/infra-analytics/getting-started",keywords:["owner:scott"],last_update:{date:new Date("2025-10-01T00:00:00.000Z")}},a="Getting Started with OTEL + Statsig",c={id:"infra-analytics/getting-started",title:"Getting Started with OTEL + Statsig",description:"This guide helps you setup and send OpenTelemetry telemetry to Statsig so you can use Infra Analytics (Logs Explorer, Metrics Explorer, Alerts).",source:"@site/docs/infra-analytics/getting-started.mdx",sourceDirName:"infra-analytics",slug:"/infra-analytics/getting-started",permalink:"/infra-analytics/getting-started",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/infra-analytics/getting-started.mdx",tags:[{inline:!0,label:"Statsig Cloud",permalink:"/tags/statsig-cloud"}],version:"current",lastUpdatedAt:17592768e5,frontMatter:{title:"Getting Started with OTEL + Statsig",tags:["Statsig Cloud"],sidebar_label:"Getting Started",slug:"/infra-analytics/getting-started",keywords:["owner:scott"],last_update:{date:"2025-10-01T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"Overview",permalink:"/infra-analytics/overview"},next:{title:"Logs Explorer",permalink:"/infra-analytics/logs-explorer"}},p={},d=[{value:"Application Telemetry quick starts",id:"application-telemetry-quick-starts",level:2},{value:"Using Vercel + Statsig integration",id:"using-vercel--statsig-integration",level:3},{value:"Collector quick starts",id:"collector-quick-starts",level:2},{value:"Common Collector Configs (K8s &amp; Docker)",id:"common-collector-configs-k8s--docker",level:2},{value:"A. File logs (filelog receiver)",id:"a-file-logs-filelog-receiver",level:3},{value:"B. EC2 resource detection (resourcedetection processor)",id:"b-ec2-resource-detection-resourcedetection-processor",level:3},{value:"C. Docker container metrics (docker_stats receiver)",id:"c-docker-container-metrics-docker_stats-receiver",level:3},{value:"Resources",id:"resources",level:2}];function u(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",span:"span",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"getting-started-with-otel--statsig",children:"Getting Started with OTEL + Statsig"})}),"\n",(0,r.jsx)(t.p,{children:"This guide helps you setup and send OpenTelemetry telemetry to Statsig so you can use Infra Analytics (Logs Explorer, Metrics Explorer, Alerts)."}),"\n",(0,r.jsx)(t.p,{children:"There are two common paths:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Kubernetes/OpenTelemetry Collector: scrape logs and metrics from your cluster and export to Statsig. See ",(0,r.jsx)(t.a,{href:"/server/concepts/open_telemetry",children:"Open Telemetry Logs and Metrics"})," for a more complete guide."]}),"\n",(0,r.jsx)(t.li,{children:"Applications: export traces, metrics, and logs directly from your app over OTLP/HTTP to Statsig or to your collector. See the quick starts below."}),"\n"]}),"\n",(0,r.jsx)(t.admonition,{title:"Endpoint & Auth",type:"info",children:(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Endpoint: ",(0,r.jsx)(t.code,{children:"https://api.statsig.com/otlp"})]}),"\n",(0,r.jsxs)(t.li,{children:["Auth header: ",(0,r.jsx)(t.code,{children:"statsig-api-key: <your Server SDK Secret key>"})]}),"\n"]})}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"application-telemetry-quick-starts",children:"Application Telemetry quick starts"}),"\n",(0,r.jsxs)(s.A,{groupId:"infra-otel-apps",defaultValue:"node",values:[{label:(0,r.jsxs)(t.span,{children:[(0,r.jsx)(t.img,{src:"/img/sdk/sdk_node.png",alt:"Node.js",style:{height:"16px",marginRight:"8px",verticalAlign:"middle"}}),"Node.js"]}),value:"node"},{label:(0,r.jsxs)(t.span,{children:[(0,r.jsx)(t.img,{src:"/img/sdk/sdk_nextjs.svg",alt:"Next.js",style:{height:"16px",marginRight:"8px",verticalAlign:"middle"}}),"Next.js"]}),value:"nextjs"},{label:(0,r.jsx)(t.span,{children:"Other Languages/Frameworks"}),value:"other"}],children:[(0,r.jsxs)(i.A,{value:"node",children:[(0,r.jsx)(t.p,{children:"Install dependencies:"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"npm install --save \\\n  @opentelemetry/sdk-node \\\n  @opentelemetry/auto-instrumentations-node \\\n  @opentelemetry/exporter-trace-otlp-http \\\n  @opentelemetry/exporter-metrics-otlp-http \\\n  @opentelemetry/api-logs \\\n  @opentelemetry/sdk-logs \\\n  @opentelemetry/exporter-logs-otlp-http \\\n  @opentelemetry/resources \\\n  @opentelemetry/semantic-conventions\n"})}),(0,r.jsxs)(t.p,{children:["Initialize OpenTelemetry (e.g., ",(0,r.jsx)(t.code,{children:"instrumentation.js"}),"):"]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"// instrumentation.js\nconst { NodeSDK } = require('@opentelemetry/sdk-node');\nconst { resourceFromAttributes } = require('@opentelemetry/resources');\nconst { ATTR_SERVICE_NAME, ATTR_SERVICE_VERSION } = require('@opentelemetry/semantic-conventions');\n\n// import if you want to enable traces\nconst { OTLPTraceExporter } = require('@opentelemetry/exporter-trace-otlp-http');\nconst { OTLPMetricExporter } = require('@opentelemetry/exporter-metrics-otlp-http');\nconst { PeriodicExportingMetricReader } = require('@opentelemetry/sdk-metrics');\nconst { getNodeAutoInstrumentations } = require('@opentelemetry/auto-instrumentations-node');\n\n// For troubleshooting, set the log level to DiagLogLevel.DEBUG\n// const { diag, DiagConsoleLogger, DiagLogLevel } = require('@opentelemetry/api');\n// diag.setLogger(new DiagConsoleLogger(), DiagLogLevel.DEBUG);\n\nconst statsigKey = process.env.STATSIG_SERVER_SDK_SECRET;\nconst headers = { 'statsig-api-key': statsigKey ?? '' };\n\nconst sdk = new NodeSDK({\n  resource: resourceFromAttributes({\n    [ATTR_SERVICE_NAME]: process.env.OTEL_SERVICE_NAME || 'statsig-node-service',\n    [ATTR_SERVICE_VERSION]: process.env.VERSION || '1',\n    env: process.env.NODE_ENV || 'development',\n  }),\n  // Optional: enable traces if you want to try out tracing\n  // traceExporter: new OTLPTraceExporter({\n  //  url: 'https://api.statsig.com/otlp/v1/traces',\n  //  headers,\n  // }),\n  metricReader: new PeriodicExportingMetricReader({\n    exporter: new OTLPMetricExporter({\n      url: 'https://api.statsig.com/otlp/v1/metrics',\n      // or\n      // url: <your-collector-endpoint>/v1/metrics\n      headers,\n    }),\n    exportIntervalMillis: 60000,\n  }),\n  instrumentations: [getNodeAutoInstrumentations()],\n});\n\nsdk.start();\n\n"})}),(0,r.jsxs)(t.p,{children:["To set up application logs with OTel, you can use the pino or winston bridges. The example below using ",(0,r.jsx)(t.a,{href:"https://getpino.io/#/",children:"Pino"})," with\n",(0,r.jsx)(t.a,{href:"https://www.npmjs.com/package/@opentelemetry/instrumentation-pino",children:"Pino auto instrumentation"}),"."]}),(0,r.jsx)(t.p,{children:"Install the pino instrumentation:"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"npm i pino @opentelemetry/instrumentation-pino\n"})}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"// instrumentation.js (continued)\nconst { BatchLogRecordProcessor } = require('@opentelemetry/sdk-logs');\n\nconst statsigKey = process.env.STATSIG_SERVER_SDK_SECRET;\nconst headers = { 'statsig-api-key': statsigKey ?? '' };\n\nconst sdk = new NodeSDK({\n  // ... other config ...\n  logRecordProcessors: [\n    new BatchLogRecordProcessor(\n      new OTLPLogExporter({\n        url: 'https://api.statsig.com/otlp/v1/logs',\n        // or\n        // url: <your-collector-endpoint>/v1/logs\n        headers\n      })\n    ),\n  ],\n  instrumentations: [getNodeAutoInstrumentations(), new PinoInstrumentation()],\n});\n\n\n// in your application code, e.g., app.js\nconst pino = require('pino');\n\nconst logger = pino();\n\nlogger.info('OTel logs initialized');\n"})}),(0,r.jsx)(t.p,{children:"The Statsig SDK also supports forwarding logs to Log Explorer; see the alternative logging example below."}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"// Requires: npm i @statsig/statsig-node-core\nconst { Statsig, StatsigUser } = require('@statsig/statsig-node-core');\n\nconst s = new Statsig(process.env.STATSIG_SERVER_SDK_SECRET);\nawait s.initialize();\n\nconst user = new StatsigUser({\n  userID: 'a-user',\n  custom: { service: process.env.OTEL_SERVICE_NAME || 'my-node-service' },\n});\n\n// levels: trace, debug, info, log, warn, error\ns.forwardLogLineEvent(user, 'info', 'service started', { version: process.env.npm_package_version });\n\n try {\n   // your app code\n } catch (err) {\n   s.forwardLogLineEvent(user, 'error', 'unhandled error', {\n     message: String(err?.message || err),\n     stack: err?.stack,\n   });\n }\n\n"})}),(0,r.jsx)(t.p,{children:"Run your service:"}),(0,r.jsxs)(t.p,{children:["make sure that you require or import ",(0,r.jsx)(t.code,{children:"instrumentation.js"})," before any other application code to ensure instrumentation is set up correctly."]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"STATSIG_SERVER_SDK_SECRET=YOUR_SECRET \\\nOTEL_SERVICE_NAME=my-node-service \\\nnode -r ./instrumentation.js app.js\n"})}),(0,r.jsx)(t.p,{children:"Tip: you can configure exporters via env instead of code:"}),(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.code,{children:"OTEL_EXPORTER_OTLP_ENDPOINT=https://api.statsig.com/otlp"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.code,{children:"OTEL_EXPORTER_OTLP_HEADERS=statsig-api-key=${STATSIG_SERVER_SDK_SECRET}"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.code,{children:"OTEL_EXPORTER_OTLP_PROTOCOL=http/json"})}),"\n"]})]}),(0,r.jsxs)(i.A,{value:"nextjs",children:[(0,r.jsxs)(t.p,{children:["You can view the official Next.js OpenTelemetry instructions for ",(0,r.jsx)(t.a,{href:"https://nextjs.org/docs/pages/guides/open-telemetry",children:"pages router here"})," and for ",(0,r.jsx)(t.a,{href:"https://nextjs.org/docs/app/guides/open-telemetry",children:"app router here"})]}),(0,r.jsx)(t.p,{children:"Install dependencies:"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"npm install @opentelemetry/sdk-node @opentelemetry/resources @opentelemetry/semantic-conventions @opentelemetry/sdk-trace-node @opentelemetry/exporter-trace-otlp-http @opentelemetry/auto-instrumentations-node\n"})}),(0,r.jsxs)(t.p,{children:["Add ",(0,r.jsx)(t.code,{children:"instrumentation.ts"})," at the app root (Next 13+):"]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"// instrumentation.ts\nimport { NodeSDK } from '@opentelemetry/sdk-node';\nimport { resourceFromAttributes } from '@opentelemetry/resources';\nimport { ATTR_SERVICE_NAME, ATTR_SERVICE_VERSION } from '@opentelemetry/semantic-conventions';\n\n// For troubleshooting, set the log level to DiagLogLevel.DEBUG\n// const { diag, DiagConsoleLogger, DiagLogLevel } = require('@opentelemetry/api');\n// diag.setLogger(new DiagConsoleLogger(), DiagLogLevel.DEBUG);\n\nexport async function register() {\n  const headers = { 'statsig-api-key': process.env.STATSIG_SERVER_SDK_SECRET ?? '' };\n\n  const sdk = new NodeSDK({\n    resource: new Resource({\n      [ATTR_SERVICE_NAME]: process.env.OTEL_SERVICE_NAME || 'statsig-node-service',\n      [ATTR_SERVICE_VERSION]: process.env.VERSION || '1',\n      env: process.env.NODE_ENV || 'development',\n    }),\n    // Optional: enable traces if you want to try out tracing\n    // traceExporter: new OTLPTraceExporter({\n    //   url: 'https://api.statsig.com/otlp/v1/traces',\n    //  headers,\n    // }),\n    metricReader: new PeriodicExportingMetricReader({\n      exporter: new OTLPMetricExporter({\n        url: 'https://api.statsig.com/otlp/v1/metrics',\n        // or\n        // url: <your-collector-endpoint>/v1/metrics\n        headers,\n      }),\n      exportIntervalMillis: 60000,\n    }),\n    instrumentations: [getNodeAutoInstrumentations()],\n  });\n\n  sdk.start();\n}\n"})}),(0,r.jsxs)(t.p,{children:["To set up application logs with OTel, you can use the pino or winston bridges. The example below using ",(0,r.jsx)(t.a,{href:"https://getpino.io/#/",children:"Pino"})," with\n",(0,r.jsx)(t.a,{href:"https://www.npmjs.com/package/@opentelemetry/instrumentation-pino",children:"Pino auto instrumentation"}),"."]}),(0,r.jsx)(t.p,{children:"Install the pino instrumentation:"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"npm i pino @opentelemetry/instrumentation-pino\n"})}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"// instrumentation.ts (continued)\nimport { BatchLogRecordProcessor } from '@opentelemetry/sdk-logs';\n\nconst statsigKey = process.env.STATSIG_SERVER_SDK_SECRET;\nconst headers = { 'statsig-api-key': statsigKey ?? '' };\n\nconst sdk = new NodeSDK({\n  // ... other config ...\n  logRecordProcessors: [\n    new BatchLogRecordProcessor(\n      new OTLPLogExporter({\n        url: 'https://api.statsig.com/otlp/v1/logs',\n        // or\n        // url: <your-collector-endpoint>/v1/logs\n        headers\n      })\n    ),\n  ],\n  instrumentations: [getNodeAutoInstrumentations(), new PinoInstrumentation()],\n});\n\n\n// in your application code, e.g., app.ts\nimport pino from 'pino';\n\nconst logger = pino();\n\nlogger.info('OTel logs initialized');\n"})}),(0,r.jsx)(t.p,{children:"The Statsig SDK also supports forwarding logs to Log Explorer; see the alternative logging example below."}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",children:"// Requires: npm i @statsig/statsig-node-core\nimport { Statsig, StatsigUser } from '@statsig/statsig-node-core';\n\nconst s = new Statsig(process.env.STATSIG_SERVER_SDK_SECRET);\nawait s.initialize();\n\nconst user = new StatsigUser({\n  userID: 'a-user',\n  custom: { service: process.env.OTEL_SERVICE_NAME || 'my-node-service' },\n});\n\n// levels: trace, debug, info, log, warn, error\ns.forwardLogLineEvent(user, 'info', 'service started', { version: process.env.npm_package_version });\n\n try {\n   // your app code\n } catch (err) {\n   s.forwardLogLineEvent(user, 'error', 'unhandled error', {\n     message: String(err?.message || err),\n     stack: err?.stack,\n   });\n }\n"})}),(0,r.jsxs)(t.p,{children:["Note: In Next.js, mark '@statsig/statsig-node-core' as a server external package in ",(0,r.jsx)(t.code,{children:"next.config.js"})," to avoid bundling."]}),(0,r.jsx)(t.h3,{id:"using-vercel--statsig-integration",children:"Using Vercel + Statsig integration"}),(0,r.jsxs)(t.p,{children:["If you're deploying to Vercel, you can use the Statsig + Vercel integration to automatically forward logs from Vercel to Statsig. See ",(0,r.jsx)(t.a,{href:"https://docs.statsig.com/integrations/vercel/",children:"Vercel + Statsig"}),"."]}),(0,r.jsx)(t.p,{children:"Notes"}),(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Keep ",(0,r.jsx)(t.code,{children:"STATSIG_SERVER_SDK_SECRET"})," out of client bundles (do not use ",(0,r.jsx)(t.code,{children:"NEXT_PUBLIC_"}),")."]}),"\n",(0,r.jsx)(t.li,{children:"Client/browser tracing requires separate web tracer setup; do not send secrets client-side. Consider routing via a Collector."}),"\n"]})]}),(0,r.jsxs)(i.A,{value:"other",children:[(0,r.jsx)(t.p,{children:"Sending OTLP data directly to statsig without a collector is only supported for Node.js applications at this time. For other languages and frameworks, you can send OTLP data to a collector and have the collector forward the data to Statsig."}),(0,r.jsxs)(t.p,{children:["See the ",(0,r.jsx)(t.a,{href:"#collector-quick-starts",children:"Collector quick starts"})," below for example configurations. And see the ",(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/languages/",children:"OpenTelemetry Language APIs & SDKs documentation"})," for installation and configuration instructions for other languages and frameworks."]})]})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"collector-quick-starts",children:"Collector quick starts"}),"\n",(0,r.jsx)(t.p,{children:"Running a Collector is optional but recommended for production workloads."}),"\n",(0,r.jsx)(t.p,{children:"Use the OpenTelemetry Collector as a gateway to receive OTLP from your applications and forward to Statsig.\nThis is useful if you want to centralize telemetry collection, add advanced sampling methods like tail-based sampling, or scrape logs/metrics from hosts or Kubernetes."}),"\n",(0,r.jsxs)(s.A,{groupId:"infra-otel-collector",defaultValue:"k8s",values:[{label:"Kubernetes (Helm)",value:"k8s"},{label:"Docker (Compose)",value:"docker"},{label:"Other",value:"other"}],children:[(0,r.jsxs)(i.A,{value:"k8s",children:[(0,r.jsxs)(t.p,{children:["Create a minimal ",(0,r.jsx)(t.code,{children:"values.yaml"})," for the OpenTelemetry Collector that forwards all signals (traces, metrics, logs) to Statsig:"]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",metastring:'title="values.yaml"',children:"config:\n  receivers:\n    otlp:\n      protocols:\n        http:\n        grpc:\n\n  processors:\n    batch: {}\n\n  exporters:\n    otlphttp:\n      endpoint: https://api.statsig.com/otlp\n      encoding:  json\n      headers:\n        statsig-api-key: ${env:STATSIG_SERVER_SDK_SECRET}\n\n  service:\n    pipelines:\n      traces:\n        receivers: [otlp]\n        processors: [batch]\n        exporters: [otlphttp]\n      metrics:\n        receivers: [otlp]\n        processors: [batch]\n        exporters: [otlphttp]\n      logs:\n        receivers: [otlp]\n        processors: [batch]\n        exporters: [otlphttp]\n"})}),(0,r.jsx)(t.p,{children:"Install the Collector with Helm:"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"helm repo add open-telemetry https://open-telemetry.github.io/opentelemetry-helm-charts\nhelm repo update\nhelm install otel-gateway open-telemetry/opentelemetry-collector \\\n  -n otel --create-namespace \\\n  -f values.yaml\n"})}),(0,r.jsxs)(t.p,{children:["Provide the Statsig key as an environment variable to the Collector pods (for example via a Secret and envFrom). Your applications then send OTLP to the in-cluster Collector endpoint (for example ",(0,r.jsx)(t.code,{children:"http://otel-gateway-collector.otel.svc.cluster.local:4318"}),")."]}),(0,r.jsxs)(t.p,{children:["For a production setup that also scrapes Kubernetes logs/metrics, see the full guide: ",(0,r.jsx)(t.a,{href:"/server/concepts/open_telemetry",children:"Open Telemetry Logs and Metrics"}),"."]}),(0,r.jsx)(t.admonition,{title:"Version requirement",type:"note",children:(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"encoding: json"})," option in the OTLP HTTP exporter requires Collector v0.95.0 or newer. If you pin the image via Helm values, set ",(0,r.jsx)(t.code,{children:'image.tag: "0.95.0"'})," (or newer)."]})})]}),(0,r.jsxs)(i.A,{value:"docker",children:[(0,r.jsx)(t.p,{children:"Use Docker Compose to run a Collector gateway that accepts OTLP and forwards to Statsig."}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",metastring:'title="docker-compose.yaml"',children:'services:\n  otel-collector:\n    image: otel/opentelemetry-collector-contrib:latest\n    command: ["--config=/etc/otel-collector-config.yaml"]\n    environment:\n      - STATSIG_SERVER_SDK_SECRET=${STATSIG_SERVER_SDK_SECRET}\n    volumes:\n      - ./otel-collector-config.yaml:/etc/otelcol-contrib/config.yaml\n    ports:\n      - "4317:4317"   # OTLP gRPC\n      - "4318:4318"   # OTLP HTTP\n'})}),(0,r.jsx)(t.p,{children:"Create the Collector config referenced above:"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",metastring:'title="otel-collector-config.yaml"',children:"receivers:\n  otlp:\n    protocols:\n      http:\n      grpc:\n\nprocessors:\n  batch: {}\n\nexporters:\n  otlphttp:\n    endpoint: https://api.statsig.com/otlp\n    encoding:  json\n    headers:\n      statsig-api-key: ${env:STATSIG_SERVER_SDK_SECRET}\n\nservice:\n  pipelines:\n    traces:\n      receivers: [otlp]\n      processors: [batch]\n      exporters: [otlphttp]\n    metrics:\n      receivers: [otlp]\n      processors: [batch]\n      exporters: [otlphttp]\n    logs:\n      receivers: [otlp]\n      processors: [batch]\n      exporters: [otlphttp]\n"})}),(0,r.jsx)(t.p,{children:"Start the Collector:"}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"export STATSIG_SERVER_SDK_SECRET=YOUR_SECRET\ndocker compose up -d\n"})}),(0,r.jsxs)(t.p,{children:["Point your applications at the Collector (HTTP): ",(0,r.jsx)(t.code,{children:"http://localhost:4318"})," (or ",(0,r.jsx)(t.code,{children:"http://otel-collector:4318"})," from other compose services). The Collector forwards to Statsig with your key."]})]}),(0,r.jsxs)(i.A,{value:"other",children:[(0,r.jsxs)(t.p,{children:["You can run the Collector in other environments (VMs, bare metal, etc) using the config below. See the ",(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/collector/installation/",children:"Collector documentation"})," for other installation and deployment methods."]}),(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",metastring:'title="otel-collector-config.yaml"',children:"exporters:\n  otlphttp:\n    endpoint: https://api.statsig.com/otlp\n    encoding: json\n    headers:\n      statsig-api-key: ${env:STATSIG_SERVER_SDK_SECRET}\n"})})]})]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"common-collector-configs-k8s--docker",children:"Common Collector Configs (K8s & Docker)"}),"\n",(0,r.jsxs)(t.p,{children:["The following examples show popular receivers/processors you can enable in your Collector and still export to Statsig via the same ",(0,r.jsx)(t.code,{children:"otlphttp"})," exporter."]}),"\n",(0,r.jsx)(t.p,{children:"Note: These components live in the contrib distribution. Use an image that includes them:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["Docker: ",(0,r.jsx)(t.code,{children:"otel/opentelemetry-collector-contrib"})," or newer"]}),"\n",(0,r.jsxs)(t.li,{children:["Helm: set ",(0,r.jsx)(t.code,{children:"image.repository: otel/opentelemetry-collector-contrib"})," (and a compatible ",(0,r.jsx)(t.code,{children:"image.tag"}),")"]}),"\n"]}),"\n",(0,r.jsx)(t.p,{children:"Helm values (contrib image):"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",metastring:'title="values.yaml"',children:'image:\n  repository: otel/opentelemetry-collector-contrib\n  tag: "latest"\n  pullPolicy: IfNotPresent\n'})}),"\n",(0,r.jsx)(t.h3,{id:"a-file-logs-filelog-receiver",children:"A. File logs (filelog receiver)"}),"\n",(0,r.jsx)(t.p,{children:"Reads and parses logs from files on disk. Useful for hosts, containers, or Kubernetes nodes."}),"\n",(0,r.jsx)(t.p,{children:"Minimal example:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"receivers:\n  filelog:\n    include: [ /var/log/myservice/*.json ]\n    start_at: beginning\n    operators:\n      - type: json_parser\n        timestamp:\n          parse_from: attributes.time\n          layout: '%Y-%m-%dT%H:%M:%S%z'\n\nprocessors:\n  batch: {}\n\nexporters:\n  otlphttp:\n    endpoint: https://api.statsig.com/otlp\n    encoding: json\n    headers:\n      statsig-api-key: ${env:STATSIG_SERVER_SDK_SECRET}\n\nservice:\n  pipelines:\n    logs:\n      receivers: [filelog]\n      processors: [batch]\n      exporters: [otlphttp]\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Kubernetes tip: to tail container logs on nodes, mount host paths (e.g., ",(0,r.jsx)(t.code,{children:"/var/log/pods"})," and ",(0,r.jsx)(t.code,{children:"/var/lib/docker/containers"}),") into the Collector DaemonSet and set ",(0,r.jsx)(t.code,{children:"include"})," to those paths."]}),"\n",(0,r.jsx)(t.h3,{id:"b-ec2-resource-detection-resourcedetection-processor",children:"B. EC2 resource detection (resourcedetection processor)"}),"\n",(0,r.jsx)(t.p,{children:"Automatically adds AWS EC2 metadata (cloud provider, region/zone, instance id) to your telemetry."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"processors:\n  resourcedetection/ec2:\n    detectors: [env, ec2]\n    timeout: 2s\n    override: false\n\nservice:\n  pipelines:\n    traces:\n      receivers: [otlp]\n      processors: [resourcedetection/ec2, batch]\n      exporters: [otlphttp]\n    metrics:\n      receivers: [otlp]\n      processors: [resourcedetection/ec2, batch]\n      exporters: [otlphttp]\n    logs:\n      receivers: [otlp]\n      processors: [resourcedetection/ec2, batch]\n      exporters: [otlphttp]\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Permissions: the Collector must be able to reach the EC2 metadata service (IMDS). Ensure network access to ",(0,r.jsx)(t.code,{children:"169.254.169.254"})," and IMDSv2 where required."]}),"\n",(0,r.jsx)(t.h3,{id:"c-docker-container-metrics-docker_stats-receiver",children:"C. Docker container metrics (docker_stats receiver)"}),"\n",(0,r.jsx)(t.p,{children:"Emits container CPU, memory, network, and block IO metrics by querying the Docker daemon."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"receivers:\n  docker_stats:\n    endpoint: unix:///var/run/docker.sock\n    collection_interval: 15s\n\nprocessors:\n  batch: {}\n\nexporters:\n  otlphttp:\n    endpoint: https://api.statsig.com/otlp\n    encoding: json\n    headers:\n      statsig-api-key: ${env:STATSIG_SERVER_SDK_SECRET}\n\nservice:\n  pipelines:\n    metrics:\n      receivers: [docker_stats]\n      processors: [batch]\n      exporters: [otlphttp]\n"})}),"\n",(0,r.jsx)(t.p,{children:"Requirements:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Linux only (not supported on darwin/windows)."}),"\n",(0,r.jsxs)(t.li,{children:["Mount the Docker socket into the Collector container: ",(0,r.jsx)(t.code,{children:"/var/run/docker.sock"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.hr,{}),"\n",(0,r.jsx)(t.h2,{id:"resources",children:"Resources"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["OpenTelemetry Collector: ",(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/collector/",children:"https://opentelemetry.io/docs/collector/"})]}),"\n",(0,r.jsxs)(t.li,{children:["Kubernetes Collector components: ",(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/platforms/kubernetes/collector/components/",children:"https://opentelemetry.io/docs/platforms/kubernetes/collector/components/"})]}),"\n",(0,r.jsxs)(t.li,{children:["Helm chart: ",(0,r.jsx)(t.a,{href:"https://github.com/open-telemetry/opentelemetry-helm-charts",children:"https://github.com/open-telemetry/opentelemetry-helm-charts"})]}),"\n",(0,r.jsxs)(t.li,{children:["Collector configuration reference: ",(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/collector/configuration",children:"https://opentelemetry.io/docs/collector/configuration"})]}),"\n",(0,r.jsxs)(t.li,{children:["OTLP protocol specification: ",(0,r.jsx)(t.a,{href:"https://opentelemetry.io/docs/specs/otlp/",children:"https://opentelemetry.io/docs/specs/otlp/"})]}),"\n",(0,r.jsxs)(t.li,{children:["Filelog receiver (contrib): ",(0,r.jsx)(t.a,{href:"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/filelogreceiver",children:"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/filelogreceiver"})]}),"\n",(0,r.jsxs)(t.li,{children:["Resource detection processor (contrib): ",(0,r.jsx)(t.a,{href:"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/resourcedetectionprocessor",children:"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/resourcedetectionprocessor"})]}),"\n",(0,r.jsxs)(t.li,{children:["Docker stats receiver (contrib): ",(0,r.jsx)(t.a,{href:"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/dockerstatsreceiver",children:"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/dockerstatsreceiver"})]}),"\n",(0,r.jsxs)(t.li,{children:["Collector contrib distribution: ",(0,r.jsx)(t.a,{href:"https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib",children:"https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib"})]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},19365:(e,t,n)=>{n.d(t,{A:()=>i});n(96540);var r=n(34164);const o={tabItem:"tabItem_Ymn6"};var s=n(74848);function i(e){let{children:t,hidden:n,className:i}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(o.tabItem,i),hidden:n,children:t})}},11470:(e,t,n)=>{n.d(t,{A:()=>S});var r=n(96540),o=n(34164),s=n(23104),i=n(56347),l=n(205),a=n(57485),c=n(31682),p=n(70679);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:n,attributes:r,default:o}}=e;return{value:t,label:n,attributes:r,default:o}}))}(n);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function h(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function g(e){let{queryString:t=!1,groupId:n}=e;const o=(0,i.W6)(),s=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,a.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(o.location.search);t.set(s,e),o.replace({...o.location,search:t.toString()})}),[s,o])]}function m(e){const{defaultValue:t,queryString:n=!1,groupId:o}=e,s=u(e),[i,a]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=n.find((e=>e.default))??n[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:s}))),[c,d]=g({queryString:n,groupId:o}),[m,x]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[o,s]=(0,p.Dv)(n);return[o,(0,r.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:o}),v=(()=>{const e=c??m;return h({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{v&&a(v)}),[v]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);a(e),d(e),x(e)}),[d,x,s]),tabValues:s}}var x=n(92303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=n(74848);function j(e){let{className:t,block:n,selectedValue:r,selectValue:i,tabValues:l}=e;const a=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),p=e=>{const t=e.currentTarget,n=a.indexOf(t),o=l[n].value;o!==r&&(c(t),i(o))},d=e=>{let t=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const n=a.indexOf(e.currentTarget)+1;t=a[n]??a[0];break}case"ArrowLeft":{const n=a.indexOf(e.currentTarget)-1;t=a[n]??a[a.length-1];break}}t?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":n},t),children:l.map((e=>{let{value:t,label:n,attributes:s}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:r===t?0:-1,"aria-selected":r===t,ref:e=>a.push(e),onKeyDown:d,onClick:p,...s,className:(0,o.A)("tabs__item",v.tabItem,s?.className,{"tabs__item--active":r===t}),children:n??t},t)}))})}function f(e){let{lazy:t,children:n,selectedValue:s}=e;const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===s));return e?(0,r.cloneElement)(e,{className:(0,o.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:i.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==s})))})}function E(e){const t=m(e);return(0,y.jsxs)("div",{className:(0,o.A)("tabs-container",v.tabList),children:[(0,y.jsx)(j,{...t,...e}),(0,y.jsx)(f,{...t,...e})]})}function S(e){const t=(0,x.A)();return(0,y.jsx)(E,{...e,children:d(e.children)},String(t))}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>l});var r=n(96540);const o={},s=r.createContext(o);function i(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);