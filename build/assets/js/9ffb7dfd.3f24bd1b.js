"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[18949,63594],{26072:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>g,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var s=t(74848),i=t(28453),o=t(27058);const r={title:"Segment",keywords:["owner:brock"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},a="Segment Overview",c={id:"integrations/data-connectors/segment",title:"Segment",description:"Enabling the Segment integration for Statsig will allow Statsig to pull in your Segment events. This allows you to run your experiment analysis on Statsig with all of your existing events from Segment without requiring any additional logging.",source:"@site/docs/integrations/data-connectors/segment.mdx",sourceDirName:"integrations/data-connectors",slug:"/integrations/data-connectors/segment",permalink:"/integrations/data-connectors/segment",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/integrations/data-connectors/segment.mdx",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{title:"Segment",keywords:["owner:brock"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"RudderStack",permalink:"/integrations/data-connectors/rudderstack"},next:{title:"Stitch",permalink:"/integrations/data-connectors/stitch"}},l={},d=[{value:"Supported Segment Event Types",id:"supported-segment-event-types",level:3},{value:"Benefits of using the Segment integration",id:"benefits-of-using-the-segment-integration",level:3},{value:"Configuring Inbound Events into Statsig",id:"configuring-inbound-events-into-statsig",level:2},{value:"Using OAuth",id:"using-oauth",level:3},{value:"Manual Configuration",id:"manual-configuration",level:3},{value:"Working with Users",id:"working-with-users",level:2},{value:"User IDs and Custom IDs",id:"user-ids-and-custom-ids",level:3},{value:"Anonymous Users",id:"anonymous-users",level:3},{value:"Mapping anonymous users",id:"mapping-anonymous-users",level:4},{value:"Experimenting on anonymous traffic",id:"experimenting-on-anonymous-traffic",level:4},{value:"Example Mapping Flow",id:"example-mapping-flow",level:4},{value:"Syncing Statsig Segment ID Lists with Segment Engage Audiences",id:"syncing-statsig-segment-id-lists-with-segment-engage-audiences",level:3},{value:"Custom Properties",id:"custom-properties",level:3},{value:"Configuring Outbound Events to Segment",id:"configuring-outbound-events-to-segment",level:2},{value:"Outbound event schema",id:"outbound-event-schema",level:3},{value:"Environments",id:"environments",level:2},...o.toc,{value:"Working with Segment Metrics in the Statsig UI",id:"working-with-segment-metrics-in-the-statsig-ui",level:2},{value:"Filtering Events",id:"filtering-events",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"segment-overview",children:"Segment Overview"})}),"\n",(0,s.jsx)(n.p,{children:"Enabling the Segment integration for Statsig will allow Statsig to pull in your Segment events. This allows you to run your experiment analysis on Statsig with all of your existing events from Segment without requiring any additional logging."}),"\n",(0,s.jsxs)(n.p,{children:["When Statsig receives events from Segment, these will be visible and aggregated in the ",(0,s.jsx)(n.a,{href:"/metrics",children:"Metrics"})," tab in the Statsig console. These events will automatically be included in your ",(0,s.jsx)(n.a,{href:"/pulse/read-pulse",children:"Pulse"})," results for A/B tests with Statsig's feature gates as well as all your ",(0,s.jsx)(n.a,{href:"/experiments-plus/monitor",children:"Experiment"})," results."]}),"\n",(0,s.jsx)(n.h3,{id:"supported-segment-event-types",children:"Supported Segment Event Types"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://segment.com/docs/connections/spec/track/",children:"Track"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://segment.com/docs/connections/spec/page/",children:"Page"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://segment.com/docs/connections/spec/group/",children:"Group"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://segment.com/docs/connections/spec/screen/",children:"Screen"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://segment.com/docs/connections/spec/identify/",children:"Identify*"})}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Identify calls are only supported for syncing Segment Engage Audiences with Statsig Segments"})}),"\n",(0,s.jsx)(n.h3,{id:"benefits-of-using-the-segment-integration",children:"Benefits of using the Segment integration"}),"\n",(0,s.jsx)(n.p,{children:"Using the Segment integration has several benefits over other methods of event ingestion:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Customers who are ingesting customer data with Segment will be able to quickly populate Statsig with metrics and can typically get up and running within a day","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Customers will only have to use Statsig's assignment SDKs (gate/experiment allocation), simplifying your code and engineer workflows"}),"\n",(0,s.jsxs)(n.li,{children:["Additional logging can be done via the ",(0,s.jsx)(n.a,{href:"/guides/logging-events#logging-events-via-sdks",children:"event logging SDKs"})," but will and additional code orchestration and a collection window"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["With ",(0,s.jsx)(n.a,{href:"/integrations/event_filtering",children:"event filtering"})," you can control which events are ingested and make billing more predictable"]}),"\n",(0,s.jsxs)(n.li,{children:["If you have ",(0,s.jsx)(n.a,{href:"https://segment.com/docs/guides/what-is-replay/",children:"Segment Replay"}),", you can send Statsig your historical events for analysis"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuring-inbound-events-into-statsig",children:"Configuring Inbound Events into Statsig"}),"\n",(0,s.jsx)(n.p,{children:"To send events collected from Segment into Statsig, you must configure the Statsig Destination within the your Segment account:"}),"\n",(0,s.jsx)(n.h3,{id:"using-oauth",children:"Using OAuth"}),"\n",(0,s.jsx)(n.p,{children:"The easiest way to connect Statsig to Segment is via OAuth."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["To get started, within the Statsig Console, go to ",(0,s.jsx)(n.strong,{children:"project settings \u2192 integrations \u2192 Segment \u2192 Enable"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Click \u201cConfigure Segment OAuth\u201d"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262495276-2fa7d870-0f02-44cf-aa29-9f04b0b12220.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Select the workspace and source that will send data to Statsig. Click \u201cAllow\u201d:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262495274-71e8dbf3-590f-44bf-90bd-5723dd3c60ed.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["After the integration has been enabled, you can configure event filtering and map additional identifiers. This is useful for mapping device level identifiers as well as ",(0,s.jsx)(n.code,{children:"anonymousIds"})," generated from Segment.\nWe recommend creating a custom ID called ",(0,s.jsx)(n.code,{children:"segmentAnonymousId"})," and mapping the ",(0,s.jsx)(n.code,{children:"anonymousId"})," from Segment to it.\n",(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/279802493-6956e8f7-28f1-4ac9-88d1-96710240373b.png",alt:""})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"manual-configuration",children:"Manual Configuration"}),"\n",(0,s.jsx)(n.p,{children:"If you are unable to connect to Segment via OAuth, you can still manually connect Statsig to Segment by configuring"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Within the ",(0,s.jsx)(n.a,{href:"https://app.segment.com",children:"Segment App"}),', navigate to your Destinations, and select "',(0,s.jsx)(n.strong,{children:"Add Destination"}),'"']}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Search for \u201c",(0,s.jsx)(n.strong,{children:"Statsig"}),"\u201d and select the destination"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262495271-68b0959b-b1d8-4041-a413-e0b2c3802377.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:['Select "Statsig" from the list of available integrations, and then select ',(0,s.jsx)(n.strong,{children:"sources"})," that will send data to Statsig.\n",(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262495270-832e8d93-1896-4c24-bf42-c56f627eecbc.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["You must provide a Statsig Server SDK key. You can copy an existing server key or create a new one from the ",(0,s.jsx)(n.a,{href:"https://console.statsig.com/api_keys",children:"Statsig console settings"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Create or copy a server SDK key"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262495269-88b47af6-7313-47e9-a767-e1eb12b4e47b.png",alt:""}),"\n",(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262504950-c5b21cc0-5b51-4a55-997a-74b8a45b2807.png",alt:""})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Put your Server Secret Key in the \u201cAPI Key\u201d field in the Statsig Destination"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262506044-77bef6e4-c79d-47b2-94cc-3f6b3dc06489.png",alt:""})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In order to set up mappings you must enable the Segment Integration on the Statsig . Go to the Statsig Console > Project Settings > Integrations Tab > Segment > Click ",(0,s.jsx)(n.strong,{children:"Enable"}),":\n",(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262506930-12225ae2-a12e-4b0d-9efc-34c03a840f9f.png",alt:""})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["After the integration has been enabled, you can configure event filtering and map additional identifiers. This is useful for mapping device level identifiers as well as ",(0,s.jsx)(n.code,{children:"anonymousIds"})," generated from Segment.\n",(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/279802493-6956e8f7-28f1-4ac9-88d1-96710240373b.png",alt:""})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Now we can verify that events are being properly sent to Statsig using the ",(0,s.jsx)(n.a,{href:"https://segment.com/docs/connections/test-connections/",children:"Segment Event Tester"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"In the event tester, send a test event that can verify any filtering and/or mapping you have set up:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262495256-5097e8a0-ca4f-4e1a-b2b6-3337d6fe7bff.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the your ",(0,s.jsx)(n.a,{href:"https://console.statsig.com/metrics/events",children:"Statsig Console Events Explorer"}),", click on the test event in the log stream and verify the event:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/262501895-001d1179-510a-4171-9ab9-f14544c94374.png",alt:""})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Note: In this example the ",(0,s.jsx)(n.code,{children:"anonymousId"})," is mapped to Statsig\u2019s ",(0,s.jsx)(n.code,{children:"segmentAnonymousId"})," based on the above mapping. The User ID is inferred from the Segment ",(0,s.jsx)(n.code,{children:"userID"})," field"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/279802493-6956e8f7-28f1-4ac9-88d1-96710240373b.png",alt:""})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["As your Segment events flow into Statsig, you'll see a live ",(0,s.jsx)(n.strong,{children:"Log Stream"})," in the ",(0,s.jsx)(n.a,{href:"/metrics",children:"Metrics"})," tab in the Statsig console. You can click one of these events to see the details that are logged as part of the event.\n",(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/1315028/150830169-17564060-816b-4c5c-ade9-10bf6274265a.png",alt:""})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"working-with-users",children:"Working with Users"}),"\n",(0,s.jsxs)(n.p,{children:["Statsig will join incoming user identifiers to whichever ",(0,s.jsx)(n.a,{href:"/experiments-plus#choosing-the-right-randomization-unit",children:"unit of randomization"})," you choose. This allows you to be flexible with your experimentation and enables testing on known (userID) and unknown (anonymousID) traffic as well as any custom identifiers your team may have (deviceID, companyID, vehicleID, etc)."]}),"\n",(0,s.jsx)(n.h3,{id:"user-ids-and-custom-ids",children:"User IDs and Custom IDs"}),"\n",(0,s.jsxs)(n.p,{children:["Statsig automatically detects the ",(0,s.jsx)(n.code,{children:"event"})," and ",(0,s.jsx)(n.code,{children:"userId"})," fields that are logged through your Segment events (see ",(0,s.jsx)(n.a,{href:"https://segment.com/docs/connections/spec/track/",children:(0,s.jsx)(n.code,{children:"track"})})," for an example). If you're running an experiment with the userId as your unit type, this ",(0,s.jsx)(n.code,{children:"userID"})," should match the user identifier that you log with the Statsig SDK."]}),"\n",(0,s.jsxs)(n.p,{children:["If you're using a ",(0,s.jsx)(n.a,{href:"/guides/experiment-on-custom-id-types",children:"custom ID"})," as the unit type for your experiment, you can provide this identifier using the key ",(0,s.jsx)(n.code,{children:"statsigCustomIDs"})," as part of the Segment ",(0,s.jsx)(n.code,{children:"properties"})," field as shown below."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",metastring:'title="JSON Body"',children:'{\n  ...\n  properties: {\n    "statsigCustomIDs": [ "companyID", "<this_company_id>"]\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"statsigCustomIDs"})," field in properties should be an array, where the even index is the name of the user ID type and the odd index is the value of the previous element in the array. Assuming you've created this custom ID type on Statsig (under ",(0,s.jsx)(n.strong,{children:"ID Type Settings"})," in your ",(0,s.jsx)(n.a,{href:"https://console.statsig.com/settings",children:"Project Settings"}),"), Statsig will automatically recognize these custom identifiers to compute your experiment results appropriately."]}),"\n",(0,s.jsx)(n.h3,{id:"anonymous-users",children:"Anonymous Users"}),"\n",(0,s.jsx)(n.h4,{id:"mapping-anonymous-users",children:"Mapping anonymous users"}),"\n",(0,s.jsxs)(n.p,{children:['The Segment integration also allows the mapping of top level fields to custom IDs you define in Statsig. To do this, visit the Segment panel on the Statsig Integrations page and look for the "Map Identifier" section. Here you can choose fields you would like mapped to a ',(0,s.jsx)(n.a,{href:"/guides/experiment-on-custom-id-types",children:"Custom ID"}),".\nThis is particularly useful for working with the ",(0,s.jsx)(n.a,{href:"https://segment.com/docs/connections/sources/catalog/libraries/website/javascript/identity/#anonymous-ids",children:"Segment anonymous ID"}),", which is passed as an event field ",(0,s.jsx)(n.code,{children:"anonymousId"}),". By defining a custom ID called ",(0,s.jsx)(n.code,{children:"segmentAnonymousId"}),", Statsig can easily map your anonymous Segment traffic to your metric data."]}),"\n",(0,s.jsxs)(n.p,{children:["\u26a0\ufe0f"," ",(0,s.jsx)(n.strong,{children:"Warning:"})," values passed in ",(0,s.jsx)(n.code,{children:"properties.statsigCustomIDs"})," will take precedence over mapped identifiers below:"]}),"\n",(0,s.jsx)("img",{src:"https://user-images.githubusercontent.com/125311112/279802493-6956e8f7-28f1-4ac9-88d1-96710240373b.png"}),"\n",(0,s.jsx)(n.h4,{id:"experimenting-on-anonymous-traffic",children:"Experimenting on anonymous traffic"}),"\n",(0,s.jsxs)(n.p,{children:["For example, if you're running experiments on anonymous users, you can use Segment's ",(0,s.jsx)(n.code,{children:"anonymousId"})," as the unit of randomization. First, you will want to ",(0,s.jsx)(n.a,{href:"/guides/experiment-on-custom-id-types#step-1---add-companyid-as-a-new-id-type-in-your-project-settings",children:"add a new customer identifier to Statsig"}),". In the above example, we call our new custom ID ",(0,s.jsx)(n.code,{children:"segmentAnonymousId"}),". Then, when ",(0,s.jsx)(n.a,{href:"/client/javascript-sdk",children:"initializing"})," the Statsig SDK, if you have access to the Segment ",(0,s.jsx)(n.code,{children:"anonymousId"})," you will want to pass it to Statsig as a custom ID. For example, your Statsig initialization may look like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'import { StatsigClient } from \'@statsig/js-client\';\n\nawait Statsig.initialize(\n  "client-sdk-key",\n  \n);\nconst client = new StatsigClient(sdkKey,\n  {\n    userID: "some_user_id",\n    customIDs: {\n      segmentAnonymousId: analytics.user().anonymousId()\n    }\n  },\n  { environment: { tier: "production" } }\n);\n\n'})}),"\n",(0,s.jsxs)(n.p,{children:["You can access Segment's ",(0,s.jsx)(n.code,{children:"anonymousId"})," using ",(0,s.jsx)(n.code,{children:"analytics.user().anonymousId()"})," as ",(0,s.jsx)(n.a,{href:"https://segment.com/docs/connections/sources/catalog/libraries/website/javascript/identity/",children:"outlined in the Segment docs here"}),"."]}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.mdxAdmonitionTitle,{}),(0,s.jsxs)(n.p,{children:["It's important to note, that the Segment SDK may initialize after Statsig SDK, and the ",(0,s.jsx)(n.code,{children:"anonymousId"})," may not be available in that scenario. It's important to check this in your specific implementation. If you're using vanilla javascript, you may want to wait for the ",(0,s.jsx)(n.code,{children:"anonymousId"})," from the Segment SDK after initialization and call the ",(0,s.jsx)(n.code,{children:"updateUser()"})," method on the Statsig SDK to update this ID."]})]}),"\n",(0,s.jsx)(n.h4,{id:"example-mapping-flow",children:"Example Mapping Flow"}),"\n",(0,s.jsxs)(n.p,{children:["Refer to the following diagram to help orient you to mapping ",(0,s.jsx)(n.code,{children:"anonymousIds"})," in Segment to a custom ID representing anonymous users in Statsig:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/283278011-3c22e6e8-ab36-4844-aee2-b6630ecda4de.png",alt:""})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Initialize the Statsig SDK with your ",(0,s.jsx)(n.a,{href:"/concepts/user",children:"Statsig User"})," which will contain an optional ",(0,s.jsx)(n.code,{children:"userID"})," value and a ",(0,s.jsx)(n.code,{children:"customID"})," that you've created in the Statsig UI - ",(0,s.jsx)(n.code,{children:"segmentAnonymousId"})," in this example."]}),"\n",(0,s.jsxs)(n.li,{children:["As you orchestrate features/experiments, Statsig will associate this user to a variant using the unit of randomization chosen. For anonymous users, we'll use ",(0,s.jsx)(n.code,{children:"segmentAnonymousId"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Your existing Segment implementation tracks user traffic and associates anonymous users to the top-level field ",(0,s.jsx)(n.code,{children:"anonymousId"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["This ",(0,s.jsx)(n.code,{children:"anonymousId"})," is mapped in Statsig (to ",(0,s.jsx)(n.code,{children:"segmentAnonymousId"}),"), properly associating the identifier used in experiment exposures to the same identifier used to track user actions."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"syncing-statsig-segment-id-lists-with-segment-engage-audiences",children:"Syncing Statsig Segment ID Lists with Segment Engage Audiences"}),"\n",(0,s.jsxs)(n.p,{children:["By using ",(0,s.jsx)(n.a,{href:"https://segment.com/docs/engage/audiences/",children:"Segment Engage Audiences"})," you are able to maintain a list of users that can be used for targeting using ",(0,s.jsx)(n.a,{href:"/feature-flags/overview",children:"Statsig Feature Gates"}),". To configure this:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Create a ",(0,s.jsx)(n.a,{href:"/segments/create-new",children:"Statsig ID List Segment"})," on the Statsig Console."]}),"\n",(0,s.jsxs)(n.li,{children:["Follow the ",(0,s.jsx)(n.a,{href:"https://segment.com/docs/engage/audiences/",children:"Segment guide for Audiences"})," to create a new Audience and choose ",(0,s.jsx)(n.code,{children:"Statsig"})," as a Destination. The ",(0,s.jsx)(n.code,{children:"audience_key"})," must match the ID of the ",(0,s.jsx)(n.code,{children:"Statsig ID List Segment"})," created."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Once these steps have been completed, your Segment Audience will be synced, and you will be able to target those users for features you develop or experiments you run."}),"\n",(0,s.jsx)(n.h3,{id:"custom-properties",children:"Custom Properties"}),"\n",(0,s.jsxs)(n.p,{children:["Passing ",(0,s.jsx)(n.a,{href:"/concepts/user#user-attributes",children:"custom properties to a Statsig User"})," (see ",(0,s.jsx)(n.code,{children:"custom"})," field) enables targeting on specific cohorts of your users in feature gates and experimentation.\nProviding custom user properties also allows you to drill down your results to specific populations (ex: android/iOS, isVIP, etc) when ",(0,s.jsx)(n.a,{href:"/pulse/custom-queries#running-a-custom-query",children:"reading pulse results"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["If you're using custom fields to ",(0,s.jsx)(n.a,{href:"/feature-flags/conditions#custom",children:"target users"})," in your feature gates, you can provide these properties through Segment using the key ",(0,s.jsx)(n.code,{children:"statsigCustom"})," as part of the Segment ",(0,s.jsx)(n.code,{children:"properties"}),"\nfield, as an array of key value pairs: ",(0,s.jsx)(n.code,{children:"[key1, value1, key2, value2, ...]"}),". An example is shown below:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",metastring:'title="JSON Body"',children:'{\n  ...\n  properties: {\n    "statsigCustom": [ "isVIP", "true", "marketing_campaign", "abx343", ...]\n  }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"configuring-outbound-events-to-segment",children:"Configuring Outbound Events to Segment"}),"\n",(0,s.jsx)(n.p,{children:"To export your Statsig events to Segment,"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In your Segment app, add a new source \u2192 search for Statsig \u2192 click ",(0,s.jsx)(n.strong,{children:"Next"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/263066497-1856270d-adb9-4ca7-9349-1b4b393b1aa2.png",alt:""})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["Name your source \u2192 Create Source \u2192 click ",(0,s.jsx)(n.strong,{children:"Done"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/263066506-cbe5beca-5971-4baf-ae41-571bd7c1ae52.png",alt:""})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsxs)(n.li,{children:["Locate your ",(0,s.jsx)(n.strong,{children:"Write Key"})," and copy it."]}),"\n",(0,s.jsxs)(n.li,{children:["Log into the Statsig console and navigate to the ",(0,s.jsx)(n.a,{href:"https://console.statsig.com/integrations",children:(0,s.jsx)(n.strong,{children:"Integrations"})})," page."]}),"\n",(0,s.jsxs)(n.li,{children:["Click on the ",(0,s.jsx)(n.strong,{children:"Segment"})," card and switch to the ",(0,s.jsx)(n.strong,{children:"Outbound"})," tab, paste the ",(0,s.jsx)(n.strong,{children:"Write Key"})," into the ",(0,s.jsx)(n.strong,{children:"API Key"})," text box shown below, and click ",(0,s.jsx)(n.strong,{children:"Enable"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/1315028/150827399-333d9064-de1c-4f4e-bc33-51a46a83531d.png",alt:"Segment outbound integration configuration interface"})}),"\n",(0,s.jsx)(n.h3,{id:"outbound-event-schema",children:"Outbound event schema"}),"\n",(0,s.jsxs)(n.p,{children:["Statsig exports log events and exposure events to segment as ",(0,s.jsx)(n.code,{children:"track"})," events:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"{\n    type: 'track',\n    userId: event.userID,\n    timestamp: Number(event.timestamp),\n    event: event.eventName,\n    context: {\n      user: event.user,\n      value: event.value,\n      metadata: event.metadata,\n      library: {\n        name: 'statsig',\n        version: '1.0',\n      },\n      stableID: event.statsigMetadata.stableID // stableID, if you are relying on that for anonymous users\n    },\n    properties: {\n      value: event.value,\n      metadata: event.metadata,\n    },\n  };\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"Config Change events follow this schema:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"{\n  userId: statsigUserID,\n  timestamp: Date.now(),\n  event: 'statsig::config_change',\n  context: {\n    library: {\n      name: 'statsig',\n      version: '1.0',\n    },\n  },\n  properties: {\n    author: author,\n    configName: configName,\n    description: changeDescription,\n    environment: environment,\n  },\n},\n"})}),"\n",(0,s.jsx)(n.h2,{id:"environments",children:"Environments"}),"\n",(0,s.jsx)(o.default,{}),"\n",(0,s.jsx)(n.h2,{id:"working-with-segment-metrics-in-the-statsig-ui",children:"Working with Segment Metrics in the Statsig UI"}),"\n",(0,s.jsx)(n.p,{children:"Segment events are piped into Statsig and are accessible in the metrics console like any other event. Furthermore, these metrics will be accessible to use as monitoring metrics in your feature gates and experiments so you can utilize your existing\nmetric collection via Segment with Statsig's experimentation platform."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Segment events are prepended with ",(0,s.jsx)(n.code,{children:"segment::"})," so they can be easily distinguished from other sources"]})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/263068916-a7bb398b-dd5f-4a0c-9c72-924f384a54b7.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"These metrics will be reported in pulse results among other monitoring metrics:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://user-images.githubusercontent.com/125311112/263068905-12265a7e-e13a-4350-8bda-76ecfb3a805c.png",alt:""})}),"\n",(0,s.jsx)(n.h2,{id:"filtering-events",children:"Filtering Events"}),"\n",(0,s.jsxs)(n.p,{children:["You can customize which events should be sent and received via Segment using ",(0,s.jsx)(n.a,{href:"/integrations/event_filtering",children:"Event Filtering"})]})]})}function g(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},27058:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var s=t(74848),i=t(28453);const o={},r=void 0,a={id:"integrations/snippets/integration_statsig_env_format",title:"integration_statsig_env_format",description:"Environments",source:"@site/docs/integrations/snippets/integration_statsig_env_format.mdx",sourceDirName:"integrations/snippets",slug:"/integrations/snippets/integration_statsig_env_format",permalink:"/integrations/snippets/integration_statsig_env_format",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/integrations/snippets/integration_statsig_env_format.mdx",tags:[],version:"current",lastUpdatedAt:1727853638e3,frontMatter:{}},c={},l=[{value:"Environments",id:"environments",level:4}];function d(e){const n={a:"a",code:"code",h4:"h4",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h4,{id:"environments",children:"Environments"}),"\n",(0,s.jsx)(n.p,{children:'By default, all events are treated as "production" events, but you can also differentiate your event traffic by specifying the environment that the events are coming from.\nThis allows you to avoid non-production data making it into your production metrics.'}),"\n",(0,s.jsx)(n.p,{children:"If you would like to include the environment tier, you can add it to the properties object of your event.\nThe required format is below:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  ...\n  "properties": {\n   "statsigEnvironment": {\n        "tier": "staging"\n    }\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["To learn more about environments see ",(0,s.jsx)(n.a,{href:"/guides/using-environments",children:"Using Environment"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(96540);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);