"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[39235],{53603:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>l,frontMatter:()=>i,metadata:()=>o,toc:()=>g});var a=n(74848),s=n(28453);const i={sidebar_label:"GTM Integration",title:"Integrating Sidecar with GTM for tracking",keywords:["owner:brock"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},r=void 0,o={id:"guides/sidecar-experiments/integrating-gtm",title:"Integrating Sidecar with GTM for tracking",description:'This integration is for tracking purposes only. We strongly advise against loading Sidecar itself via GTM, as this will delay the changes from being applied and result in "flickering".',source:"@site/docs/guides/sidecar-experiments/integrating-gtm.mdx",sourceDirName:"guides/sidecar-experiments",slug:"/guides/sidecar-experiments/integrating-gtm",permalink:"/guides/sidecar-experiments/integrating-gtm",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/guides/sidecar-experiments/integrating-gtm.mdx",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{sidebar_label:"GTM Integration",title:"Integrating Sidecar with GTM for tracking",keywords:["owner:brock"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"Launching Experiments",permalink:"/guides/sidecar-experiments/publishing-experiments"},next:{title:"A/A Test with Sidecar",permalink:"/guides/aa-sidecar"}},c={},g=[{value:"Overview",id:"overview",level:3},{value:"Step 1: Create new tag",id:"step-1-create-new-tag",level:3},{value:"Step 2: Choose tag type",id:"step-2-choose-tag-type",level:3},{value:"Step 3: Adjust fire options",id:"step-3-adjust-fire-options",level:3},{value:"Step 4: Set Tag Trigger",id:"step-4-set-tag-trigger",level:3},{value:"Step 5: Save tag and test",id:"step-5-save-tag-and-test",level:3},{value:"GTM Code",id:"gtm-code",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h3:"h3",img:"img",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsx)(t.p,{children:'This integration is for tracking purposes only. We strongly advise against loading Sidecar itself via GTM, as this will delay the changes from being applied and result in "flickering".'})}),"\n",(0,a.jsx)(t.h3,{id:"overview",children:"Overview"}),"\n",(0,a.jsxs)(t.p,{children:["This integration with GTM will automatically send any GTM-tagged events to Statsig.",(0,a.jsx)("br",{})," No additional coding or tagging is required after completing these steps."]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.img,{alt:"Statsig logstream showing GTM events",src:n(12509).A+"",width:"1714",height:"642"}),"\n",(0,a.jsx)(t.em,{children:"(statsig logstream showing gtm events flowing in)"})]}),"\n",(0,a.jsx)(t.h3,{id:"step-1-create-new-tag",children:"Step 1: Create new tag"}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"GTM create new tag interface",src:n(18376).A+"",width:"2058",height:"550"})}),"\n",(0,a.jsx)(t.h3,{id:"step-2-choose-tag-type",children:"Step 2: Choose tag type"}),"\n",(0,a.jsxs)(t.p,{children:['Choose "Custom HTML" for tag type, and paste ',(0,a.jsx)(t.a,{href:"#gtm-code",children:"this GTM code"})," (including script tag)"]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"GTM tag configuration screen",src:n(63694).A+"",width:"2170",height:"736"})}),"\n",(0,a.jsx)(t.h3,{id:"step-3-adjust-fire-options",children:"Step 3: Adjust fire options"}),"\n",(0,a.jsx)(t.p,{children:'Under Advanced Settings under "Tag Firing options", select "Once per page"'}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"GTM tag firing options settings",src:n(32805).A+"",width:"1700",height:"920"})}),"\n",(0,a.jsx)(t.h3,{id:"step-4-set-tag-trigger",children:"Step 4: Set Tag Trigger"}),"\n",(0,a.jsx)(t.p,{children:'Below the "Tag Configuration" section, set the Trigger to "Initialization - All Pages" Option.'}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"GTM tag trigger configuration",src:n(11864).A+"",width:"2106",height:"430"})}),"\n",(0,a.jsx)(t.h3,{id:"step-5-save-tag-and-test",children:"Step 5: Save tag and test"}),"\n",(0,a.jsxs)(t.p,{children:["After saving the tag, and publishing your updated GTM tag, tracking will be done automatically without any additional configuration.\nTo debug the integration, you can set a local storage entry ",(0,a.jsx)(t.code,{children:"debug_ss_gtm"})," with any value on your webpage. Now, you'll console log statements for each tracking call being dispatched to Statsig. You can also inspect your browser's network traffic to see events being tracked."]}),"\n",(0,a.jsx)(t.h3,{id:"gtm-code",children:"GTM Code"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'<script type="text/javascript">\n/* dataLayer helper */\n(function(){\n  var f=/\\[object (Boolean|Number|String|Function|Array|Date|RegExp|Arguments)\\]/;function g(a){return null==a?String(a):(a=f.exec(Object.prototype.toString.call(Object(a))))?a[1].toLowerCase():"object"}function m(a,b){return Object.prototype.hasOwnProperty.call(Object(a),b)}function n(a){if(!a||"object"!=g(a)||a.nodeType||a==a.window)return!1;try{if(a.constructor&&!m(a,"constructor")&&!m(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}for(var b in a);return void 0===b||m(a,b)};function p(a,b){var c={},d=c;a=a.split(".");for(var e=0;e<a.length-1;e++)d=d[a[e]]={};d[a[a.length-1]]=b;return c}function q(a,b){var c=!a._clear,d;for(d in a)if(m(a,d)){var e=a[d];"array"===g(e)&&c?("array"===g(b[d])||(b[d]=[]),q(e,b[d])):n(e)&&c?(n(b[d])||(b[d]={}),q(e,b[d])):b[d]=e}delete b._clear};\n  function r(a,b,c){b=void 0===b?{}:b;"function"===typeof b?b={listener:b,listenToPast:void 0===c?!1:c,processNow:!0,commandProcessors:{}}:b={listener:b.listener||function(){},listenToPast:b.listenToPast||!1,processNow:void 0===b.processNow?!0:b.processNow,commandProcessors:b.commandProcessors||{}};this.a=a;this.l=b.listener;this.j=b.listenToPast;this.g=this.i=!1;this.c={};this.f=[];this.b=b.commandProcessors;this.h=u(this);var d=this.a.push,e=this;this.a.push=function(){var k=[].slice.call(arguments,\n  0),l=d.apply(e.a,k);v(e,k);return l};b.processNow&&this.process()}r.prototype.process=function(){this.registerProcessor("set",function(){var c={};1===arguments.length&&"object"===g(arguments[0])?c=arguments[0]:2===arguments.length&&"string"===g(arguments[0])&&(c=p(arguments[0],arguments[1]));return c});this.i=!0;for(var a=this.a.length,b=0;b<a;b++)v(this,[this.a[b]],!this.j)};r.prototype.get=function(a){var b=this.c;a=a.split(".");for(var c=0;c<a.length;c++){if(void 0===b[a[c]])return;b=b[a[c]]}return b};\n  r.prototype.flatten=function(){this.a.splice(0,this.a.length);this.a[0]={};q(this.c,this.a[0])};r.prototype.registerProcessor=function(a,b){a in this.b||(this.b[a]=[]);this.b[a].push(b)};\n  function v(a,b,c){c=void 0===c?!1:c;if(a.i&&(a.f.push.apply(a.f,b),!a.g))for(;0<a.f.length;){b=a.f.shift();if("array"===g(b))a:{var d=a.c;g(b[0]);for(var e=b[0].split("."),k=e.pop(),l=b.slice(1),h=0;h<e.length;h++){if(void 0===d[e[h]])break a;d=d[e[h]]}try{d[k].apply(d,l)}catch(w){}}else if("arguments"===g(b)){e=a;k=[];l=b[0];if(e.b[l])for(d=e.b[l].length,h=0;h<d;h++)k.push(e.b[l][h].apply(e.h,[].slice.call(b,1)));a.f.push.apply(a.f,k)}else if("function"==typeof b)try{b.call(a.h)}catch(w){}else if(n(b))for(var t in b)q(p(t,\n  b[t]),a.c);else continue;c||(a.g=!0,a.l(a.c,b),a.g=!1)}}r.prototype.registerProcessor=r.prototype.registerProcessor;r.prototype.flatten=r.prototype.flatten;r.prototype.get=r.prototype.get;r.prototype.process=r.prototype.process;window.DataLayerHelper=r;function u(a){return{set:function(b,c){q(p(b,c),a.c)},get:function(b){return a.get(b)}}};})(); \n\nwindow.StatsigLogger = (function () {\n\n  var statsigInstance, log = function () {\n    if (typeof localStorage !== \'undefined\' && typeof console !== \'undefined\' && localStorage.getItem(\'debug_ss_gtm\')) {\n      console.log.apply(console, arguments);\n    }\n  };\n\n  var checkStatsigReady = function (callback) {\n    // statsig has already loaded\n    if(typeof StatsigSidecar !== \'undefined\' && StatsigSidecar.getStatsigInstance()) {\n      log(\'+++ Statsig:ready Already loaded\');\n      callback(StatsigSidecar.getStatsigInstance());\n    }\n    else {\n      log(\'+++ Statsig:ready callback\');\n      window.postExperimentCallback = function(statsigClient, expIds) {\n        callback(statsigClient);\n      }\n    }\n  };\n\n  var handleGTMMessage = function (model, message) {    \n    if (typeof message === \'object\' && typeof message.event === \'string\') {\n      var metadata = {};\n      for (var prop in message) {\n        if(!(message[prop] instanceof HTMLElement) && typeof(message[prop]) !== \'object\') {\n          metadata[prop] = message[prop];\n        }\n      }\n      log(\'++ handleGTMMessage\', message.event, message.conversionValue || null, metadata);\n      statsigInstance.logEvent(message.event, message.conversionValue || null, metadata);\n    }\n    else {\n      log(\'++ handleGTMMessage / skip\');\n    }\n  }\n\n  checkStatsigReady(function (statsigInstanceReady) {\n    statsigInstance = statsigInstanceReady;\n    // dataLayer will contain gtm events (~messages) that were fired pre statsig readiness\n    new DataLayerHelper(dataLayer, {\n      listener: handleGTMMessage,\n      listenToPast: true,\n    });\n  });\n  \n  return {\n    track: function() {\n      try {\n        statsigInstance.logEvent.apply(statsigInstance, arguments);\n      } catch(err) { } \n    }\n  }\n\n})();\n<\/script>\n'})})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},32805:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/gtm-create-tag-options-d6c0eebd82c2ea40f63949cd8bffb3c5.png"},18376:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/gtm-create-tag-b56405a1612dd8aabc45ff2ed042d30a.png"},12509:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/gtm-logstream-a21df5b13f3064e1b1107bd9155b54a2.png"},63694:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/gtm-tag-configuration-56bedc69b70d1c042dbb0556b7e76ba1.png"},11864:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/gtm-tag-trigger-58c3c4e17bfb5bd5100d33dcd97d232a.png"},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var a=n(96540);const s={},i=a.createContext(s);function r(e){const t=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);