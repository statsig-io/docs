"use strict";(self.webpackChunkstatsig_docs=self.webpackChunkstatsig_docs||[]).push([[45238],{92537:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var n=s(74848),i=s(28453);const a={sidebar_label:"Managing SRM",title:"Managing SRM",keywords:["owner:craig"],last_update:{date:new Date("2025-09-18T00:00:00.000Z")}},r=void 0,o={id:"guides/srm",title:"Managing SRM",description:"What is SRM?",source:"@site/docs/guides/srm.mdx",sourceDirName:"guides",slug:"/guides/srm",permalink:"/guides/srm",draft:!1,unlisted:!1,editUrl:"https://github.com/statsig-io/docs/edit/main/docs/guides/srm.mdx",tags:[],version:"current",lastUpdatedAt:17581536e5,frontMatter:{sidebar_label:"Managing SRM",title:"Managing SRM",keywords:["owner:craig"],last_update:{date:"2025-09-18T00:00:00.000Z"}},sidebar:"cloud",previous:{title:"SRM Checks",permalink:"/stats-engine/methodologies/srm-checks"},next:{title:"Pre-Experiment Bias",permalink:"/stats-engine/pre-experiment-bias"}},d={},c=[{value:"What is SRM?",id:"what-is-srm",level:2},{value:"Why SRM Is An Issue",id:"why-srm-is-an-issue",level:2},{value:"How SRM is detected",id:"how-srm-is-detected",level:2},{value:"What to do if an experiment has SRM",id:"what-to-do-if-an-experiment-has-srm",level:2}];function l(e){const t={a:"a",em:"em",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"what-is-srm",children:"What is SRM?"}),"\n",(0,n.jsx)(t.p,{children:"SRM, or sample ratio mismatch, is a problem with experiments characterized by there being too many units in some groups, and too few in others."}),"\n",(0,n.jsx)(t.p,{children:"The example below is an exposure crosstab of an experiment that has SRM. Even though the group percentages may look similar, if an assignment system is actually splitting traffic evenly, an imbalance this extreme (or more) would have less than a 0.01% chance to occur randomly."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"srm_example",src:s(28346).A+"",width:"778",height:"268"})}),"\n",(0,n.jsx)(t.p,{children:"Statsig, and most experiment platforms, normalize metrics per-user; a count metric will be measured as total count divided by unique users in the experiment. This means that, in a vacuum, it's fine to have more users in one group. So, why is SRM problematic?"}),"\n",(0,n.jsx)(t.h2,{id:"why-srm-is-an-issue",children:"Why SRM Is An Issue"}),"\n",(0,n.jsxs)(t.p,{children:["SRM is an issue because it is usually ",(0,n.jsx)(t.em,{children:"non-random"}),"; the extra or missing traffic is ",(0,n.jsx)(t.em,{children:"not identical"})," to the original traffic. How can SRM occur?"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"A bug causes a users' client or browser to crash before a log for the exposure can be sent. The users who don't come back are not re-exposed and included, but those that do come back are. This leads to bias in measurement"}),"\n",(0,n.jsx)(t.li,{children:'A conditional dependency causes "who is exposed" to be filtered by some characteristic for one or many groups, meaning the groups are not identical to other groups, biasing measurement'}),"\n",(0,n.jsx)(t.li,{children:"A script is bulk-exposing users going through 1 group at a time, and logs are truncated after a certain count - meaning the last group's exposures are truncated."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Those are common examples. SRM checks are critical because they can detect these kinds of effects occurring - and even at low rates they can lead to serious inaccuracy in experiment readouts."}),"\n",(0,n.jsx)(t.h2,{id:"how-srm-is-detected",children:"How SRM is detected"}),"\n",(0,n.jsxs)(t.p,{children:["Detecting SRM is generally done by using a ",(0,n.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Chi-squared_test",children:"chi-squared test"}),", which is a common and accepted way to analyze categorical data to understand if observed frequencies match expected frequencies. For example, in the experiment above we expect an even distribution of 167.85k units per group, and observe [166.08k, 171.18k, 166.30k]."]}),"\n",(0,n.jsx)(t.p,{children:"If the p-value of the test is low, we reject the null hypothesis that the groups are identical and conclude that there is a difference between the groups' observed and intended/expected assignment rates."}),"\n",(0,n.jsx)(t.h2,{id:"what-to-do-if-an-experiment-has-srm",children:"What to do if an experiment has SRM"}),"\n",(0,n.jsx)(t.p,{children:"On Statsig, SRM will create a warning or failure state on an experiment's health check when detected - depending on how extreme the SRM is."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"srm_failure",src:s(81217).A+"",width:"1300",height:"309"})}),"\n",(0,n.jsxs)(t.p,{children:["This often causes concern; people don't want to reset their experiment and lose the data they've collected, and additionally the concern is that if there ",(0,n.jsx)(t.em,{children:"is"})," an underlying issue it will just reproduce if the experiment is reset and restarted."]}),"\n",(0,n.jsx)(t.p,{children:"Generally, it's recommended to follow the following steps:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"1.) Check the time series data"})}),"\n",(0,n.jsx)(t.p,{children:"Statsig generates a chart of SRM p-value over time. If this is noisy and bounces around, it's more likely that this was a false positive alert. If it consistently trends down to 0,\nit's a strong signal that there is truly an assignment issue."}),"\n",(0,n.jsx)(t.p,{children:"Below is an example of a p-value chart that indicates a real issue."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"srm_bad_timeseries",src:s(49267).A+"",width:"816",height:"632"})}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"2.) Understand if there's a clear root cause for SRM"})}),"\n",(0,n.jsx)(t.p,{children:"Use Statsig's SRM debugger, or do a data analysis using exported exposures to understand if a certain segment is driving SRM. Often, it's the case that a bug will only exist on a platform like android,\nor be restricted to users with low internet speeds. If you can find a bug, and fix it, you can restart the experiment safely"}),"\n",(0,n.jsx)(t.p,{children:"If it's very clearly isolated, it's also reasonable to filter out that segment from analysis if the experiment was expensive or required a long period of data collection."}),"\n",(0,n.jsx)(t.p,{children:"At this point, you should have a rough idea of how likely it is that there's an issue; now you need to make a call on next steps."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"3.) Assess options"})}),"\n",(0,n.jsx)(t.p,{children:"It's unfortunate, but in many cases the best bet is to investigate, fix, and restart. In some cases, the SRM may be mild enough, and the experiment low-risk enough, that it's acceptable to make a decision with the tainted data."}),"\n",(0,n.jsx)(t.p,{children:"In general, though, Statsig strongly recommends against this and considers it a best practice to restart the experiment, ideally after investigating any potential SRM vector."})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},49267:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/bad_pvalue-17f768bfe794e2de30738359b62735c1.png"},28346:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/srm-56fcf768965682f2d6753d0f56e7594d.png"},81217:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/srm_failure-bd7d818bedea962ff17ca65d33336482.png"},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>o});var n=s(96540);const i={},a=n.createContext(i);function r(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:t},e.children)}}}]);