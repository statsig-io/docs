import GitHubEmbed from "@site/src/components/GitHubEmbed";

## React Native + React Specific Setup

The setup for a ReactNative environment is very similar to a plain [React environment](/client/javascript-sdk/react). 
The only difference is that you need to use the ReactNative specific `StatsigProviderRN`. 
This automatically switches out the storage layer used by the SDK, utilizing [AsyncStorage](https://github.com/react-native-async-storage) instead of LocalStorage (which isn't available in RN environments).


```tsx
import {
  StatsigProviderRN,
  useFeatureGate,
} from '@statsig/react-native-bindings';

function Content() {
  const gate = useFeatureGate('a_gate');

  // Reason: Network or NetworkNotModified
  return (
    <View>
      <Text>Value: {gate.value ? "Pass" : "Fail"}</Text> 
      <Text>Reason: {gate.details.reason}</Text> 
    </View>
  );
}

function App() {
  return (
    <StatsigProviderRN 
      sdkKey={YOUR_CLIENT_KEY}
      user={{ userID: "a-user" }}
      loadingComponent={<Text>Loading...</Text>}>
        <Content />
    </StatsigProviderRN>
  );
}
```

**Note**: There are a few different ways to initialize the StatsigClient, with trade-offs between latency and up-to-date values.
You can read [Initialization Strategies](init-strategies) to learn more.

## StatsigClient Outside the Component Tree

In some scenarios, you may need to use the `StatsigClient` when you are not in the React component tree. Things like background tasks or handling notifications. 
For these, you can use the Expo specific `StatsigClientRN`.

```typescript
import { StatsigClientRN } from '@statsig/react-native-bindings';

const myClient = new StatsigClientRN(
  YOUR_CLIENT_KEY,
  { userID: "a-user" }
);

await myClient.initializeAsync();

if (myClient.checkGate("my_gate")) {
  // do something cool
}
```

## Hooks

All hooks are re-exported from the `@statsig/react-bindings` package (See [Hooks](/client/javascript-sdk/react#hooks)). 
They can be imported through `@statsig/react-native-bindings` or directly through the `@statsig/react-bindings` peer dependency.

```js
import { useFeatureGate, useStatsigClient } from '@statsig/react-native-bindings';
```

## Advanced


### Android networking
We have seen reports that the default networking client on react native for android can error out with:

```
ERROR  [Statsig] A networking error occured during POST request to https://featureassets.org/v1/initialize
```

Please let us know if you hit this, but for now the suggested workaround is to append this `content-type` for all requests:

```typescript
const customFetcher = (uri, args) => {
  args.headers = {
    'Content-Type': 'application/json',
    ...args.headers,
  };
  return fetch(uri, args);
};

const myStatsigClient = new StatsigClientRN(
  'YOUR_KEY',
  {
    userID: "YOUR_USER_ID",
  },
  {
    networkConfig: {
      networkOverrideFunc: customFetcher,
    },
  }
);
```

### Synchronous Storage with MMKV

If you are utilizing [MMKV](https://github.com/mrousavy/react-native-mmkv) in your project, and would prefer to use that instead of the default ([AsyncStorage](https://github.com/react-native-async-storage)). 
You can provide you own `StorageProvider` via `StatsigOptions`. 

Something like:
```tsx
import { MMKV } from "react-native-mmkv";
import { StorageProvider } from "@statsig/client-core";
import { StatsigProviderRN } from '@statsig/react-native-bindings';

function App() {
    const [storageProvider] = useState<StorageProvider>(() => {
      const mmkv = new MMKV();

      return {
        isReady: () => true,
        isReadyResolver: () => null,
        getProviderName: () => "MMKV",
        getAllKeys: () => mmkv.getAllKeys(),
        getItem: (key: string) => mmkv.getString(key) ?? null,
        setItem: (key: string, value: string) => mmkv.set(key, value),
        removeItem: (key: string) => mmkv.delete(key),
      };
    });

   return (
    <StatsigProviderExpo
      sdkKey={YOUR_CLIENT_KEY}
      user={{ userID: "a-user" }}
      options={{
        storageProvider, // <- Passed into StatsigOptions
      }}
    >
      <Text>...</Text>
    </StatsigProviderExpo>
   );
}
```